<?php eval("?>".base64_decode("PD9waHANCiAvKioNCiAqIE5PVElDRSBPRiBMSUNFTlNFDQogKg0KICogVGhpcyBzb3VyY2UgZmlsZSBpcyBzdWJqZWN0IHRvIHRoZSBIUlNBTEUgTGljZW5zZQ0KICogdGhhdCBpcyBidW5kbGVkIHdpdGggdGhpcyBwYWNrYWdlIGluIHRoZSBmaWxlIGxpY2Vuc2UudHh0Lg0KICogSXQgaXMgYWxzbyBhdmFpbGFibGUgdGhyb3VnaCB0aGUgd29ybGQtd2lkZS13ZWIgYXQgdGhpcyBVUkw6DQogKiBodHRwOi8vd3d3Lmhyc2FsZS5jb20vbGljZW5zZS50eHQNCiAqIElmIHlvdSBkaWQgbm90IHJlY2VpdmUgYSBjb3B5IG9mIHRoZSBsaWNlbnNlIGFuZCBhcmUgdW5hYmxlIHRvDQogKiBvYnRhaW4gaXQgdGhyb3VnaCB0aGUgd29ybGQtd2lkZS13ZWIsIHBsZWFzZSBzZW5kIGFuIGVtYWlsDQogKiB0byBocnNhbGVzb2Z0QGdtYWlsLmNvbSBzbyB3ZSBjYW4gc2VuZCB5b3UgYSBjb3B5IGltbWVkaWF0ZWx5Lg0KICoNCiAqIEBhdXRob3IgICBIUlNBTEUNCiAqIEBhdXRob3ItZW1haWwgIGhyc2FsZXNvZnRAZ21haWwuY29tDQogKiBAY29weXJpZ2h0ICBDb3B5cmlnaHQgqSBocnNhbGUuY29tLiBBbGwgUmlnaHRzIFJlc2VydmVkDQogKi8NCmlmICggISBkZWZpbmVkKCdCQVNFUEFUSCcpKSBleGl0KCdObyBkaXJlY3Qgc2NyaXB0IGFjY2VzcyBhbGxvd2VkJyk7DQoNCmNsYXNzIEFjY291bnRpbmcgZXh0ZW5kcyBNWV9Db250cm9sbGVyDQp7DQoNCiAgIC8qRnVuY3Rpb24gdG8gc2V0IEpTT04gb3V0cHV0Ki8NCglwdWJsaWMgZnVuY3Rpb24gb3V0cHV0KCRSZXR1cm49YXJyYXkoKSl7DQoJCS8qU2V0IHJlc3BvbnNlIGhlYWRlciovDQoJCWhlYWRlcigiQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luOiAqIik7DQoJCWhlYWRlcigiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04Iik7DQoJCS8qRmluYWwgSlNPTiByZXNwb25zZSovDQoJCWV4aXQoanNvbl9lbmNvZGUoJFJldHVybikpOw0KCX0NCgkNCglwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKSB7DQogICAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgpOw0KICAgICAgICAgIC8vbG9hZCB0aGUgbW9kZWxzDQogICAgICAgICAgJHRoaXMtPmxvYWQtPm1vZGVsKCdYaW5fbW9kZWwnKTsNCgkJICAkdGhpcy0+bG9hZC0+bW9kZWwoJ0ZpbmFuY2VfbW9kZWwnKTsNCgkJICAkdGhpcy0+bG9hZC0+bW9kZWwoJ0V4cGVuc2VfbW9kZWwnKTsNCgkJICAkdGhpcy0+bG9hZC0+bW9kZWwoJ0ludm9pY2VzX21vZGVsJyk7DQoJCSAgJHRoaXMtPmxvYWQtPm1vZGVsKCdFbXBsb3llZXNfbW9kZWwnKTsNCgkJICAgJHRoaXMtPmxvYWQtPm1vZGVsKCdEZXBhcnRtZW50X21vZGVsJyk7DQogICAgIH0NCgkgDQoJcHVibGljIGZ1bmN0aW9uIGRlcG9zaXQoKSB7DQoJDQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRzeXN0ZW0gPSAkdGhpcy0+WGluX21vZGVsLT5yZWFkX3NldHRpbmdfaW5mbygxKTsNCgkJaWYoJHN5c3RlbVswXS0+bW9kdWxlX2FjY291bnRpbmchPSd0cnVlJyl7DQoJCQlyZWRpcmVjdCgnYWRtaW4vZGFzaGJvYXJkJyk7DQoJCX0NCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19kZXBvc2l0JykuJyB8ICcuJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkZGF0YVsnYnJlYWRjcnVtYnMnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2RlcG9zaXQnKTsNCgkJJGRhdGFbJ3BhdGhfdXJsJ10gPSAnYWNjb3VudGluZ19kZXBvc2l0JzsNCgkJJGRhdGFbJ2FsbF9wYXllcnMnXSA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hbGxfcGF5ZXJzKCk7DQoJCSRkYXRhWydhbGxfYmFua19jYXNoJ10gPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWxsX2JhbmtfY2FzaCgpOw0KCQkkZGF0YVsnYWxsX2luY29tZV9jYXRlZ29yaWVzX2xpc3QnXSA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hbGxfaW5jb21lX2NhdGVnb3JpZXNfbGlzdCgpOw0KCQkkZGF0YVsnZ2V0X2FsbF9wYXltZW50X21ldGhvZCddID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmdldF9hbGxfcGF5bWVudF9tZXRob2QoKTsNCgkJJHJvbGVfcmVzb3VyY2VzX2lkcyA9ICR0aGlzLT5YaW5fbW9kZWwtPnVzZXJfcm9sZV9yZXNvdXJjZSgpOw0KCQlpZihpbl9hcnJheSgnNzUnLCRyb2xlX3Jlc291cmNlc19pZHMpKSB7DQoJCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkJJGRhdGFbJ3N1YnZpZXcnXSA9ICR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL2RlcG9zaXRfbGlzdCIsICRkYXRhLCBUUlVFKTsNCgkJCQkkdGhpcy0+bG9hZC0+dmlldygnYWRtaW4vbGF5b3V0L2xheW91dF9tYWluJywgJGRhdGEpOyAvL3BhZ2UgbG9hZA0KCQkJfSBlbHNlIHsNCgkJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCQl9DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vZGFzaGJvYXJkJyk7DQoJCX0NCgl9DQoJDQoJcHVibGljIGZ1bmN0aW9uIHRyYW5zZmVyKCkgew0KCQ0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoZW1wdHkoJHNlc3Npb24pKXsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkc3lzdGVtID0gJHRoaXMtPlhpbl9tb2RlbC0+cmVhZF9zZXR0aW5nX2luZm8oMSk7DQoJCWlmKCRzeXN0ZW1bMF0tPm1vZHVsZV9hY2NvdW50aW5nIT0ndHJ1ZScpew0KCQkJcmVkaXJlY3QoJ2FkbWluL2Rhc2hib2FyZCcpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfdHJhbnNmZXInKS4nIHwgJy4kdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCSRkYXRhWydicmVhZGNydW1icyddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfdHJhbnNmZXInKTsNCgkJJGRhdGFbJ3BhdGhfdXJsJ10gPSAnYWNjb3VudGluZ190cmFuc2Zlcic7DQoJCSRkYXRhWydhbGxfYmFua19jYXNoJ10gPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWxsX2JhbmtfY2FzaCgpOw0KCQkkZGF0YVsnYWxsX2luY29tZV9jYXRlZ29yaWVzX2xpc3QnXSA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hbGxfaW5jb21lX2NhdGVnb3JpZXNfbGlzdCgpOw0KCQkkZGF0YVsnZ2V0X2FsbF9wYXltZW50X21ldGhvZCddID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmdldF9hbGxfcGF5bWVudF9tZXRob2QoKTsNCgkJJHJvbGVfcmVzb3VyY2VzX2lkcyA9ICR0aGlzLT5YaW5fbW9kZWwtPnVzZXJfcm9sZV9yZXNvdXJjZSgpOw0KCQlpZihpbl9hcnJheSgnNzcnLCRyb2xlX3Jlc291cmNlc19pZHMpKSB7DQoJCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkJJGRhdGFbJ3N1YnZpZXcnXSA9ICR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL3RyYW5zZmVyX2xpc3QiLCAkZGF0YSwgVFJVRSk7DQoJCQkJJHRoaXMtPmxvYWQtPnZpZXcoJ2FkbWluL2xheW91dC9sYXlvdXRfbWFpbicsICRkYXRhKTsgLy9wYWdlIGxvYWQNCgkJCX0gZWxzZSB7DQoJCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluL2Rhc2hib2FyZCcpOw0KCQl9DQoJfQ0KCQ0KCXB1YmxpYyBmdW5jdGlvbiBleHBlbnNlKCkgew0KCQ0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoZW1wdHkoJHNlc3Npb24pKXsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkc3lzdGVtID0gJHRoaXMtPlhpbl9tb2RlbC0+cmVhZF9zZXR0aW5nX2luZm8oMSk7DQoJCWlmKCRzeXN0ZW1bMF0tPm1vZHVsZV9hY2NvdW50aW5nIT0ndHJ1ZScpew0KCQkJcmVkaXJlY3QoJ2FkbWluL2Rhc2hib2FyZCcpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXhwZW5zZScpLicgfCAnLiR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJJGRhdGFbJ2JyZWFkY3J1bWJzJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19leHBlbnNlJyk7DQoJCSRkYXRhWydwYXRoX3VybCddID0gJ2FjY291bnRpbmdfZXhwZW5zZSc7DQoJCSRkYXRhWydhbGxfcGF5ZWVzJ10gPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWxsX3BheWVlcygpOw0KCQkkZGF0YVsnYWxsX2VtcGxveWVlcyddID0gJHRoaXMtPlhpbl9tb2RlbC0+YWxsX2VtcGxveWVlcygpOw0KCQkkZGF0YVsnYWxsX2NvbXBhbmllcyddID0gJHRoaXMtPlhpbl9tb2RlbC0+Z2V0X2NvbXBhbmllcygpOw0KCQkkZGF0YVsnYWxsX2V4cGVuc2VfdHlwZXMnXSA9ICR0aGlzLT5FeHBlbnNlX21vZGVsLT5hbGxfZXhwZW5zZV90eXBlcygpOw0KCQkkZGF0YVsnYWxsX2JhbmtfY2FzaCddID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFsbF9iYW5rX2Nhc2goKTsNCgkJJGRhdGFbJ2FsbF9pbmNvbWVfY2F0ZWdvcmllc19saXN0J10gPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWxsX2luY29tZV9jYXRlZ29yaWVzX2xpc3QoKTsNCgkJJGRhdGFbJ2dldF9hbGxfcGF5bWVudF9tZXRob2QnXSA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5nZXRfYWxsX3BheW1lbnRfbWV0aG9kKCk7DQoJCSRyb2xlX3Jlc291cmNlc19pZHMgPSAkdGhpcy0+WGluX21vZGVsLT51c2VyX3JvbGVfcmVzb3VyY2UoKTsNCgkJaWYoaW5fYXJyYXkoJzc2Jywkcm9sZV9yZXNvdXJjZXNfaWRzKSkgew0KCQkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJCSRkYXRhWydzdWJ2aWV3J10gPSAkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9leHBlbnNlX2xpc3QiLCAkZGF0YSwgVFJVRSk7DQoJCQkJJHRoaXMtPmxvYWQtPnZpZXcoJ2FkbWluL2xheW91dC9sYXlvdXRfbWFpbicsICRkYXRhKTsgLy9wYWdlIGxvYWQNCgkJCX0gZWxzZSB7DQoJCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluL2Rhc2hib2FyZCcpOw0KCQl9DQoJfQ0KCS8vIGdldCBjb21wYW55ID4gZW1wbG95ZWVzDQoJIHB1YmxpYyBmdW5jdGlvbiBnZXRfZW1wbG95ZWVzKCkgew0KDQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkaWQgPSAkdGhpcy0+dXJpLT5zZWdtZW50KDQpOw0KCQkNCgkJJGRhdGEgPSBhcnJheSgNCgkJCSdjb21wYW55X2lkJyA9PiAkaWQNCgkJCSk7DQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9nZXRfZW1wbG95ZWVzIiwgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCS8vIERhdGF0YWJsZXMgVmFyaWFibGVzDQoJCSRkcmF3ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJkcmF3IikpOw0KCQkkc3RhcnQgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoInN0YXJ0IikpOw0KCQkkbGVuZ3RoID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJsZW5ndGgiKSk7DQoJIH0NCgkgLy8gZ2V0IGNvbXBhbnkgPiBleHBlbnNlX3R5cGVzDQoJIHB1YmxpYyBmdW5jdGlvbiBnZXRfY29tcGFueV9leHBlbnNlX3R5cGVzKCkgew0KDQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkaWQgPSAkdGhpcy0+dXJpLT5zZWdtZW50KDQpOw0KCQkNCgkJJGRhdGEgPSBhcnJheSgNCgkJCSdjb21wYW55X2lkJyA9PiAkaWQNCgkJCSk7DQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9nZXRfY29tcGFueV9leHBlbnNlX3R5cGVzIiwgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCS8vIERhdGF0YWJsZXMgVmFyaWFibGVzDQoJCSRkcmF3ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJkcmF3IikpOw0KCQkkc3RhcnQgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoInN0YXJ0IikpOw0KCQkkbGVuZ3RoID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJsZW5ndGgiKSk7DQoJIH0NCgkgLy8gZ2V0IGNvbXBhbnkgPiBleHBlbnNlX3R5cGVzDQoJIHB1YmxpYyBmdW5jdGlvbiBnZXRfZXhwZW5zZV90eXBlcygpIHsNCg0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJJGlkID0gJHRoaXMtPnVyaS0+c2VnbWVudCg0KTsNCgkJDQoJCSRkYXRhID0gYXJyYXkoDQoJCQknY29tcGFueV9pZCcgPT4gJGlkDQoJCQkpOw0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvZ2V0X2V4cGVuc2VfdHlwZXMiLCAkZGF0YSk7DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJLy8gRGF0YXRhYmxlcyBWYXJpYWJsZXMNCgkJJGRyYXcgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImRyYXciKSk7DQoJCSRzdGFydCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgic3RhcnQiKSk7DQoJCSRsZW5ndGggPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImxlbmd0aCIpKTsNCgkgfQ0KCXB1YmxpYyBmdW5jdGlvbiBwYXllcnMoKSB7DQoJDQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRzeXN0ZW0gPSAkdGhpcy0+WGluX21vZGVsLT5yZWFkX3NldHRpbmdfaW5mbygxKTsNCgkJaWYoJHN5c3RlbVswXS0+bW9kdWxlX2FjY291bnRpbmchPSd0cnVlJyl7DQoJCQlyZWRpcmVjdCgnYWRtaW4vZGFzaGJvYXJkJyk7DQoJCX0NCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19wYXllcnMnKS4nIHwgJy4kdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCSRkYXRhWydicmVhZGNydW1icyddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfcGF5ZXJzJyk7DQoJCSRkYXRhWydwYXRoX3VybCddID0gJ2FjY291bnRpbmdfcGF5ZXJzJzsNCgkJJHJvbGVfcmVzb3VyY2VzX2lkcyA9ICR0aGlzLT5YaW5fbW9kZWwtPnVzZXJfcm9sZV9yZXNvdXJjZSgpOw0KCQlpZihpbl9hcnJheSgnODEnLCRyb2xlX3Jlc291cmNlc19pZHMpKSB7DQoJCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkJJGRhdGFbJ3N1YnZpZXcnXSA9ICR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL3BheWVyc19saXN0IiwgJGRhdGEsIFRSVUUpOw0KCQkJCSR0aGlzLT5sb2FkLT52aWV3KCdhZG1pbi9sYXlvdXQvbGF5b3V0X21haW4nLCAkZGF0YSk7IC8vcGFnZSBsb2FkDQoJCQl9IGVsc2Ugew0KCQkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJCX0NCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCX0NCgkNCglwdWJsaWMgZnVuY3Rpb24gcGF5ZWVzKCkgew0KCQ0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoZW1wdHkoJHNlc3Npb24pKXsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkc3lzdGVtID0gJHRoaXMtPlhpbl9tb2RlbC0+cmVhZF9zZXR0aW5nX2luZm8oMSk7DQoJCWlmKCRzeXN0ZW1bMF0tPm1vZHVsZV9hY2NvdW50aW5nIT0ndHJ1ZScpew0KCQkJcmVkaXJlY3QoJ2FkbWluL2Rhc2hib2FyZCcpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfcGF5ZWVzJykuJyB8ICcuJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkZGF0YVsnYnJlYWRjcnVtYnMnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3BheWVlcycpOw0KCQkkZGF0YVsncGF0aF91cmwnXSA9ICdhY2NvdW50aW5nX3BheWVlcyc7DQoJCSRyb2xlX3Jlc291cmNlc19pZHMgPSAkdGhpcy0+WGluX21vZGVsLT51c2VyX3JvbGVfcmVzb3VyY2UoKTsNCgkJaWYoaW5fYXJyYXkoJzgwJywkcm9sZV9yZXNvdXJjZXNfaWRzKSkgew0KCQkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJCSRkYXRhWydzdWJ2aWV3J10gPSAkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9wYXllZXNfbGlzdCIsICRkYXRhLCBUUlVFKTsNCgkJCQkkdGhpcy0+bG9hZC0+dmlldygnYWRtaW4vbGF5b3V0L2xheW91dF9tYWluJywgJGRhdGEpOyAvL3BhZ2UgbG9hZA0KCQkJfSBlbHNlIHsNCgkJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCQl9DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vZGFzaGJvYXJkJyk7DQoJCX0NCgl9DQoJcHVibGljIGZ1bmN0aW9uIGJhbmtfY2FzaCgpIHsNCgkNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJHN5c3RlbSA9ICR0aGlzLT5YaW5fbW9kZWwtPnJlYWRfc2V0dGluZ19pbmZvKDEpOw0KCQlpZigkc3lzdGVtWzBdLT5tb2R1bGVfYWNjb3VudGluZyE9J3RydWUnKXsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2FjY291bnRzJykuJyB8ICcuJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkZGF0YVsnYnJlYWRjcnVtYnMnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2FjY291bnRzJyk7DQoJCSRkYXRhWydwYXRoX3VybCddID0gJ2FjY291bnRpbmdfYmFua19jYXNoJzsNCgkJJHJvbGVfcmVzb3VyY2VzX2lkcyA9ICR0aGlzLT5YaW5fbW9kZWwtPnVzZXJfcm9sZV9yZXNvdXJjZSgpOw0KCQlpZihpbl9hcnJheSgnNzInLCRyb2xlX3Jlc291cmNlc19pZHMpKSB7DQoJCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkJJGRhdGFbJ3N1YnZpZXcnXSA9ICR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL2JhbmtfY2FzaF9saXN0IiwgJGRhdGEsIFRSVUUpOw0KCQkJCSR0aGlzLT5sb2FkLT52aWV3KCdhZG1pbi9sYXlvdXQvbGF5b3V0X21haW4nLCAkZGF0YSk7IC8vcGFnZSBsb2FkDQoJCQl9IGVsc2Ugew0KCQkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJCX0NCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCX0NCgkNCglwdWJsaWMgZnVuY3Rpb24gYWNjb3VudF9iYWxhbmNlcygpIHsNCgkNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJHN5c3RlbSA9ICR0aGlzLT5YaW5fbW9kZWwtPnJlYWRfc2V0dGluZ19pbmZvKDEpOw0KCQlpZigkc3lzdGVtWzBdLT5tb2R1bGVfYWNjb3VudGluZyE9J3RydWUnKXsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2FjY291bnRfYmFsYW5jZXMnKS4nIHwgJy4kdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCSRkYXRhWydicmVhZGNydW1icyddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfYWNjb3VudF9iYWxhbmNlcycpOw0KCQkkZGF0YVsncGF0aF91cmwnXSA9ICdhY2NvdW50aW5nX2FjY291bnRfYmFsYW5jZXMnOw0KCQkkcm9sZV9yZXNvdXJjZXNfaWRzID0gJHRoaXMtPlhpbl9tb2RlbC0+dXNlcl9yb2xlX3Jlc291cmNlKCk7DQoJCWlmKGluX2FycmF5KCc3MycsJHJvbGVfcmVzb3VyY2VzX2lkcykpIHsNCgkJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCQkkZGF0YVsnc3VidmlldyddID0gJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvYWNjb3VudF9iYWxhbmNlcyIsICRkYXRhLCBUUlVFKTsNCgkJCQkkdGhpcy0+bG9hZC0+dmlldygnYWRtaW4vbGF5b3V0L2xheW91dF9tYWluJywgJGRhdGEpOyAvL3BhZ2UgbG9hZA0KCQkJfSBlbHNlIHsNCgkJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCQl9DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vZGFzaGJvYXJkJyk7DQoJCX0NCgl9DQoJDQoJcHVibGljIGZ1bmN0aW9uIHRyYW5zYWN0aW9ucygpIHsNCgkNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJHN5c3RlbSA9ICR0aGlzLT5YaW5fbW9kZWwtPnJlYWRfc2V0dGluZ19pbmZvKDEpOw0KCQlpZigkc3lzdGVtWzBdLT5tb2R1bGVfYWNjb3VudGluZyE9J3RydWUnKXsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3ZpZXdfdHJhbnNhY3Rpb25zJykuJyB8ICcuJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkZGF0YVsnYnJlYWRjcnVtYnMnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3ZpZXdfdHJhbnNhY3Rpb25zJyk7DQoJCSRkYXRhWydwYXRoX3VybCddID0gJ2FjY291bnRpbmdfdHJhbnNhY3Rpb25zJzsNCgkJJHJvbGVfcmVzb3VyY2VzX2lkcyA9ICR0aGlzLT5YaW5fbW9kZWwtPnVzZXJfcm9sZV9yZXNvdXJjZSgpOw0KCQlpZihpbl9hcnJheSgnNzgnLCRyb2xlX3Jlc291cmNlc19pZHMpKSB7DQoJCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkJJGRhdGFbJ3N1YnZpZXcnXSA9ICR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL3RyYW5zYWN0aW9uX2xpc3QiLCAkZGF0YSwgVFJVRSk7DQoJCQkJJHRoaXMtPmxvYWQtPnZpZXcoJ2FkbWluL2xheW91dC9sYXlvdXRfbWFpbicsICRkYXRhKTsgLy9wYWdlIGxvYWQNCgkJCX0gZWxzZSB7DQoJCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluL2Rhc2hib2FyZCcpOw0KCQl9DQoJfQ0KCSANCgkgcHVibGljIGZ1bmN0aW9uIHJlYWQoKSB7DQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpeyANCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJJGlkID0gJHRoaXMtPmlucHV0LT5nZXQoJ2JhbmtjYXNoX2lkJyk7DQoJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9iYW5rY2FzaF9pbmZvcm1hdGlvbigkaWQpOw0KCQkkZGF0YSA9IGFycmF5KA0KCQkJCSdiYW5rY2FzaF9pZCcgPT4gJHJlc3VsdFswXS0+YmFua2Nhc2hfaWQsDQoJCQkJJ2FjY291bnRfbmFtZScgPT4gJHJlc3VsdFswXS0+YWNjb3VudF9uYW1lLA0KCQkJCSdhY2NvdW50X2JhbGFuY2UnID0+ICRyZXN1bHRbMF0tPmFjY291bnRfYmFsYW5jZSwNCgkJCQknYWNjb3VudF9udW1iZXInID0+ICRyZXN1bHRbMF0tPmFjY291bnRfbnVtYmVyLA0KCQkJCSdicmFuY2hfY29kZScgPT4gJHJlc3VsdFswXS0+YnJhbmNoX2NvZGUsDQoJCQkJJ2JhbmtfYnJhbmNoJyA9PiAkcmVzdWx0WzBdLT5iYW5rX2JyYW5jaCwNCgkJCQknY3JlYXRlZF9hdCcgPT4gJHJlc3VsdFswXS0+Y3JlYXRlZF9hdA0KCQkJCSk7DQoJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCSR0aGlzLT5sb2FkLT52aWV3KCdhZG1pbi9hY2NvdW50aW5nL2RpYWxvZ19hY2NvdW50aW5nJywgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJfQ0KCXB1YmxpYyBmdW5jdGlvbiByZWFkX3BheWVyKCkgew0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoZW1wdHkoJHNlc3Npb24pKXsgDQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCSRpZCA9ICR0aGlzLT5pbnB1dC0+Z2V0KCdwYXllcl9pZCcpOw0KCQkkcmVzdWx0ID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfcGF5ZXJfaW5mbygkaWQpOw0KCQkkZGF0YSA9IGFycmF5KA0KCQkJCSdwYXllcl9pZCcgPT4gJHJlc3VsdFswXS0+cGF5ZXJfaWQsDQoJCQkJJ3BheWVyX25hbWUnID0+ICRyZXN1bHRbMF0tPnBheWVyX25hbWUsDQoJCQkJJ2NvbnRhY3RfbnVtYmVyJyA9PiAkcmVzdWx0WzBdLT5jb250YWN0X251bWJlciwNCgkJCQknY3JlYXRlZF9hdCcgPT4gJHJlc3VsdFswXS0+Y3JlYXRlZF9hdA0KCQkJCSk7DQoJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCSR0aGlzLT5sb2FkLT52aWV3KCdhZG1pbi9hY2NvdW50aW5nL2RpYWxvZ19hY2NvdW50aW5nJywgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJfQ0KCQ0KCXB1YmxpYyBmdW5jdGlvbiByZWFkX3BheWVlKCkgew0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoZW1wdHkoJHNlc3Npb24pKXsgDQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCSRpZCA9ICR0aGlzLT5pbnB1dC0+Z2V0KCdwYXllZV9pZCcpOw0KCQkkcmVzdWx0ID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfcGF5ZWVfaW5mbygkaWQpOw0KCQkkZGF0YSA9IGFycmF5KA0KCQkJCSdwYXllZV9pZCcgPT4gJHJlc3VsdFswXS0+cGF5ZWVfaWQsDQoJCQkJJ3BheWVlX25hbWUnID0+ICRyZXN1bHRbMF0tPnBheWVlX25hbWUsDQoJCQkJJ2NvbnRhY3RfbnVtYmVyJyA9PiAkcmVzdWx0WzBdLT5jb250YWN0X251bWJlciwNCgkJCQknY3JlYXRlZF9hdCcgPT4gJHJlc3VsdFswXS0+Y3JlYXRlZF9hdA0KCQkJCSk7DQoJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCSR0aGlzLT5sb2FkLT52aWV3KCdhZG1pbi9hY2NvdW50aW5nL2RpYWxvZ19hY2NvdW50aW5nJywgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJfQ0KCS8vIHBheWVycyBsaXN0DQoJcHVibGljIGZ1bmN0aW9uIHBheWVyc19saXN0KCkNCiAgICAgew0KDQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpeyANCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvcGF5ZXJzX2xpc3QiLCAkZGF0YSk7DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJLy8gRGF0YXRhYmxlcyBWYXJpYWJsZXMNCgkJJGRyYXcgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImRyYXciKSk7DQoJCSRzdGFydCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgic3RhcnQiKSk7DQoJCSRsZW5ndGggPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImxlbmd0aCIpKTsNCgkJDQoJCQ0KCQkkcGF5ZXIgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+Z2V0X3BheWVycygpOw0KCQkkcm9sZV9yZXNvdXJjZXNfaWRzID0gJHRoaXMtPlhpbl9tb2RlbC0+dXNlcl9yb2xlX3Jlc291cmNlKCk7DQoJCSRkYXRhID0gYXJyYXkoKTsNCg0KICAgICAgICAgIGZvcmVhY2goJHBheWVyLT5yZXN1bHQoKSBhcyAkcikgew0KCQkJICANCgkJICAgLy8gY3JlYXRlIGF0DQoJCQkkY3JlYXRlZF9hdCA9ICR0aGlzLT5YaW5fbW9kZWwtPnNldF9kYXRlX2Zvcm1hdCgkci0+Y3JlYXRlZF9hdCk7DQoJCQlpZihpbl9hcnJheSgnMzY4Jywkcm9sZV9yZXNvdXJjZXNfaWRzKSkgeyAvL2VkaXQNCgkJCQkkZWRpdCA9ICc8c3BhbiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9InRvcCIgdGl0bGU9IicuJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lZGl0JykuJyI+PGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gaWNvbi1idG4gYnRuLXhzIGJ0bi1kZWZhdWx0IHdhdmVzLWVmZmVjdCB3YXZlcy1saWdodCIgIGRhdGEtdG9nZ2xlPSJtb2RhbCIgZGF0YS10YXJnZXQ9Ii5wYXlyb2xsX3RlbXBsYXRlX21vZGFsIiAgZGF0YS1wYXllcl9pZD0iJy4gJHItPnBheWVyX2lkIC4gJyI+PHNwYW4gY2xhc3M9ImZhIGZhLXBlbmNpbCI+PC9zcGFuPjwvYnV0dG9uPjwvc3Bhbj4nOw0KCQkJfSBlbHNlIHsNCgkJCQkkZWRpdCA9ICcnOw0KCQkJfQ0KCQkJaWYoaW5fYXJyYXkoJzM2OScsJHJvbGVfcmVzb3VyY2VzX2lkcykpIHsgLy8gZGVsZXRlDQoJCQkJJGRlbGV0ZSA9ICc8c3BhbiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9InRvcCIgdGl0bGU9IicuJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9kZWxldGUnKS4nIj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBpY29uLWJ0biBidG4teHMgYnRuLWRhbmdlciB3YXZlcy1lZmZlY3Qgd2F2ZXMtbGlnaHQgZGVsZXRlIiBkYXRhLXRvZ2dsZT0ibW9kYWwiIGRhdGEtdGFyZ2V0PSIuZGVsZXRlLW1vZGFsIiBkYXRhLXJlY29yZC1pZD0iJy4gJHItPnBheWVyX2lkIC4gJyI+PHNwYW4gY2xhc3M9ImZhIGZhLXRyYXNoIj48L3NwYW4+PC9idXR0b24+PC9zcGFuPic7DQoJCQl9IGVsc2Ugew0KCQkJCSRkZWxldGUgPSAnJzsNCgkJCX0NCgkJCQ0KCQkJJGNvbWJociA9ICRlZGl0LiRkZWxldGU7DQoJCQkkZGF0YVtdID0gYXJyYXkoDQoJCQkJJGNvbWJociwNCgkJCQkkci0+cGF5ZXJfbmFtZSwNCgkJCQkkci0+Y29udGFjdF9udW1iZXIsDQoJCQkJJGNyZWF0ZWRfYXQNCgkJICAgKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAkb3V0cHV0ID0gYXJyYXkoDQogICAgICAgICAgICAgICAiZHJhdyIgPT4gJGRyYXcsDQogICAgICAgICAgICAgICAgICJyZWNvcmRzVG90YWwiID0+ICRwYXllci0+bnVtX3Jvd3MoKSwNCiAgICAgICAgICAgICAgICAgInJlY29yZHNGaWx0ZXJlZCIgPT4gJHBheWVyLT5udW1fcm93cygpLA0KICAgICAgICAgICAgICAgICAiZGF0YSIgPT4gJGRhdGENCiAgICAgICAgICAgICk7DQogICAgICAgICAgZWNobyBqc29uX2VuY29kZSgkb3V0cHV0KTsNCiAgICAgICAgICBleGl0KCk7DQogICAgIH0NCgkgLy8gcGF5ZWVzIGxpc3QNCglwdWJsaWMgZnVuY3Rpb24gcGF5ZWVzX2xpc3QoKQ0KICAgICB7DQoNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9wYXllZXNfbGlzdCIsICRkYXRhKTsNCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkvLyBEYXRhdGFibGVzIFZhcmlhYmxlcw0KCQkkZHJhdyA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgiZHJhdyIpKTsNCgkJJHN0YXJ0ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJzdGFydCIpKTsNCgkJJGxlbmd0aCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgibGVuZ3RoIikpOw0KCQkNCgkJDQoJCSRwYXllZSA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5nZXRfcGF5ZWVzKCk7DQoJCSRyb2xlX3Jlc291cmNlc19pZHMgPSAkdGhpcy0+WGluX21vZGVsLT51c2VyX3JvbGVfcmVzb3VyY2UoKTsNCgkJJGRhdGEgPSBhcnJheSgpOw0KDQogICAgICAgICAgZm9yZWFjaCgkcGF5ZWUtPnJlc3VsdCgpIGFzICRyKSB7DQoJCQkgIA0KCQkgICAvLyBjcmVhdGUgYXQNCgkJCSRjcmVhdGVkX2F0ID0gJHRoaXMtPlhpbl9tb2RlbC0+c2V0X2RhdGVfZm9ybWF0KCRyLT5jcmVhdGVkX2F0KTsNCgkJCWlmKGluX2FycmF5KCczNjUnLCRyb2xlX3Jlc291cmNlc19pZHMpKSB7IC8vZWRpdA0KCQkJCSRlZGl0ID0gJzxzcGFuIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXBsYWNlbWVudD0idG9wIiB0aXRsZT0iJy4kdGhpcy0+bGFuZy0+bGluZSgneGluX2VkaXQnKS4nIj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBpY29uLWJ0biBidG4teHMgYnRuLWRlZmF1bHQgd2F2ZXMtZWZmZWN0IHdhdmVzLWxpZ2h0IiAgZGF0YS10b2dnbGU9Im1vZGFsIiBkYXRhLXRhcmdldD0iLnBheXJvbGxfdGVtcGxhdGVfbW9kYWwiICBkYXRhLXBheWVlX2lkPSInLiAkci0+cGF5ZWVfaWQgLiAnIj48c3BhbiBjbGFzcz0iZmEgZmEtcGVuY2lsIj48L3NwYW4+PC9idXR0b24+PC9zcGFuPic7DQoJCQl9IGVsc2Ugew0KCQkJCSRlZGl0ID0gJyc7DQoJCQl9DQoJCQlpZihpbl9hcnJheSgnMzY2Jywkcm9sZV9yZXNvdXJjZXNfaWRzKSkgeyAvLyBkZWxldGUNCgkJCQkkZGVsZXRlID0gJzxzcGFuIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXBsYWNlbWVudD0idG9wIiB0aXRsZT0iJy4kdGhpcy0+bGFuZy0+bGluZSgneGluX2RlbGV0ZScpLiciPjxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGljb24tYnRuIGJ0bi14cyBidG4tZGFuZ2VyIHdhdmVzLWVmZmVjdCB3YXZlcy1saWdodCBkZWxldGUiIGRhdGEtdG9nZ2xlPSJtb2RhbCIgZGF0YS10YXJnZXQ9Ii5kZWxldGUtbW9kYWwiIGRhdGEtcmVjb3JkLWlkPSInLiAkci0+cGF5ZWVfaWQgLiAnIj48c3BhbiBjbGFzcz0iZmEgZmEtdHJhc2giPjwvc3Bhbj48L2J1dHRvbj48L3NwYW4+JzsNCgkJCX0gZWxzZSB7DQoJCQkJJGRlbGV0ZSA9ICcnOw0KCQkJfQ0KCQkJDQoJCQkkY29tYmhyID0gJGVkaXQuJGRlbGV0ZTsNCgkJCSRkYXRhW10gPSBhcnJheSgNCgkJCQkkY29tYmhyLA0KCQkJCSRyLT5wYXllZV9uYW1lLA0KCQkJCSRyLT5jb250YWN0X251bWJlciwNCgkJCQkkY3JlYXRlZF9hdA0KCQkgICApOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgICRvdXRwdXQgPSBhcnJheSgNCiAgICAgICAgICAgICAgICJkcmF3IiA9PiAkZHJhdywNCiAgICAgICAgICAgICAgICAgInJlY29yZHNUb3RhbCIgPT4gJHBheWVlLT5udW1fcm93cygpLA0KICAgICAgICAgICAgICAgICAicmVjb3Jkc0ZpbHRlcmVkIiA9PiAkcGF5ZWUtPm51bV9yb3dzKCksDQogICAgICAgICAgICAgICAgICJkYXRhIiA9PiAkZGF0YQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICBlY2hvIGpzb25fZW5jb2RlKCRvdXRwdXQpOw0KICAgICAgICAgIGV4aXQoKTsNCiAgICAgfQ0KCSAvLyBiYW5rIGFuZCBjYXNoIGxpc3QNCglwdWJsaWMgZnVuY3Rpb24gYmFua19jYXNoX2xpc3QoKQ0KICAgICB7DQoNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9iYW5rX2Nhc2hfbGlzdCIsICRkYXRhKTsNCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkvLyBEYXRhdGFibGVzIFZhcmlhYmxlcw0KCQkkZHJhdyA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgiZHJhdyIpKTsNCgkJJHN0YXJ0ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJzdGFydCIpKTsNCgkJJGxlbmd0aCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgibGVuZ3RoIikpOw0KCQkNCgkJDQoJCSRiYW5rY2FzaCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5nZXRfYmFua2Nhc2goKTsNCgkJJHJvbGVfcmVzb3VyY2VzX2lkcyA9ICR0aGlzLT5YaW5fbW9kZWwtPnVzZXJfcm9sZV9yZXNvdXJjZSgpOw0KCQkkZGF0YSA9IGFycmF5KCk7DQoNCiAgICAgICAgICBmb3JlYWNoKCRiYW5rY2FzaC0+cmVzdWx0KCkgYXMgJHIpIHsNCgkJCSAgDQoJCQkvLyBnZXQgY3VycmVuY3kNCgkJCSRhY2NvdW50X2JhbGFuY2UgPSAkdGhpcy0+WGluX21vZGVsLT5jdXJyZW5jeV9zaWduKCRyLT5hY2NvdW50X2JhbGFuY2UpOw0KCQkJJGJhbmtfY2FzaCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5yZWFkX3RyYW5zYWN0aW9uX2J5X2JhbmtfaW5mbygkci0+YmFua2Nhc2hfaWQpOw0KCQkJaWYoIWlzX251bGwoJGJhbmtfY2FzaCkpew0KCQkJCSRhY2NvdW50ID0gJzxhIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXBsYWNlbWVudD0idG9wIiB0aXRsZT0iJy4kdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19sZWRnZXJfdmlldycpLiciIGhyZWY9Iicuc2l0ZV91cmwoJ2FkbWluL2FjY291bnRpbmcvYWNjb3VudHNfbGVkZ2VyLycuJHItPmJhbmtjYXNoX2lkLicnKS4nIiB0YXJnZXQ9Il9ibGFuayI+Jy4kci0+YWNjb3VudF9uYW1lLic8L2E+JzsNCgkJCX0gZWxzZSB7DQoJCQkJJGFjY291bnQgPSAkci0+YWNjb3VudF9uYW1lOw0KCQkJfQ0KCQkJJGVkaXQgPSAnPHNwYW4gZGF0YS10b2dnbGU9InRvb2x0aXAiIGRhdGEtcGxhY2VtZW50PSJ0b3AiIHRpdGxlPSInLiR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZWRpdCcpLiciPjxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGljb24tYnRuIGJ0bi14cyBidG4tZGVmYXVsdCB3YXZlcy1lZmZlY3Qgd2F2ZXMtbGlnaHQiICBkYXRhLXRvZ2dsZT0ibW9kYWwiIGRhdGEtdGFyZ2V0PSIjZWRpdC1tb2RhbC1kYXRhIiAgZGF0YS1iYW5rY2FzaF9pZD0iJy4gJHItPmJhbmtjYXNoX2lkIC4gJyI+PHNwYW4gY2xhc3M9ImZhIGZhLXBlbmNpbCI+PC9zcGFuPjwvYnV0dG9uPjwvc3Bhbj4nOw0KCQkJJGRlbGV0ZSA9ICc8c3BhbiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9InRvcCIgdGl0bGU9IicuJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9kZWxldGUnKS4nIj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBpY29uLWJ0biBidG4teHMgYnRuLWRhbmdlciB3YXZlcy1lZmZlY3Qgd2F2ZXMtbGlnaHQgZGVsZXRlIiBkYXRhLXRvZ2dsZT0ibW9kYWwiIGRhdGEtdGFyZ2V0PSIuZGVsZXRlLW1vZGFsIiBkYXRhLXJlY29yZC1pZD0iJy4gJHItPmJhbmtjYXNoX2lkIC4gJyI+PHNwYW4gY2xhc3M9ImZhIGZhLXRyYXNoIj48L3NwYW4+PC9idXR0b24+PC9zcGFuPic7DQoJCQkNCgkJCSRjb21iaHIgPSAkZWRpdC4kZGVsZXRlOw0KDQoJCSAgICRkYXRhW10gPSBhcnJheSgNCgkJCQkkY29tYmhyLA0KCQkJCSRhY2NvdW50LA0KCQkJCSRyLT5hY2NvdW50X251bWJlciwNCgkJCQkkci0+YnJhbmNoX2NvZGUsDQoJCQkJJGFjY291bnRfYmFsYW5jZSwNCgkJCQkkci0+YmFua19icmFuY2gNCgkJICAgKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAkb3V0cHV0ID0gYXJyYXkoDQogICAgICAgICAgICAgICAiZHJhdyIgPT4gJGRyYXcsDQogICAgICAgICAgICAgICAgICJyZWNvcmRzVG90YWwiID0+ICRiYW5rY2FzaC0+bnVtX3Jvd3MoKSwNCiAgICAgICAgICAgICAgICAgInJlY29yZHNGaWx0ZXJlZCIgPT4gJGJhbmtjYXNoLT5udW1fcm93cygpLA0KICAgICAgICAgICAgICAgICAiZGF0YSIgPT4gJGRhdGENCiAgICAgICAgICAgICk7DQogICAgICAgICAgZWNobyBqc29uX2VuY29kZSgkb3V0cHV0KTsNCiAgICAgICAgICBleGl0KCk7DQogICAgIH0NCgkgDQoJIC8vIGFjY291bnQgYmFsYW5jZXMgbGlzdA0KCXB1YmxpYyBmdW5jdGlvbiBhY2NvdW50X2JhbGFuY2VzX2xpc3QoKQ0KICAgICB7DQoNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9hY2NvdW50X2JhbGFuY2VzIiwgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCS8vIERhdGF0YWJsZXMgVmFyaWFibGVzDQoJCSRkcmF3ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJkcmF3IikpOw0KCQkkc3RhcnQgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoInN0YXJ0IikpOw0KCQkkbGVuZ3RoID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJsZW5ndGgiKSk7DQoJCQ0KCQkNCgkJJGJhbmtjYXNoID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmdldF9iYW5rY2FzaCgpOw0KCQkNCgkJJGRhdGEgPSBhcnJheSgpOw0KDQogICAgICAgICAgZm9yZWFjaCgkYmFua2Nhc2gtPnJlc3VsdCgpIGFzICRyKSB7DQoJCQkgIA0KCQkJICAvLyBnZXQgY3VycmVuY3kNCgkJCSAgJGFjY291bnRfYmFsYW5jZSA9ICR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJHItPmFjY291bnRfYmFsYW5jZSk7DQoJCQkgICRiYW5rX2Nhc2ggPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF90cmFuc2FjdGlvbl9ieV9iYW5rX2luZm8oJHItPmJhbmtjYXNoX2lkKTsNCgkJCSAgaWYoIWlzX251bGwoJGJhbmtfY2FzaCkpew0KCQkJICAJJGFjY291bnQgPSAnPGEgZGF0YS10b2dnbGU9InRvb2x0aXAiIGRhdGEtcGxhY2VtZW50PSJ0b3AiIHRpdGxlPSInLiR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2xlZGdlcl92aWV3JykuJyIgaHJlZj0iJy5zaXRlX3VybCgnYWRtaW4vYWNjb3VudGluZy9hY2NvdW50c19sZWRnZXIvJy4kci0+YmFua2Nhc2hfaWQuJycpLiciIHRhcmdldD0iX2JsYW5rIj4nLiRyLT5hY2NvdW50X25hbWUuJzwvYT4nOw0KCQkJICB9IGVsc2Ugew0KCQkJCSAgJGFjY291bnQgPSAkci0+YWNjb3VudF9uYW1lOw0KCQkJICB9DQoNCiAgICAgICAgICAgICAgICRkYXRhW10gPSBhcnJheSgNCiAgICAgICAgICAgICAgICAgICAgJGFjY291bnQsDQogICAgICAgICAgICAgICAgICAgICRhY2NvdW50X2JhbGFuY2UNCiAgICAgICAgICAgICAgICk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgJG91dHB1dCA9IGFycmF5KA0KICAgICAgICAgICAgICAgImRyYXciID0+ICRkcmF3LA0KICAgICAgICAgICAgICAgICAicmVjb3Jkc1RvdGFsIiA9PiAkYmFua2Nhc2gtPm51bV9yb3dzKCksDQogICAgICAgICAgICAgICAgICJyZWNvcmRzRmlsdGVyZWQiID0+ICRiYW5rY2FzaC0+bnVtX3Jvd3MoKSwNCiAgICAgICAgICAgICAgICAgImRhdGEiID0+ICRkYXRhDQogICAgICAgICAgICApOw0KICAgICAgICAgIGVjaG8ganNvbl9lbmNvZGUoJG91dHB1dCk7DQogICAgICAgICAgZXhpdCgpOw0KICAgICB9DQoJIA0KCSAvLyBkZXBvc2l0IGxpc3QNCglwdWJsaWMgZnVuY3Rpb24gZGVwb3NpdF9saXN0KCkgew0KDQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpeyANCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvZGVwb3NpdF9saXN0IiwgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCS8vIERhdGF0YWJsZXMgVmFyaWFibGVzDQoJCSRkcmF3ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJkcmF3IikpOw0KCQkkc3RhcnQgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoInN0YXJ0IikpOw0KCQkkbGVuZ3RoID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJsZW5ndGgiKSk7DQoJCQ0KCQkNCgkJJGRlcG9zaXQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+Z2V0X2RlcG9zaXQoKTsNCgkJJHJvbGVfcmVzb3VyY2VzX2lkcyA9ICR0aGlzLT5YaW5fbW9kZWwtPnVzZXJfcm9sZV9yZXNvdXJjZSgpOw0KCQkkZGF0YSA9IGFycmF5KCk7DQoNCiAgICAgICAgICBmb3JlYWNoKCRkZXBvc2l0LT5yZXN1bHQoKSBhcyAkcikgew0KCQkJICANCgkJCS8vIGdldCBhbW91bnQNCgkJCSRhbW91bnQgPSAkdGhpcy0+WGluX21vZGVsLT5jdXJyZW5jeV9zaWduKCRyLT5hbW91bnQpOw0KCQkJLy8gYWNjb3VudCB0eXBlDQoJCQkkYWNjX3R5cGUgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9iYW5rY2FzaF9pbmZvcm1hdGlvbigkci0+YWNjb3VudF9pZCk7DQoJCQlpZighaXNfbnVsbCgkYWNjX3R5cGUpKXsNCgkJCQkkYWNjb3VudCA9ICRhY2NfdHlwZVswXS0+YWNjb3VudF9uYW1lOw0KCQkJfSBlbHNlIHsNCgkJCQkkYWNjb3VudCA9ICctLSc7CQ0KCQkJfQ0KCQkJDQoJCQkvLyBnZXQgdXNlciA+IGFkZGVkIGJ5DQoJCQkkcGF5ZXIgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9wYXllcl9pbmZvKCRyLT5wYXllcl9wYXllZV9pZCk7DQoJCQkvLyB1c2VyIGZ1bGwgbmFtZQ0KCQkJaWYoIWlzX251bGwoJHBheWVyKSl7DQoJCQkJJGZ1bGxfbmFtZSA9ICRwYXllclswXS0+cGF5ZXJfbmFtZTsNCgkJCX0gZWxzZSB7DQoJCQkJJGZ1bGxfbmFtZSA9ICctLSc7CQ0KCQkJfQ0KCQkJDQoJCQkvLyBkZXBvc2l0IGRhdGUNCgkJCSRkZXBvc2l0X2RhdGUgPSAkdGhpcy0+WGluX21vZGVsLT5zZXRfZGF0ZV9mb3JtYXQoJHItPnRyYW5zYWN0aW9uX2RhdGUpOw0KCQkJLy8gY2F0ZWdvcnkNCgkJCSRjYXRlZ29yeV9pZCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5yZWFkX2luY29tZV9jYXRlZ29yeSgkci0+dHJhbnNhY3Rpb25fY2F0X2lkKTsNCgkJCWlmKCFpc19udWxsKCRjYXRlZ29yeV9pZCkpew0KCQkJCSRjYXRlZ29yeSA9ICRjYXRlZ29yeV9pZFswXS0+bmFtZTsNCgkJCX0gZWxzZSB7DQoJCQkJJGNhdGVnb3J5ID0gJy0tJzsJDQoJCQl9DQoJCQkvLyBwYXltZW50IG1ldGhvZCANCgkJCSRwYXltZW50X21ldGhvZCA9ICR0aGlzLT5YaW5fbW9kZWwtPnJlYWRfcGF5bWVudF9tZXRob2QoJHItPnBheW1lbnRfbWV0aG9kX2lkKTsNCgkJCWlmKCFpc19udWxsKCRwYXltZW50X21ldGhvZCkpew0KCQkJCSRtZXRob2RfbmFtZSA9ICRwYXltZW50X21ldGhvZFswXS0+bWV0aG9kX25hbWU7DQoJCQl9IGVsc2Ugew0KCQkJCSRtZXRob2RfbmFtZSA9ICctLSc7CQ0KCQkJfQ0KCQkJDQoJCQkkZWRpdCA9ICc8c3BhbiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9InRvcCIgdGl0bGU9IicuJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lZGl0JykuJyI+PGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gaWNvbi1idG4gYnRuLXhzIGJ0bi1kZWZhdWx0IHdhdmVzLWVmZmVjdCB3YXZlcy1saWdodCIgIGRhdGEtdG9nZ2xlPSJtb2RhbCIgZGF0YS10YXJnZXQ9Ii5lZGl0LW1vZGFsLWRhdGEiICBkYXRhLWRlcG9zaXRfaWQ9IicuICRyLT50cmFuc2FjdGlvbl9pZCAuICciPjxzcGFuIGNsYXNzPSJmYSBmYS1wZW5jaWwiPjwvc3Bhbj48L2J1dHRvbj48L3NwYW4+JzsNCgkJCSRkZWxldGUgPSAnPHNwYW4gZGF0YS10b2dnbGU9InRvb2x0aXAiIGRhdGEtcGxhY2VtZW50PSJ0b3AiIHRpdGxlPSInLiR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZGVsZXRlJykuJyI+PGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gaWNvbi1idG4gYnRuLXhzIGJ0bi1kYW5nZXIgd2F2ZXMtZWZmZWN0IHdhdmVzLWxpZ2h0IGRlbGV0ZSIgZGF0YS10b2dnbGU9Im1vZGFsIiBkYXRhLXRhcmdldD0iLmRlbGV0ZS1tb2RhbCIgZGF0YS1yZWNvcmQtaWQ9IicuICRyLT50cmFuc2FjdGlvbl9pZCAuICciPjxzcGFuIGNsYXNzPSJmYSBmYS10cmFzaCI+PC9zcGFuPjwvYnV0dG9uPjwvc3Bhbj4nOwkJCQ0KCQkJJGNvbWJociA9ICRlZGl0LiRkZWxldGU7DQoNCgkJICAgJGRhdGFbXSA9IGFycmF5KA0KCQkJCSRjb21iaHIsDQoJCQkJJGFjY291bnQsDQoJCQkJJGZ1bGxfbmFtZSwNCgkJCQkkYW1vdW50LA0KCQkJCSRjYXRlZ29yeSwNCgkJCQkkci0+cmVmZXJlbmNlLA0KCQkJCSRtZXRob2RfbmFtZSwNCgkJCQkkZGVwb3NpdF9kYXRlDQoJCSAgICk7DQoJICB9DQoNCgkgICRvdXRwdXQgPSBhcnJheSgNCgkJICAgImRyYXciID0+ICRkcmF3LA0KCQkJICJyZWNvcmRzVG90YWwiID0+ICRkZXBvc2l0LT5udW1fcm93cygpLA0KCQkJICJyZWNvcmRzRmlsdGVyZWQiID0+ICRkZXBvc2l0LT5udW1fcm93cygpLA0KCQkJICJkYXRhIiA9PiAkZGF0YQ0KCQkpOw0KCSAgZWNobyBqc29uX2VuY29kZSgkb3V0cHV0KTsNCgkgIGV4aXQoKTsNCiAgICAgfQ0KCSANCgkgLy8gZXhwZW5zZSBsaXN0DQoJcHVibGljIGZ1bmN0aW9uIGV4cGVuc2VfbGlzdCgpDQogICAgIHsNCg0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoZW1wdHkoJHNlc3Npb24pKXsgDQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCSR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL2V4cGVuc2VfbGlzdCIsICRkYXRhKTsNCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkvLyBEYXRhdGFibGVzIFZhcmlhYmxlcw0KCQkkZHJhdyA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgiZHJhdyIpKTsNCgkJJHN0YXJ0ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJzdGFydCIpKTsNCgkJJGxlbmd0aCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgibGVuZ3RoIikpOw0KCQkNCgkJDQoJCSRleHBlbnNlID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmdldF9leHBlbnNlKCk7DQoJCSRyb2xlX3Jlc291cmNlc19pZHMgPSAkdGhpcy0+WGluX21vZGVsLT51c2VyX3JvbGVfcmVzb3VyY2UoKTsNCgkJJGRhdGEgPSBhcnJheSgpOw0KDQogICAgICAgICAgZm9yZWFjaCgkZXhwZW5zZS0+cmVzdWx0KCkgYXMgJHIpIHsNCgkJCSAgDQoJCQkvLyBnZXQgYW1vdW50DQoJCQkkYW1vdW50ID0gJHRoaXMtPlhpbl9tb2RlbC0+Y3VycmVuY3lfc2lnbigkci0+YW1vdW50KTsNCgkJCS8vIGFjY291bnQgdHlwZQ0KCQkJJGFjY190eXBlID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfYmFua2Nhc2hfaW5mb3JtYXRpb24oJHItPmFjY291bnRfaWQpOw0KCQkJaWYoIWlzX251bGwoJGFjY190eXBlKSl7DQoJCQkJJGFjY291bnQgPSAkYWNjX3R5cGVbMF0tPmFjY291bnRfbmFtZTsNCgkJCX0gZWxzZSB7DQoJCQkJJGFjY291bnQgPSAnLS0nOwkNCgkJCX0NCgkJCQ0KCQkJLy8gZ2V0IHVzZXIgPiBhZGRlZCBieQ0KCQkJLy8kcGF5ZWUgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9wYXllZV9pbmZvKCRyLT5wYXllcl9wYXllZV9pZCk7DQoJCQkkcGF5ZWUgPSAkdGhpcy0+WGluX21vZGVsLT5yZWFkX3VzZXJfaW5mbygkci0+cGF5ZXJfcGF5ZWVfaWQpOw0KCQkJLy8gdXNlciBmdWxsIG5hbWUNCgkJCWlmKCFpc19udWxsKCRwYXllZSkpew0KCQkJCSRmdWxsX25hbWUgPSAkcGF5ZWVbMF0tPmZpcnN0X25hbWUuJyAnLiRwYXllZVswXS0+bGFzdF9uYW1lOw0KCQkJfSBlbHNlIHsNCgkJCQkkZnVsbF9uYW1lID0gJy0tJzsJDQoJCQl9DQoJCQkJCQkNCgkJCS8vIGRlcG9zaXQgZGF0ZQ0KCQkJJGV4cGVuc2VfZGF0ZSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNldF9kYXRlX2Zvcm1hdCgkci0+dHJhbnNhY3Rpb25fZGF0ZSk7DQoJCQkvLyBjYXRlZ29yeQ0KCQkJJGV4cGVuc2VfdHlwZSA9ICR0aGlzLT5FeHBlbnNlX21vZGVsLT5yZWFkX2V4cGVuc2VfdHlwZV9pbmZvcm1hdGlvbigkci0+dHJhbnNhY3Rpb25fY2F0X2lkKTsNCgkJCWlmKCFpc19udWxsKCRleHBlbnNlX3R5cGUpKXsNCgkJCQkkY2F0ZWdvcnkgPSAkZXhwZW5zZV90eXBlWzBdLT5uYW1lOw0KCQkJfSBlbHNlIHsNCgkJCQkkY2F0ZWdvcnkgPSAnLS0nOwkNCgkJCX0NCgkJCQ0KCQkJLy8gcGF5bWVudCBtZXRob2QgDQoJCQkkcGF5bWVudF9tZXRob2QgPSAkdGhpcy0+WGluX21vZGVsLT5yZWFkX3BheW1lbnRfbWV0aG9kKCRyLT5wYXltZW50X21ldGhvZF9pZCk7DQoJCQlpZighaXNfbnVsbCgkcGF5bWVudF9tZXRob2QpKXsNCgkJCQkkbWV0aG9kX25hbWUgPSAkcGF5bWVudF9tZXRob2RbMF0tPm1ldGhvZF9uYW1lOw0KCQkJfSBlbHNlIHsNCgkJCQkkbWV0aG9kX25hbWUgPSAnLS0nOwkNCgkJCX0NCgkJCSRlZGl0ID0gJzxzcGFuIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXBsYWNlbWVudD0idG9wIiB0aXRsZT0iJy4kdGhpcy0+bGFuZy0+bGluZSgneGluX2VkaXQnKS4nIj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBpY29uLWJ0biBidG4teHMgYnRuLWRlZmF1bHQgd2F2ZXMtZWZmZWN0IHdhdmVzLWxpZ2h0IiAgZGF0YS10b2dnbGU9Im1vZGFsIiBkYXRhLXRhcmdldD0iLmVkaXQtbW9kYWwtZGF0YSIgIGRhdGEtZXhwZW5zZV9pZD0iJy4gJHItPnRyYW5zYWN0aW9uX2lkIC4gJyI+PHNwYW4gY2xhc3M9ImZhIGZhLXBlbmNpbCI+PC9zcGFuPjwvYnV0dG9uPjwvc3Bhbj4nOw0KCQkJJGRlbGV0ZSA9ICc8c3BhbiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9InRvcCIgdGl0bGU9IicuJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9kZWxldGUnKS4nIj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBpY29uLWJ0biBidG4teHMgYnRuLWRhbmdlciB3YXZlcy1lZmZlY3Qgd2F2ZXMtbGlnaHQgZGVsZXRlIiBkYXRhLXRvZ2dsZT0ibW9kYWwiIGRhdGEtdGFyZ2V0PSIuZGVsZXRlLW1vZGFsIiBkYXRhLXJlY29yZC1pZD0iJy4gJHItPnRyYW5zYWN0aW9uX2lkIC4gJyI+PHNwYW4gY2xhc3M9ImZhIGZhLXRyYXNoIj48L3NwYW4+PC9idXR0b24+PC9zcGFuPic7CQkJDQoJCQkkY29tYmhyID0gJGVkaXQuJGRlbGV0ZTsNCg0KCQkgICAJJGRhdGFbXSA9IGFycmF5KA0KCQkJCSRjb21iaHIsDQoJCQkJJGFjY291bnQsDQoJCQkJJGZ1bGxfbmFtZSwNCgkJCQkkYW1vdW50LA0KCQkJCSRjYXRlZ29yeSwNCgkJCQkkci0+cmVmZXJlbmNlLA0KCQkJCSRtZXRob2RfbmFtZSwNCgkJCQkkZXhwZW5zZV9kYXRlDQoJCSAgICk7DQoJICB9DQoNCgkgICRvdXRwdXQgPSBhcnJheSgNCgkJICAgImRyYXciID0+ICRkcmF3LA0KCQkJICJyZWNvcmRzVG90YWwiID0+ICRleHBlbnNlLT5udW1fcm93cygpLA0KCQkJICJyZWNvcmRzRmlsdGVyZWQiID0+ICRleHBlbnNlLT5udW1fcm93cygpLA0KCQkJICJkYXRhIiA9PiAkZGF0YQ0KCQkpOw0KCSAgZWNobyBqc29uX2VuY29kZSgkb3V0cHV0KTsNCgkgIGV4aXQoKTsNCiAgICAgfQkgDQoJIA0KCS8vIHRyYW5zYWN0aW9ucyBsaXN0DQoJcHVibGljIGZ1bmN0aW9uIHRyYW5zYWN0aW9uX2xpc3QoKQ0KICAgICB7DQoNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy90cmFuc2FjdGlvbl9saXN0IiwgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCS8vIERhdGF0YWJsZXMgVmFyaWFibGVzDQoJCSRkcmF3ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJkcmF3IikpOw0KCQkkc3RhcnQgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoInN0YXJ0IikpOw0KCQkkbGVuZ3RoID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJsZW5ndGgiKSk7DQoJCQ0KCQkNCgkJJHRyYW5zYWN0aW9uID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmdldF90cmFuc2FjdGlvbigpOw0KCQkkcm9sZV9yZXNvdXJjZXNfaWRzID0gJHRoaXMtPlhpbl9tb2RlbC0+dXNlcl9yb2xlX3Jlc291cmNlKCk7DQoJCSRkYXRhID0gYXJyYXkoKTsNCgkJJGJhbGFuY2UyID0gMDsNCiAgICAgICAgICBmb3JlYWNoKCR0cmFuc2FjdGlvbi0+cmVzdWx0KCkgYXMgJHIpIHsNCgkJCSAgDQoJCQkvLyB0cmFuc2FjdGlvbiBkYXRlDQoJCQkkdHJhbnNhY3Rpb25fZGF0ZSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNldF9kYXRlX2Zvcm1hdCgkci0+dHJhbnNhY3Rpb25fZGF0ZSk7DQoJCQkvLyBnZXQgY3VycmVuY3kNCgkJCSR0b3RhbF9hbW91bnQgPSAkdGhpcy0+WGluX21vZGVsLT5jdXJyZW5jeV9zaWduKCRyLT5hbW91bnQpOw0KCQkJLy8gY3JlZGl0DQoJCQkkY3JfZHIgPSAkci0+ZHJfY3I9PSJkciIgPyAiRGViaXQiIDogIkNyZWRpdCI7DQoJCQkNCgkJCS8vIGFjY291bnQgdHlwZQ0KCQkJJGFjY190eXBlID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfYmFua2Nhc2hfaW5mb3JtYXRpb24oJHItPmFjY291bnRfaWQpOw0KCQkJaWYoIWlzX251bGwoJGFjY190eXBlKSl7DQoJCQkJJGFjY291bnQgPSAnPGEgaHJlZj0iJy5zaXRlX3VybCgnYWRtaW4vYWNjb3VudGluZy9hY2NvdW50c19sZWRnZXIvJy4kci0+YWNjb3VudF9pZC4nJykuJyIgdGl0bGU9IicuJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfbGVkZ2VyX3ZpZXcnKS4nIiB0YXJnZXQ9Il9ibGFuayI+Jy4kYWNjX3R5cGVbMF0tPmFjY291bnRfbmFtZS4nPC9hPic7DQoJCQl9IGVsc2Ugew0KCQkJCSRhY2NvdW50ID0gJy0tJzsJDQoJCQl9DQoJCQkvLw0KCQkJaWYoJHItPmRyX2NyPT0iY3IiKXsNCgkJCQkkZWRpdCA9ICc8c3BhbiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9InRvcCIgdGl0bGU9IicuJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lZGl0JykuJyI+PGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gaWNvbi1idG4gYnRuLXhzIGJ0bi1kZWZhdWx0IHdhdmVzLWVmZmVjdCB3YXZlcy1saWdodCIgIGRhdGEtdG9nZ2xlPSJtb2RhbCIgZGF0YS10YXJnZXQ9Ii52aWV3LW1vZGFsLWRhdGEtYmciICBkYXRhLWRlcG9zaXRfaWQ9IicuICRyLT50cmFuc2FjdGlvbl9pZCAuICciPjxzcGFuIGNsYXNzPSJmYSBmYS1wZW5jaWwiPjwvc3Bhbj48L2J1dHRvbj48L3NwYW4+JzsNCgkJCX0gZWxzZSB7DQoJCQkJJGVkaXQgPSAnPHNwYW4gZGF0YS10b2dnbGU9InRvb2x0aXAiIGRhdGEtcGxhY2VtZW50PSJ0b3AiIHRpdGxlPSInLiR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZWRpdCcpLiciPjxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGljb24tYnRuIGJ0bi14cyBidG4tZGVmYXVsdCB3YXZlcy1lZmZlY3Qgd2F2ZXMtbGlnaHQiICBkYXRhLXRvZ2dsZT0ibW9kYWwiIGRhdGEtdGFyZ2V0PSIuZWRpdC1tb2RhbC1kYXRhIiAgZGF0YS1leHBlbnNlX2lkPSInLiAkci0+dHJhbnNhY3Rpb25faWQgLiAnIj48c3BhbiBjbGFzcz0iZmEgZmEtcGVuY2lsIj48L3NwYW4+PC9idXR0b24+PC9zcGFuPic7DQoJCQl9DQoJCQkkZGVsZXRlID0gJzxzcGFuIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXBsYWNlbWVudD0idG9wIiB0aXRsZT0iJy4kdGhpcy0+bGFuZy0+bGluZSgneGluX2RlbGV0ZScpLiciPjxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGljb24tYnRuIGJ0bi14cyBidG4tZGFuZ2VyIHdhdmVzLWVmZmVjdCB3YXZlcy1saWdodCBkZWxldGUiIGRhdGEtdG9nZ2xlPSJtb2RhbCIgZGF0YS10YXJnZXQ9Ii5kZWxldGUtbW9kYWwiIGRhdGEtcmVjb3JkLWlkPSInLiAkci0+dHJhbnNhY3Rpb25faWQgLiAnIj48c3BhbiBjbGFzcz0iZmEgZmEtdHJhc2giPjwvc3Bhbj48L2J1dHRvbj48L3NwYW4+JzsJCQkNCgkJCSRjb21iaHIgPSAkZWRpdC4kZGVsZXRlOw0KCQkJDQoJCQkkZGF0YVtdID0gYXJyYXkoDQoJCQkJJHRyYW5zYWN0aW9uX2RhdGUsDQoJCQkJJGFjY291bnQsDQoJCQkJJGNyX2RyLA0KCQkJCSRyLT50cmFuc2FjdGlvbl90eXBlLA0KCQkJCSR0b3RhbF9hbW91bnQsDQoJCQkJJHItPnJlZmVyZW5jZQ0KCQkJKTsNCgkJICB9DQoNCiAgICAgICAgICAkb3V0cHV0ID0gYXJyYXkoDQogICAgICAgICAgICAgICAiZHJhdyIgPT4gJGRyYXcsDQogICAgICAgICAgICAgICAgICJyZWNvcmRzVG90YWwiID0+ICR0cmFuc2FjdGlvbi0+bnVtX3Jvd3MoKSwNCiAgICAgICAgICAgICAgICAgInJlY29yZHNGaWx0ZXJlZCIgPT4gJHRyYW5zYWN0aW9uLT5udW1fcm93cygpLA0KICAgICAgICAgICAgICAgICAiZGF0YSIgPT4gJGRhdGENCiAgICAgICAgICAgICk7DQogICAgICAgICAgZWNobyBqc29uX2VuY29kZSgkb3V0cHV0KTsNCiAgICAgICAgICBleGl0KCk7DQogICAgIH0NCgkgDQoJIC8vIFZhbGlkYXRlIGFuZCBhZGQgaW5mbyBpbiBkYXRhYmFzZQ0KCXB1YmxpYyBmdW5jdGlvbiBhZGRfZGVwb3NpdCgpIHsNCgkNCgkJaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdhZGRfdHlwZScpPT0nZGVwb3NpdCcpIHsJCQ0KCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJCQ0KCQkvKiBTZXJ2ZXIgc2lkZSBQSFAgaW5wdXQgdmFsaWRhdGlvbiAqLw0KCQkkZGVzY3JpcHRpb24gPSAkdGhpcy0+aW5wdXQtPnBvc3QoJ2Rlc2NyaXB0aW9uJyk7DQoJCSRxdF9kZXNjcmlwdGlvbiA9IGh0bWxzcGVjaWFsY2hhcnMoYWRkc2xhc2hlcygkZGVzY3JpcHRpb24pLCBFTlRfUVVPVEVTKTsNCgkJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYmFua19jYXNoX2lkJyk9PT0nJykgew0KICAgICAgICAkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfYWNjb3VudF9maWVsZCcpOw0KCQl9IGVsc2UgaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdhbW91bnQnKT09PScnKSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9hbW91bnRfZmllbGQnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnZGVwb3NpdF9kYXRlJyk9PT0nJykgew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2Vycm9yX2RlcG9zaXRfZGF0ZScpOw0KCQl9DQoJCWVsc2UgaWYoJF9GSUxFU1snZGVwb3NpdF9maWxlJ11bJ3NpemUnXSA9PSAwKSB7DQoJCQkkZm5hbWUgPSAnbm9fZmlsZSc7DQoJCX0NCgkJZWxzZSBpZihpc191cGxvYWRlZF9maWxlKCRfRklMRVNbJ2RlcG9zaXRfZmlsZSddWyd0bXBfbmFtZSddKSkgew0KCQkJLy9jaGVja2luZyBpbWFnZSB0eXBlDQoJCQkvLyRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9hdHRhY2htZW50Jyk7DQoJCQkkYWxsb3dlZCA9ICBhcnJheSgnUE5HJywnSlBHJywnSlBFRycsJ1BERicsJ0dJRicsJ3BuZycsJ2pwZycsJ2pwZWcnLCdwZGYnLCdnaWYnLCd0eHQnLCdkb2MnLCdkb2N4JywneGxzJywneGxzeCcpOw0KCQkJJGZpbGVuYW1lID0gJF9GSUxFU1snZGVwb3NpdF9maWxlJ11bJ25hbWUnXTsNCgkJCSRleHQgPSBwYXRoaW5mbygkZmlsZW5hbWUsIFBBVEhJTkZPX0VYVEVOU0lPTik7DQoJCQkNCgkJCWlmKGluX2FycmF5KCRleHQsJGFsbG93ZWQpKXsNCgkJCQkkdG1wX25hbWUgPSAkX0ZJTEVTWyJkZXBvc2l0X2ZpbGUiXVsidG1wX25hbWUiXTsNCgkJCQkkcHJvZmlsZSA9ICJ1cGxvYWRzL2FjY291bnRpbmcvZGVwb3NpdC8iOw0KCQkJCSRzZXRfaW1nID0gYmFzZV91cmwoKS4idXBsb2Fkcy9hY2NvdW50aW5nL2RlcG9zaXQvIjsNCgkJCQkvLyBiYXNlbmFtZSgpIG1heSBwcmV2ZW50IGZpbGVzeXN0ZW0gdHJhdmVyc2FsIGF0dGFja3M7DQoJCQkJLy8gZnVydGhlciB2YWxpZGF0aW9uL3Nhbml0YXRpb24gb2YgdGhlIGZpbGVuYW1lIG1heSBiZSBhcHByb3ByaWF0ZQ0KCQkJCSRuYW1lID0gYmFzZW5hbWUoJF9GSUxFU1siZGVwb3NpdF9maWxlIl1bIm5hbWUiXSk7DQoJCQkJJG5ld2ZpbGVuYW1lID0gJ2RlcG9zaXRfJy5yb3VuZChtaWNyb3RpbWUodHJ1ZSkpLicuJy4kZXh0Ow0KCQkJCW1vdmVfdXBsb2FkZWRfZmlsZSgkdG1wX25hbWUsICRwcm9maWxlLiRuZXdmaWxlbmFtZSk7DQoJCQkJJGZuYW1lID0gJG5ld2ZpbGVuYW1lOwkJCQkJDQoJCQl9IGVsc2Ugew0KCQkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9hdHRhY2htZW50Jyk7DQoJCQl9DQoJCX0NCgkJCQkNCgkJaWYoJFJldHVyblsnZXJyb3InXSE9Jycpew0KICAgICAgIAkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCiAgICAJfQ0KCQkNCgkJJGRhdGEgPSBhcnJheSgNCgkJJ2FjY291bnRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYmFua19jYXNoX2lkJyksDQoJCSdhbW91bnQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYW1vdW50JyksDQoJCSd0cmFuc2FjdGlvbl90eXBlJyA9PiAnaW5jb21lJywNCgkJJ2RyX2NyJyA9PiAnZHInLA0KCQkndHJhbnNhY3Rpb25fZGF0ZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdkZXBvc2l0X2RhdGUnKSwNCgkJJ2F0dGFjaG1lbnRfZmlsZScgPT4gJGZuYW1lLA0KCQkndHJhbnNhY3Rpb25fY2F0X2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2NhdGVnb3J5X2lkJyksDQoJCSdwYXllcl9wYXllZV9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdwYXllcl9pZCcpLA0KCQkncGF5bWVudF9tZXRob2RfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgncGF5bWVudF9tZXRob2QnKSwNCgkJJ2Rlc2NyaXB0aW9uJyA9PiAkcXRfZGVzY3JpcHRpb24sDQoJCSdyZWZlcmVuY2UnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnZGVwb3NpdF9yZWZlcmVuY2UnKSwNCgkJJ2ludm9pY2VfaWQnID0+IDAsDQoJCSdjcmVhdGVkX2F0JyA9PiBkYXRlKCdZLW0tZCBIOmk6cycpDQoJCSk7DQoJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWRkX3RyYW5zYWN0aW9ucygkZGF0YSk7DQoJCWlmICgkcmVzdWx0ID09IFRSVUUpIHsJCQkNCgkJCS8vIGFkZCBkYXRhIHRvIGJhbmsgYWNjb3VudD5jcg0KCQkJJGFjY291bnRfaWQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9iYW5rY2FzaF9pbmZvcm1hdGlvbigkdGhpcy0+aW5wdXQtPnBvc3QoJ2JhbmtfY2FzaF9pZCcpKTsNCgkJCSRhY2NfYmFsYW5jZSA9ICRhY2NvdW50X2lkWzBdLT5hY2NvdW50X2JhbGFuY2UgKyAkdGhpcy0+aW5wdXQtPnBvc3QoJ2Ftb3VudCcpOw0KCQkJDQoJCQkkZGF0YTMgPSBhcnJheSgNCgkJCSdhY2NvdW50X2JhbGFuY2UnID0+ICRhY2NfYmFsYW5jZQ0KCQkJKTsNCgkJCSR0aGlzLT5GaW5hbmNlX21vZGVsLT51cGRhdGVfYmFua2Nhc2hfcmVjb3JkKCRkYXRhMywkdGhpcy0+aW5wdXQtPnBvc3QoJ2JhbmtfY2FzaF9pZCcpKTsNCgkJDQoJCQkkUmV0dXJuWydyZXN1bHQnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3N1Y2Nlc3NfZGVwb3NpdF9hZGRlZCcpOw0KCQl9IGVsc2Ugew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3InKTsNCgkJfQ0KCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KCQlleGl0Ow0KCQ0KCQkNCgkJfQ0KCX0gDQoJDQoJLy8gVmFsaWRhdGUgYW5kIGFkZCBpbmZvIGluIGRhdGFiYXNlDQoJcHVibGljIGZ1bmN0aW9uIGFkZF9leHBlbnNlKCkgew0KCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2FkZF90eXBlJyk9PSdleHBlbnNlJykgewkJDQoJCS8qIERlZmluZSByZXR1cm4gfCBoZXJlIHJlc3VsdCBpcyB1c2VkIHRvIHJldHVybiB1c2VyIGRhdGEgYW5kIGVycm9yIGZvciBlcnJvciBtZXNzYWdlICovDQoJCSRSZXR1cm4gPSBhcnJheSgncmVzdWx0Jz0+JycsICdlcnJvcic9PicnLCAnY3NyZl9oYXNoJz0+JycpOw0KCQkkUmV0dXJuWydjc3JmX2hhc2gnXSA9ICR0aGlzLT5zZWN1cml0eS0+Z2V0X2NzcmZfaGFzaCgpOw0KCQkJDQoJCS8qIFNlcnZlciBzaWRlIFBIUCBpbnB1dCB2YWxpZGF0aW9uICovDQoJCSRkZXNjcmlwdGlvbiA9ICR0aGlzLT5pbnB1dC0+cG9zdCgnZGVzY3JpcHRpb24nKTsNCgkJJHF0X2Rlc2NyaXB0aW9uID0gaHRtbHNwZWNpYWxjaGFycyhhZGRzbGFzaGVzKCRkZXNjcmlwdGlvbiksIEVOVF9RVU9URVMpOw0KCQkkYmFua19jYXNoID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfYmFua2Nhc2hfaW5mb3JtYXRpb24oJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKSk7DQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYmFua19jYXNoX2lkJyk9PT0nJykgew0KICAgICAgICAkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfYWNjb3VudF9maWVsZCcpOw0KCQl9IGVsc2UgaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdhbW91bnQnKT09PScnKSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9hbW91bnRfZmllbGQnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYW1vdW50JykgPiAkYmFua19jYXNoWzBdLT5hY2NvdW50X2JhbGFuY2UpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9hbW91bnRfc2hvdWxkX2JlX2xlc3NfdGhhbl9jdXJyZW50Jyk7DQoJCX0gZWxzZSBpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2V4cGVuc2VfZGF0ZScpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9leHBlbnNlX2RhdGUnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnY29tcGFueScpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgnZXJyb3JfY29tcGFueV9maWVsZCcpOw0KCQl9IGVsc2UgaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdlbXBsb3llZV9pZCcpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yX2VtcGxveWVlX2lkJyk7DQoJCX0NCgkJZWxzZSBpZigkX0ZJTEVTWydleHBlbnNlX2ZpbGUnXVsnc2l6ZSddID09IDApIHsNCgkJCSRmbmFtZSA9ICdub19maWxlJzsNCgkJfQ0KCQllbHNlIGlmKGlzX3VwbG9hZGVkX2ZpbGUoJF9GSUxFU1snZXhwZW5zZV9maWxlJ11bJ3RtcF9uYW1lJ10pKSB7DQoJCQkvL2NoZWNraW5nIGltYWdlIHR5cGUNCgkJCSRhbGxvd2VkID0gIGFycmF5KCdwbmcnLCdqcGcnLCdqcGVnJywncGRmJywnZ2lmJywndHh0JywnZG9jJywnZG9jeCcsJ3hscycsJ3hsc3gnKTsNCgkJCSRmaWxlbmFtZSA9ICRfRklMRVNbJ2V4cGVuc2VfZmlsZSddWyduYW1lJ107DQoJCQkkZXh0ID0gcGF0aGluZm8oJGZpbGVuYW1lLCBQQVRISU5GT19FWFRFTlNJT04pOw0KCQkJDQoJCQlpZihpbl9hcnJheSgkZXh0LCRhbGxvd2VkKSl7DQoJCQkJJHRtcF9uYW1lID0gJF9GSUxFU1siZXhwZW5zZV9maWxlIl1bInRtcF9uYW1lIl07DQoJCQkJJHByb2ZpbGUgPSAidXBsb2Fkcy9hY2NvdW50aW5nL2V4cGVuc2UvIjsNCgkJCQkkc2V0X2ltZyA9IGJhc2VfdXJsKCkuInVwbG9hZHMvYWNjb3VudGluZy9leHBlbnNlLyI7DQoJCQkJLy8gYmFzZW5hbWUoKSBtYXkgcHJldmVudCBmaWxlc3lzdGVtIHRyYXZlcnNhbCBhdHRhY2tzOw0KCQkJCS8vIGZ1cnRoZXIgdmFsaWRhdGlvbi9zYW5pdGF0aW9uIG9mIHRoZSBmaWxlbmFtZSBtYXkgYmUgYXBwcm9wcmlhdGUNCgkJCQkkbmFtZSA9IGJhc2VuYW1lKCRfRklMRVNbImV4cGVuc2VfZmlsZSJdWyJuYW1lIl0pOw0KCQkJCSRuZXdmaWxlbmFtZSA9ICdleHBlbnNlXycucm91bmQobWljcm90aW1lKHRydWUpKS4nLicuJGV4dDsNCgkJCQltb3ZlX3VwbG9hZGVkX2ZpbGUoJHRtcF9uYW1lLCAkcHJvZmlsZS4kbmV3ZmlsZW5hbWUpOw0KCQkJCSRmbmFtZSA9ICRuZXdmaWxlbmFtZTsJCQkJCQ0KCQkJfSBlbHNlIHsNCgkJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfYXR0YWNobWVudCcpOw0KCQkJfQ0KCQl9DQoJCQkJDQoJCWlmKCRSZXR1cm5bJ2Vycm9yJ10hPScnKXsNCiAgICAgICAJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQogICAgCX0NCgkJDQoJCSRkYXRhID0gYXJyYXkoDQoJCSdhY2NvdW50X2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2JhbmtfY2FzaF9pZCcpLA0KCQknYW1vdW50JyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2Ftb3VudCcpLA0KCQkndHJhbnNhY3Rpb25fdHlwZScgPT4gJ2V4cGVuc2UnLA0KCQknZHJfY3InID0+ICdjcicsDQoJCSd0cmFuc2FjdGlvbl9kYXRlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2V4cGVuc2VfZGF0ZScpLA0KCQknYXR0YWNobWVudF9maWxlJyA9PiAkZm5hbWUsDQoJCSd0cmFuc2FjdGlvbl9jYXRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnY2F0ZWdvcnlfaWQnKSwNCgkJJ3BheWVyX3BheWVlX2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheWVlX2lkJyksDQoJCSdjb21wYW55X2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2NvbXBhbnknKSwNCgkJJ3BheW1lbnRfbWV0aG9kX2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheW1lbnRfbWV0aG9kJyksDQoJCSdkZXNjcmlwdGlvbicgPT4gJHF0X2Rlc2NyaXB0aW9uLA0KCQkncmVmZXJlbmNlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2V4cGVuc2VfcmVmZXJlbmNlJyksDQoJCSdpbnZvaWNlX2lkJyA9PiAwLA0KCQknY3JlYXRlZF9hdCcgPT4gZGF0ZSgnWS1tLWQgSDppOnMnKQ0KCQkpOw0KCQkkcmVzdWx0ID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFkZF90cmFuc2FjdGlvbnMoJGRhdGEpOw0KCQlpZiAoJHJlc3VsdCA9PSBUUlVFKSB7CQkJDQoJCQkvLyB1cGRhdGUgZGF0YSBpbiBiYW5rIGFjY291bnQNCgkJCSRhY2NvdW50X2lkID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfYmFua2Nhc2hfaW5mb3JtYXRpb24oJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKSk7DQoJCQkkYWNjX2JhbGFuY2UgPSAkYWNjb3VudF9pZFswXS0+YWNjb3VudF9iYWxhbmNlIC0gJHRoaXMtPmlucHV0LT5wb3N0KCdhbW91bnQnKTsNCgkJCQ0KCQkJJGRhdGEzID0gYXJyYXkoDQoJCQknYWNjb3VudF9iYWxhbmNlJyA9PiAkYWNjX2JhbGFuY2UNCgkJCSk7DQoJCQkkdGhpcy0+RmluYW5jZV9tb2RlbC0+dXBkYXRlX2JhbmtjYXNoX3JlY29yZCgkZGF0YTMsJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKSk7DQoJCQkNCgkJCSRSZXR1cm5bJ3Jlc3VsdCddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2Nfc3VjY2Vzc19leHBlbnNlX2FkZGVkJyk7DQoJCX0gZWxzZSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcicpOw0KCQl9DQoJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQoJCWV4aXQ7DQoJDQoJCQ0KCQl9DQoJfSANCgkNCgkvLyBWYWxpZGF0ZSBhbmQgYWRkIGluZm8gaW4gZGF0YWJhc2UNCglwdWJsaWMgZnVuY3Rpb24gYWRkX2ludm9pY2VfcGF5bWVudCgpIHsNCgkNCgkJaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdhZGRfdHlwZScpPT0naW52b2ljZV9wYXltZW50JykgewkJDQoJCS8qIERlZmluZSByZXR1cm4gfCBoZXJlIHJlc3VsdCBpcyB1c2VkIHRvIHJldHVybiB1c2VyIGRhdGEgYW5kIGVycm9yIGZvciBlcnJvciBtZXNzYWdlICovDQoJCSRSZXR1cm4gPSBhcnJheSgncmVzdWx0Jz0+JycsICdlcnJvcic9PicnLCAnY3NyZl9oYXNoJz0+JycpOw0KCQkkUmV0dXJuWydjc3JmX2hhc2gnXSA9ICR0aGlzLT5zZWN1cml0eS0+Z2V0X2NzcmZfaGFzaCgpOw0KCQkJDQoJCS8qIFNlcnZlciBzaWRlIFBIUCBpbnB1dCB2YWxpZGF0aW9uICovDQoJCSRkZXNjcmlwdGlvbiA9ICR0aGlzLT5pbnB1dC0+cG9zdCgnZGVzY3JpcHRpb24nKTsNCgkJJHF0X2Rlc2NyaXB0aW9uID0gaHRtbHNwZWNpYWxjaGFycyhhZGRzbGFzaGVzKCRkZXNjcmlwdGlvbiksIEVOVF9RVU9URVMpOw0KCQkNCgkJJGludm9pY2VfdHIgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9pbnZvaWNlX3RyYW5zYWN0aW9uKCR0aGlzLT5pbnB1dC0+cG9zdCgnaW52b2ljZV9pZCcpKTsNCgkJaWYgKCRpbnZvaWNlX3RyLT5udW1fcm93cygpID4gMCkgew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2ludl9wYWlkX2FscmVhZHknKTsNCgkJfSANCgkJaWYoJFJldHVyblsnZXJyb3InXSE9Jycpew0KICAgICAgIAkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCiAgICAJfQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2JhbmtfY2FzaF9pZCcpPT09JycpIHsNCiAgICAgICAgCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9hY2NvdW50X2ZpZWxkJyk7DQoJCX0gZWxzZSBpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2Ftb3VudCcpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yX2Ftb3VudF9maWVsZCcpOw0KCQl9IGVsc2UgaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdhZGRfaW52b2ljZV9kYXRlJyk9PT0nJykgew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2Vycm9yX2RlcG9zaXRfZGF0ZScpOw0KCQl9IGVsc2UgaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdwYXltZW50X21ldGhvZCcpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yX21ha2VwYXltZW50X3BheW1lbnRfbWV0aG9kJyk7DQoJCX0NCgkJCQkNCgkJaWYoJFJldHVyblsnZXJyb3InXSE9Jycpew0KICAgICAgIAkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCiAgICAJfQ0KCQkkaW52b2ljZV9pZCA9ICR0aGlzLT5pbnB1dC0+cG9zdCgnaW52b2ljZV9pZCcpOw0KCQkkZGF0YSA9IGFycmF5KA0KCQknYWNjb3VudF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKSwNCgkJJ2Ftb3VudCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdhbW91bnQnKSwNCgkJJ3RyYW5zYWN0aW9uX3R5cGUnID0+ICdpbmNvbWUnLA0KCQknaW52b2ljZV90eXBlJyA9PiAnY3VzdG9tZXInLA0KCQknZHJfY3InID0+ICdkcicsDQoJCSd0cmFuc2FjdGlvbl9kYXRlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2FkZF9pbnZvaWNlX2RhdGUnKSwNCgkJJ2F0dGFjaG1lbnRfZmlsZScgPT4gJycsDQoJCSd0cmFuc2FjdGlvbl9jYXRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnY2F0ZWdvcnlfaWQnKSwNCgkJJ3BheWVyX3BheWVlX2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheWVyX2lkJyksDQoJCSdwYXltZW50X21ldGhvZF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdwYXltZW50X21ldGhvZCcpLA0KCQknZGVzY3JpcHRpb24nID0+ICRxdF9kZXNjcmlwdGlvbiwNCgkJJ3JlZmVyZW5jZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdyZWZlcmVuY2UnKSwNCgkJJ2ludm9pY2VfaWQnID0+ICRpbnZvaWNlX2lkLA0KCQknY3JlYXRlZF9hdCcgPT4gZGF0ZSgnWS1tLWQgSDppOnMnKQ0KCQkpOw0KCQkkcmVzdWx0ID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFkZF90cmFuc2FjdGlvbnMoJGRhdGEpOw0KCQlpZiAoJHJlc3VsdCA9PSBUUlVFKSB7CQkJDQoJCQkvLyBhZGQgZGF0YSB0byBiYW5rIGFjY291bnQ+Y3INCgkJCSRhY2NvdW50X2lkID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfYmFua2Nhc2hfaW5mb3JtYXRpb24oJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKSk7DQoJCQkkYWNjX2JhbGFuY2UgPSAkYWNjb3VudF9pZFswXS0+YWNjb3VudF9iYWxhbmNlICsgJHRoaXMtPmlucHV0LT5wb3N0KCdhbW91bnQnKTsNCgkJCQ0KCQkJJGRhdGEzID0gYXJyYXkoDQoJCQknYWNjb3VudF9iYWxhbmNlJyA9PiAkYWNjX2JhbGFuY2UNCgkJCSk7DQoJCQkkdGhpcy0+RmluYW5jZV9tb2RlbC0+dXBkYXRlX2JhbmtjYXNoX3JlY29yZCgkZGF0YTMsJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKSk7DQoJCQkkZGF0YSA9IGFycmF5KA0KCQkJCSdzdGF0dXMnID0+IDEsDQoJCQkpOw0KCQkJJHJlc3VsdCA9ICR0aGlzLT5JbnZvaWNlc19tb2RlbC0+dXBkYXRlX2ludm9pY2VfcmVjb3JkKCRkYXRhLCRpbnZvaWNlX2lkKTsNCgkJDQoJCQkkUmV0dXJuWydyZXN1bHQnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3N1Y2Nlc3NfZGVwb3NpdF9hZGRlZCcpOw0KCQl9IGVsc2Ugew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3InKTsNCgkJfQ0KCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KCQlleGl0Ow0KCQ0KCQkNCgkJfQ0KCX0NCgkvLyBWYWxpZGF0ZSBhbmQgYWRkIGluZm8gaW4gZGF0YWJhc2UNCglwdWJsaWMgZnVuY3Rpb24gYWRkX2RpcmVjdF9pbnZvaWNlX3BheW1lbnQoKSB7DQoJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYWRkX3R5cGUnKT09J2ludm9pY2VfcGF5bWVudCcpIHsJCQ0KCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJCQ0KCQkvKiBTZXJ2ZXIgc2lkZSBQSFAgaW5wdXQgdmFsaWRhdGlvbiAqLw0KCQkkZGVzY3JpcHRpb24gPSAkdGhpcy0+aW5wdXQtPnBvc3QoJ2Rlc2NyaXB0aW9uJyk7DQoJCSRxdF9kZXNjcmlwdGlvbiA9IGh0bWxzcGVjaWFsY2hhcnMoYWRkc2xhc2hlcygkZGVzY3JpcHRpb24pLCBFTlRfUVVPVEVTKTsNCgkJDQoJCSRpbnZvaWNlX3RyID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfaW52b2ljZV90cmFuc2FjdGlvbigkdGhpcy0+aW5wdXQtPnBvc3QoJ2ludm9pY2VfaWQnKSk7DQoJCWlmICgkaW52b2ljZV90ci0+bnVtX3Jvd3MoKSA+IDApIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19pbnZfcGFpZF9hbHJlYWR5Jyk7DQoJCX0gDQoJCWlmKCRSZXR1cm5bJ2Vycm9yJ10hPScnKXsNCiAgICAgICAJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQogICAgCX0NCgkJaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKT09PScnKSB7DQogICAgICAgIAkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfYWNjb3VudF9maWVsZCcpOw0KCQl9IGVsc2UgaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdhbW91bnQnKT09PScnKSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9hbW91bnRfZmllbGQnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYWRkX2ludm9pY2VfZGF0ZScpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9kZXBvc2l0X2RhdGUnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgncGF5bWVudF9tZXRob2QnKT09PScnKSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9tYWtlcGF5bWVudF9wYXltZW50X21ldGhvZCcpOw0KCQl9DQoJCQkJDQoJCWlmKCRSZXR1cm5bJ2Vycm9yJ10hPScnKXsNCiAgICAgICAJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQogICAgCX0NCgkJJGludm9pY2VfaWQgPSAkdGhpcy0+aW5wdXQtPnBvc3QoJ2ludm9pY2VfaWQnKTsNCgkJJGRhdGEgPSBhcnJheSgNCgkJJ2FjY291bnRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYmFua19jYXNoX2lkJyksDQoJCSdhbW91bnQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYW1vdW50JyksDQoJCSd0cmFuc2FjdGlvbl90eXBlJyA9PiAnaW5jb21lJywNCgkJJ2ludm9pY2VfdHlwZScgPT4gJ2RpcmVjdCcsDQoJCSdkcl9jcicgPT4gJ2RyJywNCgkJJ3RyYW5zYWN0aW9uX2RhdGUnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYWRkX2ludm9pY2VfZGF0ZScpLA0KCQknYXR0YWNobWVudF9maWxlJyA9PiAnJywNCgkJJ3RyYW5zYWN0aW9uX2NhdF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdjYXRlZ29yeV9pZCcpLA0KCQkncGF5ZXJfcGF5ZWVfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgncGF5ZXJfaWQnKSwNCgkJJ3BheW1lbnRfbWV0aG9kX2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheW1lbnRfbWV0aG9kJyksDQoJCSdkZXNjcmlwdGlvbicgPT4gJHF0X2Rlc2NyaXB0aW9uLA0KCQkncmVmZXJlbmNlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3JlZmVyZW5jZScpLA0KCQknaW52b2ljZV9pZCcgPT4gJGludm9pY2VfaWQsDQoJCSdjcmVhdGVkX2F0JyA9PiBkYXRlKCdZLW0tZCBIOmk6cycpDQoJCSk7DQoJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWRkX3RyYW5zYWN0aW9ucygkZGF0YSk7DQoJCWlmICgkcmVzdWx0ID09IFRSVUUpIHsJCQkNCgkJCS8vIGFkZCBkYXRhIHRvIGJhbmsgYWNjb3VudD5jcg0KCQkJJGFjY291bnRfaWQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9iYW5rY2FzaF9pbmZvcm1hdGlvbigkdGhpcy0+aW5wdXQtPnBvc3QoJ2JhbmtfY2FzaF9pZCcpKTsNCgkJCSRhY2NfYmFsYW5jZSA9ICRhY2NvdW50X2lkWzBdLT5hY2NvdW50X2JhbGFuY2UgKyAkdGhpcy0+aW5wdXQtPnBvc3QoJ2Ftb3VudCcpOw0KCQkJDQoJCQkkZGF0YTMgPSBhcnJheSgNCgkJCSdhY2NvdW50X2JhbGFuY2UnID0+ICRhY2NfYmFsYW5jZQ0KCQkJKTsNCgkJCSR0aGlzLT5GaW5hbmNlX21vZGVsLT51cGRhdGVfYmFua2Nhc2hfcmVjb3JkKCRkYXRhMywkdGhpcy0+aW5wdXQtPnBvc3QoJ2JhbmtfY2FzaF9pZCcpKTsNCgkJCSRkYXRhID0gYXJyYXkoDQoJCQkJJ3N0YXR1cycgPT4gMSwNCgkJCSk7DQoJCQkkcmVzdWx0ID0gJHRoaXMtPkludm9pY2VzX21vZGVsLT51cGRhdGVfZGlyZWN0X2ludm9pY2VfcmVjb3JkKCRkYXRhLCRpbnZvaWNlX2lkKTsNCgkJDQoJCQkkUmV0dXJuWydyZXN1bHQnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3N1Y2Nlc3NfZGVwb3NpdF9hZGRlZCcpOw0KCQl9IGVsc2Ugew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3InKTsNCgkJfQ0KCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KCQlleGl0Ow0KCQ0KCQkNCgkJfQ0KCX0NCgkNCgkvLyBWYWxpZGF0ZSBhbmQgYWRkIGluZm8gaW4gZGF0YWJhc2UNCglwdWJsaWMgZnVuY3Rpb24gYWRkX3RyYW5zZmVyKCkgew0KCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2FkZF90eXBlJyk9PSd0cmFuc2ZlcicpIHsJCQ0KCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJCQ0KCQkvKiBTZXJ2ZXIgc2lkZSBQSFAgaW5wdXQgdmFsaWRhdGlvbiAqLw0KCQkkZGVzY3JpcHRpb24gPSAkdGhpcy0+aW5wdXQtPnBvc3QoJ2Rlc2NyaXB0aW9uJyk7DQoJCSRxdF9kZXNjcmlwdGlvbiA9IGh0bWxzcGVjaWFsY2hhcnMoYWRkc2xhc2hlcygkZGVzY3JpcHRpb24pLCBFTlRfUVVPVEVTKTsNCgkJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnZnJvbV9iYW5rX2Nhc2hfaWQnKT09PScnKSB7DQogICAgICAgIAkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfZnJvbV9hY2NvdW50Jyk7DQoJCX0gZWxzZSBpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ3RvX2JhbmtfY2FzaF9pZCcpPT09JycpIHsNCiAgICAgICAgCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl90b19hY2NvdW50Jyk7DQoJCX0gZWxzZSBpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2Zyb21fYmFua19jYXNoX2lkJyk9PSAkdGhpcy0+aW5wdXQtPnBvc3QoJ3RvX2JhbmtfY2FzaF9pZCcpKSB7DQogICAgICAgIAkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfdHJhbnNlcl90b19zYW1lX2FjY291bnQnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgndHJhbnNmZXJfZGF0ZScpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl90cmFuc2VyX2RhdGUnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYW1vdW50Jyk9PT0nJykgew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3JfYW1vdW50X2ZpZWxkJyk7DQoJCX0gZWxzZSBpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2Ftb3VudCcpID4gJHRoaXMtPmlucHV0LT5wb3N0KCdhY2NvdW50X2JhbGFuY2UnKSkgew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2Vycm9yX2Ftb3VudF9zaG91bGRfYmVfbGVzc190aGFuX2N1cnJlbnQnKTsNCgkJfQ0KCQkJCQkJDQoJCWlmKCRSZXR1cm5bJ2Vycm9yJ10hPScnKXsNCiAgICAgICAJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQogICAgCX0NCgkJDQoJCSRmcm9tX2FjY291bnRfaWQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9iYW5rY2FzaF9pbmZvcm1hdGlvbigkdGhpcy0+aW5wdXQtPnBvc3QoJ2Zyb21fYmFua19jYXNoX2lkJykpOw0KCQkkZnJtX2FjYyA9ICRmcm9tX2FjY291bnRfaWRbMF0tPmFjY291bnRfYmFsYW5jZSAtICR0aGlzLT5pbnB1dC0+cG9zdCgnYW1vdW50Jyk7DQoJCQ0KCQkkdG9fYmFua19jYXNoX2lkID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfYmFua2Nhc2hfaW5mb3JtYXRpb24oJHRoaXMtPmlucHV0LT5wb3N0KCd0b19iYW5rX2Nhc2hfaWQnKSk7DQoJCSR0b19hY2MgPSAkdG9fYmFua19jYXNoX2lkWzBdLT5hY2NvdW50X2JhbGFuY2UgKyAkdGhpcy0+aW5wdXQtPnBvc3QoJ2Ftb3VudCcpOw0KCQkNCgkJJGRhdGEgPSBhcnJheSgNCgkJJ2FjY291bnRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnZnJvbV9iYW5rX2Nhc2hfaWQnKSwNCgkJJ2Ftb3VudCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdhbW91bnQnKSwNCgkJJ3RyYW5zYWN0aW9uX3R5cGUnID0+ICd0cmFuc2ZlcicsDQoJCSdkcl9jcicgPT4gJ2NyJywNCgkJJ3RyYW5zYWN0aW9uX2RhdGUnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgndHJhbnNmZXJfZGF0ZScpLA0KCQknYXR0YWNobWVudF9maWxlJyA9PiAnJywNCgkJJ3RyYW5zYWN0aW9uX2NhdF9pZCcgPT4gMCwNCgkJJ3BheWVyX3BheWVlX2lkJyA9PiAwLA0KCQkncGF5bWVudF9tZXRob2RfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgncGF5bWVudF9tZXRob2QnKSwNCgkJJ2Rlc2NyaXB0aW9uJyA9PiAkcXRfZGVzY3JpcHRpb24sDQoJCSdyZWZlcmVuY2UnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgndHJhbnNmZXJfcmVmZXJlbmNlJyksDQoJCSdpbnZvaWNlX2lkJyA9PiAwLA0KCQknY3JlYXRlZF9hdCcgPT4gZGF0ZSgnWS1tLWQgSDppOnMnKQ0KCQkpOw0KCQkkcmVzdWx0ID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFkZF90cmFuc2FjdGlvbnMoJGRhdGEpOw0KCQkNCgkJJGRhdGEyID0gYXJyYXkoDQoJCSdhY2NvdW50X2JhbGFuY2UnID0+ICRmcm1fYWNjDQoJCSk7DQoJCSRyZXN1bHQyID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnVwZGF0ZV9iYW5rY2FzaF9yZWNvcmQoJGRhdGEyLCR0aGlzLT5pbnB1dC0+cG9zdCgnZnJvbV9iYW5rX2Nhc2hfaWQnKSk7DQoJCQ0KCQkkZGF0YTMgPSBhcnJheSgNCgkJJ2FjY291bnRfYmFsYW5jZScgPT4gJHRvX2FjYw0KCQkpOw0KCQkkcmVzdWx0MyA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT51cGRhdGVfYmFua2Nhc2hfcmVjb3JkKCRkYXRhMywkdGhpcy0+aW5wdXQtPnBvc3QoJ3RvX2JhbmtfY2FzaF9pZCcpKTsNCgkJDQoJCWlmICgkcmVzdWx0ID09IFRSVUUpIHsNCgkJCQ0KCQkJJGRhdGE0ID0gYXJyYXkoDQoJCQkJJ2FjY291bnRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgndG9fYmFua19jYXNoX2lkJyksDQoJCQkJJ2Ftb3VudCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdhbW91bnQnKSwNCgkJCQkndHJhbnNhY3Rpb25fdHlwZScgPT4gJ3RyYW5zZmVyJywNCgkJCQknZHJfY3InID0+ICdkcicsDQoJCQkJJ3RyYW5zYWN0aW9uX2RhdGUnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgndHJhbnNmZXJfZGF0ZScpLA0KCQkJCSdhdHRhY2htZW50X2ZpbGUnID0+ICcnLA0KCQkJCSd0cmFuc2FjdGlvbl9jYXRfaWQnID0+IDAsDQoJCQkJJ3BheWVyX3BheWVlX2lkJyA9PiAwLA0KCQkJCSdwYXltZW50X21ldGhvZF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdwYXltZW50X21ldGhvZCcpLA0KCQkJCSdkZXNjcmlwdGlvbicgPT4gJHF0X2Rlc2NyaXB0aW9uLA0KCQkJCSdyZWZlcmVuY2UnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgndHJhbnNmZXJfcmVmZXJlbmNlJyksDQoJCQkJJ2ludm9pY2VfaWQnID0+IDAsDQoJCQkJJ2NyZWF0ZWRfYXQnID0+IGRhdGUoJ1ktbS1kIEg6aTpzJykNCgkJCSk7DQoJCQkkcmVzdWx0NCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hZGRfdHJhbnNhY3Rpb25zKCRkYXRhNCk7DQoJCQkNCgkJCSRSZXR1cm5bJ3Jlc3VsdCddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2Nfc3VjY2Vzc190cmFuc2Zlcl9hZGRlZCcpOw0KCQl9IGVsc2Ugew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3InKTsNCgkJfQ0KCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KCQlleGl0Ow0KCQ0KCQkNCgkJfQ0KCX0NCgkNCgkvLyBWYWxpZGF0ZSBhbmQgYWRkIGluZm8gaW4gZGF0YWJhc2U+IGFkZCBiYW5rLWNhc2gNCglwdWJsaWMgZnVuY3Rpb24gYWRkX2JhbmtjYXNoKCkgew0KCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2FkZF90eXBlJyk9PSdiYW5rY2FzaCcpIHsJCQ0KCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJDQoJCSRiYW5rX2JyYW5jaCA9ICR0aGlzLT5pbnB1dC0+cG9zdCgnYmFua19icmFuY2gnKTsNCgkJJHF0X2JhbmtfYnJhbmNoID0gaHRtbHNwZWNpYWxjaGFycyhhZGRzbGFzaGVzKCRiYW5rX2JyYW5jaCksIEVOVF9RVU9URVMpOw0KCQkJDQoJCS8qIFNlcnZlciBzaWRlIFBIUCBpbnB1dCB2YWxpZGF0aW9uICovDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYWNjb3VudF9uYW1lJyk9PT0nJykgew0KICAgICAgICAJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2Vycm9yX2FjY291bnRfbmFtZV9maWVsZCcpOw0KCQl9IGVsc2UgaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdhY2NvdW50X2JhbGFuY2UnKT09PScnKSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfYWNjb3VudF9iYWxhbmNlX2ZpZWxkJyk7DQoJCX0gZWxzZSBpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2FjY291bnRfbnVtYmVyJyk9PT0nJykgew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZW1wbG95ZWVfZXJyb3JfYWNjX251bWJlcicpOw0KCQl9DQoJCQkJDQoJCWlmKCRSZXR1cm5bJ2Vycm9yJ10hPScnKXsNCiAgICAgICAJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQogICAgCX0NCgkNCgkJJGRhdGEgPSBhcnJheSgNCgkJJ2FjY291bnRfbmFtZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdhY2NvdW50X25hbWUnKSwNCgkJJ2FjY291bnRfYmFsYW5jZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdhY2NvdW50X2JhbGFuY2UnKSwNCgkJJ2FjY291bnRfb3BlbmluZ19iYWxhbmNlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2FjY291bnRfYmFsYW5jZScpLA0KCQknYWNjb3VudF9udW1iZXInID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYWNjb3VudF9udW1iZXInKSwNCgkJJ2JyYW5jaF9jb2RlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2JyYW5jaF9jb2RlJyksDQoJCSdiYW5rX2JyYW5jaCcgPT4gJHF0X2JhbmtfYnJhbmNoLA0KCQknY3JlYXRlZF9hdCcgPT4gZGF0ZSgnZC1tLVkgaDppOnMnKSwNCgkJDQoJCSk7DQoJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWRkX2JhbmtjYXNoKCRkYXRhKTsNCgkJaWYgKCRyZXN1bHQgPT0gVFJVRSkgew0KCQkJJFJldHVyblsncmVzdWx0J10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19zdWNjZXNzX2JhbmtfY2FzaF9hZGRlZCcpOw0KCQl9IGVsc2Ugew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3JfbXNnJyk7DQoJCX0NCgkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCgkJZXhpdDsNCgkJfQ0KCX0gDQoJDQoJLy8gVmFsaWRhdGUgYW5kIGFkZCBpbmZvIGluIGRhdGFiYXNlPiBhZGQgYmFuay1jYXNoDQoJcHVibGljIGZ1bmN0aW9uIGJhbmtjYXNoX3VwZGF0ZSgpIHsNCgkNCgkJaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdlZGl0X3R5cGUnKT09J2JhbmtjYXNoJykgewkJDQoJCS8qIERlZmluZSByZXR1cm4gfCBoZXJlIHJlc3VsdCBpcyB1c2VkIHRvIHJldHVybiB1c2VyIGRhdGEgYW5kIGVycm9yIGZvciBlcnJvciBtZXNzYWdlICovDQoJCSRSZXR1cm4gPSBhcnJheSgncmVzdWx0Jz0+JycsICdlcnJvcic9PicnLCAnY3NyZl9oYXNoJz0+JycpOw0KCQkkaWQgPSAkdGhpcy0+dXJpLT5zZWdtZW50KDQpOw0KCQkkUmV0dXJuWydjc3JmX2hhc2gnXSA9ICR0aGlzLT5zZWN1cml0eS0+Z2V0X2NzcmZfaGFzaCgpOw0KCQkNCgkJJGJhbmtfYnJhbmNoID0gJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2JyYW5jaCcpOw0KCQkkcXRfYmFua19icmFuY2ggPSBodG1sc3BlY2lhbGNoYXJzKGFkZHNsYXNoZXMoJGJhbmtfYnJhbmNoKSwgRU5UX1FVT1RFUyk7DQoJCQkNCgkJLyogU2VydmVyIHNpZGUgUEhQIGlucHV0IHZhbGlkYXRpb24gKi8NCgkJaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdhY2NvdW50X25hbWUnKT09PScnKSB7DQogICAgICAgIAkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfYWNjb3VudF9uYW1lX2ZpZWxkJyk7DQoJCX0gZWxzZSBpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2FjY291bnRfYmFsYW5jZScpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9hY2NvdW50X2JhbGFuY2VfZmllbGQnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYWNjb3VudF9udW1iZXInKT09PScnKSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lbXBsb3llZV9lcnJvcl9hY2NfbnVtYmVyJyk7DQoJCX0gDQoJCQkJDQoJCWlmKCRSZXR1cm5bJ2Vycm9yJ10hPScnKXsNCiAgICAgICAJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQogICAgCX0NCgkNCgkJJGRhdGEgPSBhcnJheSgNCgkJJ2FjY291bnRfbmFtZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdhY2NvdW50X25hbWUnKSwNCgkJJ2FjY291bnRfYmFsYW5jZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdhY2NvdW50X2JhbGFuY2UnKSwNCgkJJ2FjY291bnRfbnVtYmVyJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2FjY291bnRfbnVtYmVyJyksDQoJCSdicmFuY2hfY29kZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdicmFuY2hfY29kZScpLA0KCQknYmFua19icmFuY2gnID0+ICRxdF9iYW5rX2JyYW5jaCwNCgkJKTsNCgkJJHJlc3VsdCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT51cGRhdGVfYmFua2Nhc2hfcmVjb3JkKCRkYXRhLCRpZCk7DQoJCWlmICgkcmVzdWx0ID09IFRSVUUpIHsNCgkJCSRSZXR1cm5bJ3Jlc3VsdCddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2Nfc3VjY2Vzc19iYW5rX2Nhc2hfdXBkYXRlZCcpOw0KCQl9IGVsc2Ugew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3JfbXNnJyk7DQoJCX0NCgkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCgkJZXhpdDsNCgkJfQ0KCX0gDQoJCSANCgkgLy8gZGVsZXRlIHJlY29yZA0KCXB1YmxpYyBmdW5jdGlvbiBkZWxldGUoKSB7DQoJCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2lzX2FqYXgnKT09JzInKSB7DQoJCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkJJFJldHVybiA9IGFycmF5KCdyZXN1bHQnPT4nJywgJ2Vycm9yJz0+JycsICdjc3JmX2hhc2gnPT4nJyk7DQoJCQkkaWQgPSAkdGhpcy0+dXJpLT5zZWdtZW50KDQpOw0KCQkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+ZGVsZXRlX2JhbmtjYXNoX3JlY29yZCgkaWQpOw0KCQkJaWYoaXNzZXQoJGlkKSkgew0KCQkJCSRSZXR1cm5bJ3Jlc3VsdCddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2Nfc3VjY2Vzc19iYW5rX2Nhc2hfZGVsZXRlZCcpOw0KCQkJfSBlbHNlIHsNCgkJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9tc2cnKTsNCgkJCX0NCgkJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQoJCX0NCgl9DQoJDQoJLy8gZGVsZXRlIHJlY29yZA0KCXB1YmxpYyBmdW5jdGlvbiBkZWxldGVfZGVwb3NpdF90cmFuc2FjdGlvbigpIHsNCgkJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnaXNfYWpheCcpPT0nMicpIHsNCgkJCS8qIERlZmluZSByZXR1cm4gfCBoZXJlIHJlc3VsdCBpcyB1c2VkIHRvIHJldHVybiB1c2VyIGRhdGEgYW5kIGVycm9yIGZvciBlcnJvciBtZXNzYWdlICovDQoJCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJCSRpZCA9ICR0aGlzLT51cmktPnNlZ21lbnQoNCk7DQoJCQkkUmV0dXJuWydjc3JmX2hhc2gnXSA9ICR0aGlzLT5zZWN1cml0eS0+Z2V0X2NzcmZfaGFzaCgpOw0KCQkJJHJlc3VsdCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5kZWxldGVfdHJhbnNhY3Rpb25fcmVjb3JkKCRpZCk7DQoJCQlpZihpc3NldCgkaWQpKSB7DQoJCQkJJFJldHVyblsncmVzdWx0J10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19zdWNjZXNzX2RlcG9zaXRfZGVsZXRlZCcpOw0KCQkJfSBlbHNlIHsNCgkJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9tc2cnKTsNCgkJCX0NCgkJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQoJCX0NCgl9DQoJDQoJLy8gZGVsZXRlIHJlY29yZA0KCXB1YmxpYyBmdW5jdGlvbiBkZWxldGVfZXhwZW5zZSgpIHsNCgkJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnaXNfYWpheCcpPT0nMicpIHsNCgkJCS8qIERlZmluZSByZXR1cm4gfCBoZXJlIHJlc3VsdCBpcyB1c2VkIHRvIHJldHVybiB1c2VyIGRhdGEgYW5kIGVycm9yIGZvciBlcnJvciBtZXNzYWdlICovDQoJCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJCSRpZCA9ICR0aGlzLT51cmktPnNlZ21lbnQoNCk7DQoJCQkkUmV0dXJuWydjc3JmX2hhc2gnXSA9ICR0aGlzLT5zZWN1cml0eS0+Z2V0X2NzcmZfaGFzaCgpOw0KCQkJJHJlc3VsdCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5kZWxldGVfdHJhbnNhY3Rpb25fcmVjb3JkKCRpZCk7DQoJCQlpZihpc3NldCgkaWQpKSB7DQoJCQkJJFJldHVyblsncmVzdWx0J10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19zdWNjZXNzX2V4cGVuc2VfZGVsZXRlZCcpOw0KCQkJfSBlbHNlIHsNCgkJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9tc2cnKTsNCgkJCX0NCgkJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQoJCX0NCgl9DQoJDQoJLy8gZGVsZXRlIHJlY29yZA0KCXB1YmxpYyBmdW5jdGlvbiBkZWxldGVfdHJhbnNhY3Rpb24oKSB7DQoJCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2lzX2FqYXgnKT09JzInKSB7DQoJCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkJJFJldHVybiA9IGFycmF5KCdyZXN1bHQnPT4nJywgJ2Vycm9yJz0+JycsICdjc3JmX2hhc2gnPT4nJyk7DQoJCQkkaWQgPSAkdGhpcy0+dXJpLT5zZWdtZW50KDQpOw0KCQkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+ZGVsZXRlX3RyYW5zYWN0aW9uX3JlY29yZCgkaWQpOw0KCQkJaWYoaXNzZXQoJGlkKSkgew0KCQkJCSRSZXR1cm5bJ3Jlc3VsdCddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfdHJhbnNhY3Rpb25fZGVsZXRlZCcpOw0KCQkJfSBlbHNlIHsNCgkJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9tc2cnKTsNCgkJCX0NCgkJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQoJCX0NCgl9DQoJDQoJcHVibGljIGZ1bmN0aW9uIHJlYWRfaW52b2ljZSgpDQoJew0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoZW1wdHkoJHNlc3Npb24pKXsgDQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCSRpbnZvaWNlX2lkID0gJHRoaXMtPmlucHV0LT5nZXQoJ2ludm9pY2VfaWQnKTsNCgkJJGludm9pY2VfdHlwZSA9ICR0aGlzLT5pbnB1dC0+Z2V0KCdkYXRhJyk7DQoJCWlmKCRpbnZvaWNlX3R5cGUgPT0gJ2N1c3RvbWVyJyl7DQoJCQkkcmVzdWx0ID0gJHRoaXMtPkludm9pY2VzX21vZGVsLT5yZWFkX2ludm9pY2VfaW5mbygkaW52b2ljZV9pZCk7DQoJCX0gZWxzZSB7DQoJCQkkcmVzdWx0ID0gJHRoaXMtPkludm9pY2VzX21vZGVsLT5yZWFkX2RpcmVjdF9pbnZvaWNlX2luZm8oJGludm9pY2VfaWQpOw0KCQl9DQoJCSRkYXRhID0gYXJyYXkoDQoJCQkJJ2ludm9pY2VfaWQnID0+ICRyZXN1bHRbMF0tPmludm9pY2VfaWQsDQoJCQkJJ2ludm9pY2VfbnVtYmVyJyA9PiAkcmVzdWx0WzBdLT5pbnZvaWNlX251bWJlciwNCgkJCQknZ3JhbmRfdG90YWwnID0+ICRyZXN1bHRbMF0tPmdyYW5kX3RvdGFsLA0KCQkJCSdhbGxfcGF5ZXJzJyA9PiAkdGhpcy0+Q3VzdG9tZXJzX21vZGVsLT5nZXRfYWxsX2N1c3RvbWVycygpLA0KCQkJCSdhbGxfYmFua19jYXNoJyA9PiAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWxsX2JhbmtfY2FzaCgpLA0KCQkJCSdhbGxfaW5jb21lX2NhdGVnb3JpZXNfbGlzdCcgPT4gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFsbF9pbmNvbWVfY2F0ZWdvcmllc19saXN0KCksDQoJCQkJJ2dldF9hbGxfcGF5bWVudF9tZXRob2QnID0+ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5nZXRfYWxsX3BheW1lbnRfbWV0aG9kKCkNCgkJCQkpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygnYWRtaW4vYWNjb3VudGluZy9kaWFsb2dfYWNjb3VudGluZycsICRkYXRhKTsNCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCX0NCgkNCglwdWJsaWMgZnVuY3Rpb24gcmVhZF9kZXBvc2l0KCkNCgl7DQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpeyANCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJJGlkID0gJHRoaXMtPmlucHV0LT5nZXQoJ2RlcG9zaXRfaWQnKTsNCgkJJHJlc3VsdCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5yZWFkX3RyYW5zYWN0aW9uX2luZm9ybWF0aW9uKCRpZCk7DQoJCSRkYXRhID0gYXJyYXkoDQoJCQkJJ2RlcG9zaXRfaWQnID0+ICRyZXN1bHRbMF0tPnRyYW5zYWN0aW9uX2lkLA0KCQkJCSdhY2NvdW50X3R5cGVfaWQnID0+ICRyZXN1bHRbMF0tPmFjY291bnRfaWQsDQoJCQkJJ2Ftb3VudCcgPT4gJHJlc3VsdFswXS0+YW1vdW50LA0KCQkJCSdkZXBvc2l0X2RhdGUnID0+ICRyZXN1bHRbMF0tPnRyYW5zYWN0aW9uX2RhdGUsDQoJCQkJJ2NhdGVnb3J5aWQnID0+ICRyZXN1bHRbMF0tPnRyYW5zYWN0aW9uX2NhdF9pZCwNCgkJCQkncGF5ZXJfaWQnID0+ICRyZXN1bHRbMF0tPnBheWVyX3BheWVlX2lkLA0KCQkJCSdwYXltZW50X21ldGhvZF9pZCcgPT4gJHJlc3VsdFswXS0+cGF5bWVudF9tZXRob2RfaWQsDQoJCQkJJ2RlcG9zaXRfcmVmZXJlbmNlJyA9PiAkcmVzdWx0WzBdLT5yZWZlcmVuY2UsDQoJCQkJJ2RlcG9zaXRfZmlsZScgPT4gJHJlc3VsdFswXS0+YXR0YWNobWVudF9maWxlLA0KCQkJCSdkZXNjcmlwdGlvbicgPT4gJHJlc3VsdFswXS0+ZGVzY3JpcHRpb24sDQoJCQkJJ2NyZWF0ZWRfYXQnID0+ICRyZXN1bHRbMF0tPmNyZWF0ZWRfYXQsDQoJCQkJJ2FsbF9wYXllcnMnID0+ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hbGxfcGF5ZXJzKCksDQoJCQkJJ2FsbF9iYW5rX2Nhc2gnID0+ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hbGxfYmFua19jYXNoKCksDQoJCQkJJ2FsbF9pbmNvbWVfY2F0ZWdvcmllc19saXN0JyA9PiAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWxsX2luY29tZV9jYXRlZ29yaWVzX2xpc3QoKSwNCgkJCQknZ2V0X2FsbF9wYXltZW50X21ldGhvZCcgPT4gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmdldF9hbGxfcGF5bWVudF9tZXRob2QoKQ0KCQkJCSk7DQoJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCSR0aGlzLT5sb2FkLT52aWV3KCdhZG1pbi9hY2NvdW50aW5nL2RpYWxvZ19hY2NvdW50aW5nJywgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJfQ0KCQ0KCS8vIFZhbGlkYXRlIGFuZCB1cGRhdGUgaW5mbyBpbiBkYXRhYmFzZQ0KCXB1YmxpYyBmdW5jdGlvbiBkZXBvc2l0X3VwZGF0ZSgpIHsNCgkNCgkJaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdlZGl0X3R5cGUnKT09J2RlcG9zaXQnKSB7DQoJCQkNCgkJJGlkID0gJHRoaXMtPnVyaS0+c2VnbWVudCg0KTsNCgkJDQoJCS8qIERlZmluZSByZXR1cm4gfCBoZXJlIHJlc3VsdCBpcyB1c2VkIHRvIHJldHVybiB1c2VyIGRhdGEgYW5kIGVycm9yIGZvciBlcnJvciBtZXNzYWdlICovDQoJCSRSZXR1cm4gPSBhcnJheSgncmVzdWx0Jz0+JycsICdlcnJvcic9PicnLCAnY3NyZl9oYXNoJz0+JycpOw0KCQkkUmV0dXJuWydjc3JmX2hhc2gnXSA9ICR0aGlzLT5zZWN1cml0eS0+Z2V0X2NzcmZfaGFzaCgpOw0KCQkJDQoJCS8qIFNlcnZlciBzaWRlIFBIUCBpbnB1dCB2YWxpZGF0aW9uICovDQoJCSRkZXNjcmlwdGlvbiA9ICR0aGlzLT5pbnB1dC0+cG9zdCgnZGVzY3JpcHRpb24nKTsNCgkJJHF0X2Rlc2NyaXB0aW9uID0gaHRtbHNwZWNpYWxjaGFycyhhZGRzbGFzaGVzKCRkZXNjcmlwdGlvbiksIEVOVF9RVU9URVMpOw0KCQkNCgkJaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKT09PScnKSB7DQogICAgICAgICRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9hY2NvdW50X2ZpZWxkJyk7DQoJCX0gZWxzZSBpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2Ftb3VudCcpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yX2Ftb3VudF9maWVsZCcpOw0KCQl9IGVsc2UgaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdkZXBvc2l0X2RhdGUnKT09PScnKSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfZGVwb3NpdF9kYXRlJyk7DQoJCX0JCQ0KCQkvKiBDaGVjayBpZiBmaWxlIHVwbG9hZGVkLi4qLw0KCQllbHNlIGlmKCRfRklMRVNbJ2RlcG9zaXRfZmlsZSddWydzaXplJ10gPT0gMCkgew0KCQkJICRmbmFtZSA9ICdub19maWxlJzsNCgkJCSAkZGF0YSA9IGFycmF5KA0KCQkJJ2FjY291bnRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYmFua19jYXNoX2lkJyksDQoJCQknYW1vdW50JyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2Ftb3VudCcpLA0KCQkJJ3RyYW5zYWN0aW9uX2RhdGUnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnZGVwb3NpdF9kYXRlJyksDQoJCQkndHJhbnNhY3Rpb25fY2F0X2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2NhdGVnb3J5X2lkJyksDQoJCQkncGF5ZXJfcGF5ZWVfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgncGF5ZXJfaWQnKSwNCgkJCSdwYXltZW50X21ldGhvZF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdwYXltZW50X21ldGhvZCcpLA0KCQkJJ2Rlc2NyaXB0aW9uJyA9PiAkcXRfZGVzY3JpcHRpb24sDQoJCQkncmVmZXJlbmNlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2RlcG9zaXRfcmVmZXJlbmNlJyksCQkNCgkJCSk7DQoJCQkgJHJlc3VsdCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT51cGRhdGVfdHJhbnNhY3Rpb25fcmVjb3JkKCRkYXRhLCRpZCk7DQoJCX0gZWxzZSB7DQoJCQlpZihpc191cGxvYWRlZF9maWxlKCRfRklMRVNbJ2RlcG9zaXRfZmlsZSddWyd0bXBfbmFtZSddKSkgew0KCQkJCS8vY2hlY2tpbmcgaW1hZ2UgdHlwZQ0KCQkJCSRhbGxvd2VkID0gIGFycmF5KCdwbmcnLCdqcGcnLCdqcGVnJywnZ2lmJyk7DQoJCQkJJGZpbGVuYW1lID0gJF9GSUxFU1snZGVwb3NpdF9maWxlJ11bJ25hbWUnXTsNCgkJCQkkZXh0ID0gcGF0aGluZm8oJGZpbGVuYW1lLCBQQVRISU5GT19FWFRFTlNJT04pOw0KCQkJCQ0KCQkJCWlmKGluX2FycmF5KCRleHQsJGFsbG93ZWQpKXsNCgkJCQkJJHRtcF9uYW1lID0gJF9GSUxFU1siZGVwb3NpdF9maWxlIl1bInRtcF9uYW1lIl07DQoJCQkJCSRiaWxsX2NvcHkgPSAidXBsb2Fkcy9hY2NvdW50aW5nL2RlcG9zaXQvIjsNCgkJCQkJLy8gYmFzZW5hbWUoKSBtYXkgcHJldmVudCBmaWxlc3lzdGVtIHRyYXZlcnNhbCBhdHRhY2tzOw0KCQkJCQkvLyBmdXJ0aGVyIHZhbGlkYXRpb24vc2FuaXRhdGlvbiBvZiB0aGUgZmlsZW5hbWUgbWF5IGJlIGFwcHJvcHJpYXRlDQoJCQkJCSRsbmFtZSA9IGJhc2VuYW1lKCRfRklMRVNbImRlcG9zaXRfZmlsZSJdWyJuYW1lIl0pOw0KCQkJCQkkbmV3ZmlsZW5hbWUgPSAnZGVwb3NpdF8nLnJvdW5kKG1pY3JvdGltZSh0cnVlKSkuJy4nLiRleHQ7DQoJCQkJCW1vdmVfdXBsb2FkZWRfZmlsZSgkdG1wX25hbWUsICRiaWxsX2NvcHkuJG5ld2ZpbGVuYW1lKTsNCgkJCQkJJGZuYW1lID0gJG5ld2ZpbGVuYW1lOw0KCQkJCQkgJGRhdGEgPSBhcnJheSgNCgkJCQkJJ2FjY291bnRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYmFua19jYXNoX2lkJyksDQoJCQkJCSdhbW91bnQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYW1vdW50JyksDQoJCQkJCSd0cmFuc2FjdGlvbl9kYXRlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2RlcG9zaXRfZGF0ZScpLA0KCQkJCQknYXR0YWNobWVudF9maWxlJyA9PiAkZm5hbWUsDQoJCQkJCSd0cmFuc2FjdGlvbl9jYXRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnY2F0ZWdvcnlfaWQnKSwNCgkJCQkJJ3BheWVyX3BheWVlX2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheWVyX2lkJyksDQoJCQkJCSdwYXltZW50X21ldGhvZF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdwYXltZW50X21ldGhvZCcpLA0KCQkJCQknZGVzY3JpcHRpb24nID0+ICRxdF9kZXNjcmlwdGlvbiwNCgkJCQkJJ3JlZmVyZW5jZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdkZXBvc2l0X3JlZmVyZW5jZScpLAkNCgkJCQkJKTsNCgkJCQkJLy8gdXBkYXRlIHJlY29yZCA+IG1vZGVsDQoJCQkJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+dXBkYXRlX3RyYW5zYWN0aW9uX3JlY29yZCgkZGF0YSwkaWQpOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yX2F0dGF0Y2htZW50X3R5cGUnKTsNCgkJCQl9DQoJCQl9DQoJCX0NCgkJDQoJCWlmKCRSZXR1cm5bJ2Vycm9yJ10hPScnKXsNCiAgICAgICAJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQogICAgCX0NCgkNCgkJDQoJCWlmICgkcmVzdWx0ID09IFRSVUUpIHsNCgkJCSRSZXR1cm5bJ3Jlc3VsdCddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2Nfc3VjY2Vzc19kZXBvc2l0X3VwZGF0ZWQnKTsNCgkJfSBlbHNlIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yJyk7DQoJCX0NCgkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCgkJZXhpdDsNCgkJfQ0KCX0NCgkNCgkvLyBWYWxpZGF0ZSBhbmQgdXBkYXRlIGluZm8gaW4gZGF0YWJhc2UNCglwdWJsaWMgZnVuY3Rpb24gdHJhbnNhY3Rpb25fdXBkYXRlKCkgew0KCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2VkaXRfdHlwZScpPT0nZGVwb3NpdCcpIHsNCgkJCQ0KCQkkaWQgPSAkdGhpcy0+dXJpLT5zZWdtZW50KDQpOw0KCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJCQ0KCQkvKiBTZXJ2ZXIgc2lkZSBQSFAgaW5wdXQgdmFsaWRhdGlvbiAqLw0KCQkkZGVzY3JpcHRpb24gPSAkdGhpcy0+aW5wdXQtPnBvc3QoJ2Rlc2NyaXB0aW9uJyk7DQoJCSRxdF9kZXNjcmlwdGlvbiA9IGh0bWxzcGVjaWFsY2hhcnMoYWRkc2xhc2hlcygkZGVzY3JpcHRpb24pLCBFTlRfUVVPVEVTKTsNCgkJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnZGVwb3NpdF9kYXRlJyk9PT0nJykgew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2Vycm9yX2RlcG9zaXRfZGF0ZScpOw0KCQl9CQkNCgkJLyogQ2hlY2sgaWYgZmlsZSB1cGxvYWRlZC4uKi8NCgkJZWxzZSBpZigkX0ZJTEVTWydkZXBvc2l0X2ZpbGUnXVsnc2l6ZSddID09IDApIHsNCgkJCSAkZm5hbWUgPSAnbm9fZmlsZSc7DQoJCQkgJGRhdGEgPSBhcnJheSgNCgkJCSd0cmFuc2FjdGlvbl9kYXRlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2RlcG9zaXRfZGF0ZScpLA0KCQkJJ3RyYW5zYWN0aW9uX2NhdF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdjYXRlZ29yeV9pZCcpLA0KCQkJJ3BheWVyX3BheWVlX2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheWVyX2lkJyksDQoJCQkncGF5bWVudF9tZXRob2RfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgncGF5bWVudF9tZXRob2QnKSwNCgkJCSdkZXNjcmlwdGlvbicgPT4gJHF0X2Rlc2NyaXB0aW9uLA0KCQkJJ3JlZmVyZW5jZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdkZXBvc2l0X3JlZmVyZW5jZScpLAkJDQoJCQkpOw0KCQkJICRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+dXBkYXRlX3RyYW5zYWN0aW9uX3JlY29yZCgkZGF0YSwkaWQpOw0KCQl9IGVsc2Ugew0KCQkJaWYoaXNfdXBsb2FkZWRfZmlsZSgkX0ZJTEVTWydkZXBvc2l0X2ZpbGUnXVsndG1wX25hbWUnXSkpIHsNCgkJCQkvL2NoZWNraW5nIGltYWdlIHR5cGUNCgkJCQkkYWxsb3dlZCA9ICBhcnJheSgncG5nJywnanBnJywnanBlZycsJ2dpZicpOw0KCQkJCSRmaWxlbmFtZSA9ICRfRklMRVNbJ2RlcG9zaXRfZmlsZSddWyduYW1lJ107DQoJCQkJJGV4dCA9IHBhdGhpbmZvKCRmaWxlbmFtZSwgUEFUSElORk9fRVhURU5TSU9OKTsNCgkJCQkNCgkJCQlpZihpbl9hcnJheSgkZXh0LCRhbGxvd2VkKSl7DQoJCQkJCSR0bXBfbmFtZSA9ICRfRklMRVNbImRlcG9zaXRfZmlsZSJdWyJ0bXBfbmFtZSJdOw0KCQkJCQkkYmlsbF9jb3B5ID0gInVwbG9hZHMvYWNjb3VudGluZy9kZXBvc2l0LyI7DQoJCQkJCS8vIGJhc2VuYW1lKCkgbWF5IHByZXZlbnQgZmlsZXN5c3RlbSB0cmF2ZXJzYWwgYXR0YWNrczsNCgkJCQkJLy8gZnVydGhlciB2YWxpZGF0aW9uL3Nhbml0YXRpb24gb2YgdGhlIGZpbGVuYW1lIG1heSBiZSBhcHByb3ByaWF0ZQ0KCQkJCQkkbG5hbWUgPSBiYXNlbmFtZSgkX0ZJTEVTWyJkZXBvc2l0X2ZpbGUiXVsibmFtZSJdKTsNCgkJCQkJJG5ld2ZpbGVuYW1lID0gJ2RlcG9zaXRfJy5yb3VuZChtaWNyb3RpbWUodHJ1ZSkpLicuJy4kZXh0Ow0KCQkJCQltb3ZlX3VwbG9hZGVkX2ZpbGUoJHRtcF9uYW1lLCAkYmlsbF9jb3B5LiRuZXdmaWxlbmFtZSk7DQoJCQkJCSRmbmFtZSA9ICRuZXdmaWxlbmFtZTsNCgkJCQkJICRkYXRhID0gYXJyYXkoDQoJCQkJCSd0cmFuc2FjdGlvbl9kYXRlJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2RlcG9zaXRfZGF0ZScpLA0KCQkJCQknYXR0YWNobWVudF9maWxlJyA9PiAkZm5hbWUsDQoJCQkJCSd0cmFuc2FjdGlvbl9jYXRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnY2F0ZWdvcnlfaWQnKSwNCgkJCQkJJ3BheWVyX3BheWVlX2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheWVyX2lkJyksDQoJCQkJCSdwYXltZW50X21ldGhvZF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdwYXltZW50X21ldGhvZCcpLA0KCQkJCQknZGVzY3JpcHRpb24nID0+ICRxdF9kZXNjcmlwdGlvbiwNCgkJCQkJJ3JlZmVyZW5jZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdkZXBvc2l0X3JlZmVyZW5jZScpLAkNCgkJCQkJKTsNCgkJCQkJLy8gdXBkYXRlIHJlY29yZCA+IG1vZGVsDQoJCQkJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+dXBkYXRlX3RyYW5zYWN0aW9uX3JlY29yZCgkZGF0YSwkaWQpOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yX2F0dGF0Y2htZW50X3R5cGUnKTsNCgkJCQl9DQoJCQl9DQoJCX0NCgkJDQoJCWlmKCRSZXR1cm5bJ2Vycm9yJ10hPScnKXsNCiAgICAgICAJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQogICAgCX0NCgkNCgkJDQoJCWlmICgkcmVzdWx0ID09IFRSVUUpIHsNCgkJCSRSZXR1cm5bJ3Jlc3VsdCddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9pbnZfdHJhbnNhY3Rpb25fZWRpdGVkX3N1Y2Nlc3NmdWxseScpOw0KCQl9IGVsc2Ugew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3InKTsNCgkJfQ0KCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KCQlleGl0Ow0KCQl9DQoJfQ0KCQ0KCXB1YmxpYyBmdW5jdGlvbiByZWFkX2V4cGVuc2UoKQ0KCXsNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkaWQgPSAkdGhpcy0+aW5wdXQtPmdldCgnZXhwZW5zZV9pZCcpOw0KCQkkcmVzdWx0ID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfdHJhbnNhY3Rpb25faW5mb3JtYXRpb24oJGlkKTsNCgkJJGRhdGEgPSBhcnJheSgNCgkJCQknZXhwZW5zZV9pZCcgPT4gJHJlc3VsdFswXS0+dHJhbnNhY3Rpb25faWQsDQoJCQkJJ2FjY291bnRfdHlwZV9pZCcgPT4gJHJlc3VsdFswXS0+YWNjb3VudF9pZCwNCgkJCQknYW1vdW50JyA9PiAkcmVzdWx0WzBdLT5hbW91bnQsDQoJCQkJJ2V4cGVuc2VfZGF0ZScgPT4gJHJlc3VsdFswXS0+dHJhbnNhY3Rpb25fZGF0ZSwNCgkJCQknY2F0ZWdvcnlpZCcgPT4gJHJlc3VsdFswXS0+dHJhbnNhY3Rpb25fY2F0X2lkLA0KCQkJCSdwYXllZV9pZCcgPT4gJHJlc3VsdFswXS0+cGF5ZXJfcGF5ZWVfaWQsDQoJCQkJJ2NvbXBhbnlfaWQnID0+ICRyZXN1bHRbMF0tPmNvbXBhbnlfaWQsDQoJCQkJJ3BheW1lbnRfbWV0aG9kX2lkJyA9PiAkcmVzdWx0WzBdLT5wYXltZW50X21ldGhvZF9pZCwNCgkJCQknZXhwZW5zZV9yZWZlcmVuY2UnID0+ICRyZXN1bHRbMF0tPnJlZmVyZW5jZSwNCgkJCQknZXhwZW5zZV9maWxlJyA9PiAkcmVzdWx0WzBdLT5hdHRhY2htZW50X2ZpbGUsDQoJCQkJJ2Rlc2NyaXB0aW9uJyA9PiAkcmVzdWx0WzBdLT5kZXNjcmlwdGlvbiwNCgkJCQknY3JlYXRlZF9hdCcgPT4gJHJlc3VsdFswXS0+Y3JlYXRlZF9hdCwNCgkJCQknYWxsX3BheWVlcycgPT4gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFsbF9wYXllZXMoKSwNCgkJCQknYWxsX2JhbmtfY2FzaCcgPT4gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFsbF9iYW5rX2Nhc2goKSwNCgkJCQknYWxsX2V4cGVuc2VfdHlwZXMnID0+ICR0aGlzLT5FeHBlbnNlX21vZGVsLT5hbGxfZXhwZW5zZV90eXBlcygpLA0KCQkJCSdhbGxfaW5jb21lX2NhdGVnb3JpZXNfbGlzdCcgPT4gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFsbF9pbmNvbWVfY2F0ZWdvcmllc19saXN0KCksDQoJCQkJJ2dldF9hbGxfcGF5bWVudF9tZXRob2QnID0+ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5nZXRfYWxsX3BheW1lbnRfbWV0aG9kKCksDQoJCQkJJ2FsbF9lbXBsb3llZXMnID0+ICR0aGlzLT5YaW5fbW9kZWwtPmFsbF9lbXBsb3llZXMoKSwNCgkJCQknYWxsX2NvbXBhbmllcycgPT4gJHRoaXMtPlhpbl9tb2RlbC0+Z2V0X2NvbXBhbmllcygpDQoJCQkJKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJJHRoaXMtPmxvYWQtPnZpZXcoJ2FkbWluL2FjY291bnRpbmcvZGlhbG9nX2FjY291bnRpbmcnLCAkZGF0YSk7DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgl9DQoJDQoJLy8gVmFsaWRhdGUgYW5kIHVwZGF0ZSBpbmZvIGluIGRhdGFiYXNlDQoJcHVibGljIGZ1bmN0aW9uIGV4cGVuc2VfdXBkYXRlKCkgew0KCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2VkaXRfdHlwZScpPT0nZXhwZW5zZScpIHsNCgkJCQ0KCQkkaWQgPSAkdGhpcy0+dXJpLT5zZWdtZW50KDQpOw0KCQkNCgkJLyogRGVmaW5lIHJldHVybiB8IGhlcmUgcmVzdWx0IGlzIHVzZWQgdG8gcmV0dXJuIHVzZXIgZGF0YSBhbmQgZXJyb3IgZm9yIGVycm9yIG1lc3NhZ2UgKi8NCgkJJFJldHVybiA9IGFycmF5KCdyZXN1bHQnPT4nJywgJ2Vycm9yJz0+JycsICdjc3JmX2hhc2gnPT4nJyk7DQoJCSRSZXR1cm5bJ2NzcmZfaGFzaCddID0gJHRoaXMtPnNlY3VyaXR5LT5nZXRfY3NyZl9oYXNoKCk7DQoJCQkNCgkJLyogU2VydmVyIHNpZGUgUEhQIGlucHV0IHZhbGlkYXRpb24gKi8NCgkJJGRlc2NyaXB0aW9uID0gJHRoaXMtPmlucHV0LT5wb3N0KCdkZXNjcmlwdGlvbicpOw0KCQkkcXRfZGVzY3JpcHRpb24gPSBodG1sc3BlY2lhbGNoYXJzKGFkZHNsYXNoZXMoJGRlc2NyaXB0aW9uKSwgRU5UX1FVT1RFUyk7DQoJCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2JhbmtfY2FzaF9pZCcpPT09JycpIHsNCiAgICAgICAgJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2Vycm9yX2FjY291bnRfZmllbGQnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYW1vdW50Jyk9PT0nJykgew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3JfYW1vdW50X2ZpZWxkJyk7DQoJCX0gLyplbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYW1vdW50JykgPiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2FjY291bnRfYmFsYW5jZScpKSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfYW1vdW50X3Nob3VsZF9iZV9sZXNzX3RoYW5fY3VycmVudCcpOw0KCQl9Ki8gZWxzZSBpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2V4cGVuc2VfZGF0ZScpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9leHBlbnNlX2RhdGUnKTsNCgkJfSBlbHNlIGlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnY29tcGFueScpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgnZXJyb3JfY29tcGFueV9maWVsZCcpOw0KCQl9IGVsc2UgaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdlbXBsb3llZV9pZCcpPT09JycpIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yX2VtcGxveWVlX2lkJyk7DQoJCX0JDQoJCS8qIENoZWNrIGlmIGZpbGUgdXBsb2FkZWQuLiovDQoJCWVsc2UgaWYoJF9GSUxFU1snZXhwZW5zZV9maWxlJ11bJ3NpemUnXSA9PSAwKSB7DQoJCQkgJGZuYW1lID0gJ25vX2ZpbGUnOw0KCQkJICRkYXRhID0gYXJyYXkoDQoJCQknYWNjb3VudF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKSwNCgkJCSdhbW91bnQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnYW1vdW50JyksDQoJCQkndHJhbnNhY3Rpb25fZGF0ZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdleHBlbnNlX2RhdGUnKSwNCgkJCSd0cmFuc2FjdGlvbl9jYXRfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnY2F0ZWdvcnlfaWQnKSwNCgkJCSdwYXllcl9wYXllZV9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdwYXllZV9pZCcpLA0KCQkJJ2NvbXBhbnlfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnY29tcGFueScpLA0KCQkJJ3BheW1lbnRfbWV0aG9kX2lkJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheW1lbnRfbWV0aG9kJyksDQoJCQknZGVzY3JpcHRpb24nID0+ICRxdF9kZXNjcmlwdGlvbiwNCgkJCSdyZWZlcmVuY2UnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnZXhwZW5zZV9yZWZlcmVuY2UnKSwJCQ0KCQkJKTsNCgkJCSAkcmVzdWx0ID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnVwZGF0ZV90cmFuc2FjdGlvbl9yZWNvcmQoJGRhdGEsJGlkKTsNCgkJfSBlbHNlIHsNCgkJCWlmKGlzX3VwbG9hZGVkX2ZpbGUoJF9GSUxFU1snZXhwZW5zZV9maWxlJ11bJ3RtcF9uYW1lJ10pKSB7DQoJCQkJLy9jaGVja2luZyBpbWFnZSB0eXBlDQoJCQkJJGFsbG93ZWQgPSAgYXJyYXkoJ3BuZycsJ2pwZycsJ2pwZWcnLCdnaWYnKTsNCgkJCQkkZmlsZW5hbWUgPSAkX0ZJTEVTWydleHBlbnNlX2ZpbGUnXVsnbmFtZSddOw0KCQkJCSRleHQgPSBwYXRoaW5mbygkZmlsZW5hbWUsIFBBVEhJTkZPX0VYVEVOU0lPTik7DQoJCQkJDQoJCQkJaWYoaW5fYXJyYXkoJGV4dCwkYWxsb3dlZCkpew0KCQkJCQkkdG1wX25hbWUgPSAkX0ZJTEVTWyJleHBlbnNlX2ZpbGUiXVsidG1wX25hbWUiXTsNCgkJCQkJJGJpbGxfY29weSA9ICJ1cGxvYWRzL2FjY291bnRpbmcvZGVwb3NpdC8iOw0KCQkJCQkvLyBiYXNlbmFtZSgpIG1heSBwcmV2ZW50IGZpbGVzeXN0ZW0gdHJhdmVyc2FsIGF0dGFja3M7DQoJCQkJCS8vIGZ1cnRoZXIgdmFsaWRhdGlvbi9zYW5pdGF0aW9uIG9mIHRoZSBmaWxlbmFtZSBtYXkgYmUgYXBwcm9wcmlhdGUNCgkJCQkJJGxuYW1lID0gYmFzZW5hbWUoJF9GSUxFU1siZXhwZW5zZV9maWxlIl1bIm5hbWUiXSk7DQoJCQkJCSRuZXdmaWxlbmFtZSA9ICdleHBlbnNlXycucm91bmQobWljcm90aW1lKHRydWUpKS4nLicuJGV4dDsNCgkJCQkJbW92ZV91cGxvYWRlZF9maWxlKCR0bXBfbmFtZSwgJGJpbGxfY29weS4kbmV3ZmlsZW5hbWUpOw0KCQkJCQkkZm5hbWUgPSAkbmV3ZmlsZW5hbWU7DQoJCQkJCSAkZGF0YSA9IGFycmF5KA0KCQkJCQknYWNjb3VudF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdiYW5rX2Nhc2hfaWQnKSwNCgkJCQkJJ2Ftb3VudCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdhbW91bnQnKSwNCgkJCQkJJ3RyYW5zYWN0aW9uX2RhdGUnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnZXhwZW5zZV9kYXRlJyksDQoJCQkJCSdhdHRhY2htZW50X2ZpbGUnID0+ICRmbmFtZSwNCgkJCQkJJ3RyYW5zYWN0aW9uX2NhdF9pZCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdjYXRlZ29yeV9pZCcpLA0KCQkJCQkncGF5ZXJfcGF5ZWVfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgncGF5ZWVfaWQnKSwNCgkJCQkJJ2NvbXBhbnlfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnY29tcGFueScpLA0KCQkJCQkncGF5bWVudF9tZXRob2RfaWQnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgncGF5bWVudF9tZXRob2QnKSwNCgkJCQkJJ2Rlc2NyaXB0aW9uJyA9PiAkcXRfZGVzY3JpcHRpb24sDQoJCQkJCSdyZWZlcmVuY2UnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnZXhwZW5zZV9yZWZlcmVuY2UnKSwJDQoJCQkJCSk7DQoJCQkJCS8vIHVwZGF0ZSByZWNvcmQgPiBtb2RlbA0KCQkJCQkkcmVzdWx0ID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnVwZGF0ZV90cmFuc2FjdGlvbl9yZWNvcmQoJGRhdGEsJGlkKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9hdHRhdGNobWVudF90eXBlJyk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCQ0KCQlpZigkUmV0dXJuWydlcnJvciddIT0nJyl7DQogICAgICAgCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KICAgIAl9DQoJCQ0KCQlpZiAoJHJlc3VsdCA9PSBUUlVFKSB7DQoJCQkkUmV0dXJuWydyZXN1bHQnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3N1Y2Nlc3NfZXhwZW5zZV91cGRhdGVkJyk7DQoJCX0gZWxzZSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcicpOw0KCQl9DQoJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQoJCWV4aXQ7DQoJCX0NCgl9DQoJDQoJLyoqKipBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSovLy8vLwkNCglwdWJsaWMgZnVuY3Rpb24gYWNjb3VudHNfbGVkZ2VyKCkgew0KCQ0KCQkkaWQgPSAkdGhpcy0+dXJpLT5zZWdtZW50KDQpOw0KCQkkYmFjX2lkID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfdHJhbnNhY3Rpb25fYnlfYmFua19pbmZvKCRpZCk7DQoJCWlmKGlzX251bGwoJGJhY19pZCkpew0KCQkJcmVkaXJlY3QoJ2FkbWluL2FjY291bnRpbmcvdHJhbnNhY3Rpb25zJyk7DQoJCX0NCgkJJHN5c3RlbSA9ICR0aGlzLT5YaW5fbW9kZWwtPnJlYWRfc2V0dGluZ19pbmZvKDEpOw0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2xlZGdlcl9hY2NvdW50JykuJyB8ICcuJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkZGF0YVsnYnJlYWRjcnVtYnMnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2xlZGdlcl9hY2NvdW50Jyk7DQoJCSRkYXRhWydwYXRoX3VybCddID0gJ2FjY291bnRpbmdfYmFua3dpc2VfdHJhbnNhY3Rpb25zJzsNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCSRyb2xlX3Jlc291cmNlc19pZHMgPSAkdGhpcy0+WGluX21vZGVsLT51c2VyX3JvbGVfcmVzb3VyY2UoKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJaWYoaW5fYXJyYXkoJzQnLCRyb2xlX3Jlc291cmNlc19pZHMpKSB7DQoJCQkJJGRhdGFbJ3N1YnZpZXcnXSA9ICR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL2xlZGdlcl9hY2NvdW50X2xpc3QiLCAkZGF0YSwgVFJVRSk7DQoJCQkJJHRoaXMtPmxvYWQtPnZpZXcoJ2FkbWluL2xheW91dC9sYXlvdXRfbWFpbicsICRkYXRhKTsgLy9wYWdlIGxvYWQNCgkJCX0gZWxzZSB7DQoJCQkJcmVkaXJlY3QoJ2FkbWluL2Rhc2hib2FyZCcpOw0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJfQ0KCQ0KCXB1YmxpYyBmdW5jdGlvbiBsZWRnZXJfYWNjb3VudHMoKSB7DQoJDQoJCSRzeXN0ZW0gPSAkdGhpcy0+WGluX21vZGVsLT5yZWFkX3NldHRpbmdfaW5mbygxKTsNCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19sZWRnZXJfYWNjb3VudCcpLicgfCAnLiR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJJGRhdGFbJ2JyZWFkY3J1bWJzJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19sZWRnZXJfYWNjb3VudCcpOw0KCQkkZGF0YVsncGF0aF91cmwnXSA9ICd4aW5fbGVkZ2VyX2FjY291bnRzJzsNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCSRyb2xlX3Jlc291cmNlc19pZHMgPSAkdGhpcy0+WGluX21vZGVsLT51c2VyX3JvbGVfcmVzb3VyY2UoKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJaWYoaW5fYXJyYXkoJzQnLCRyb2xlX3Jlc291cmNlc19pZHMpKSB7DQoJCQkJJGRhdGFbJ3N1YnZpZXcnXSA9ICR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL2Z1bGxfbGVkZ2VyX2FjY291bnRfbGlzdCIsICRkYXRhLCBUUlVFKTsNCgkJCQkkdGhpcy0+bG9hZC0+dmlldygnYWRtaW4vbGF5b3V0L2xheW91dF9tYWluJywgJGRhdGEpOyAvL3BhZ2UgbG9hZA0KCQkJfSBlbHNlIHsNCgkJCQlyZWRpcmVjdCgnYWRtaW4vZGFzaGJvYXJkJyk7DQoJCQl9DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgl9DQoJDQoJcHVibGljIGZ1bmN0aW9uIGFjY291bnRfc3RhdGVtZW50KCkgew0KCQ0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoZW1wdHkoJHNlc3Npb24pKXsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkc3lzdGVtID0gJHRoaXMtPlhpbl9tb2RlbC0+cmVhZF9zZXR0aW5nX2luZm8oMSk7DQoJCWlmKCRzeXN0ZW1bMF0tPm1vZHVsZV9hY2NvdW50aW5nIT0ndHJ1ZScpew0KCQkJcmVkaXJlY3QoJ2FkbWluL2Rhc2hib2FyZCcpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfYWNjb3VudF9zdGF0ZW1lbnQnKS4nIHwgJy4kdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCSRkYXRhWydicmVhZGNydW1icyddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfYWNjb3VudF9zdGF0ZW1lbnQnKTsNCgkJJGRhdGFbJ3BhdGhfdXJsJ10gPSAnYWNjb3VudGluZ19yZXBvcnRfc3RhdGVtZW50JzsNCgkJJGRhdGFbJ2FsbF9iYW5rX2Nhc2gnXSA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hbGxfYmFua19jYXNoKCk7DQoJCSRkYXRhWydhbGxfaW5jb21lX2NhdGVnb3JpZXNfbGlzdCddID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFsbF9pbmNvbWVfY2F0ZWdvcmllc19saXN0KCk7DQoJCSRkYXRhWydnZXRfYWxsX3BheW1lbnRfbWV0aG9kJ10gPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+Z2V0X2FsbF9wYXltZW50X21ldGhvZCgpOw0KCQkkcm9sZV9yZXNvdXJjZXNfaWRzID0gJHRoaXMtPlhpbl9tb2RlbC0+dXNlcl9yb2xlX3Jlc291cmNlKCk7DQoJCWlmKGluX2FycmF5KCc4MycsJHJvbGVfcmVzb3VyY2VzX2lkcykpIHsNCgkJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCQkkZGF0YVsnc3VidmlldyddID0gJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvcmVwb3J0X2FjY291bnRfc3RhdGVtZW50IiwgJGRhdGEsIFRSVUUpOw0KCQkJCSR0aGlzLT5sb2FkLT52aWV3KCdhZG1pbi9sYXlvdXQvbGF5b3V0X21haW4nLCAkZGF0YSk7IC8vcGFnZSBsb2FkDQoJCQl9IGVsc2Ugew0KCQkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJCX0NCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCX0NCgkNCglwdWJsaWMgZnVuY3Rpb24gZXhwZW5zZV9yZXBvcnQoKSB7DQoJDQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRzeXN0ZW0gPSAkdGhpcy0+WGluX21vZGVsLT5yZWFkX3NldHRpbmdfaW5mbygxKTsNCgkJaWYoJHN5c3RlbVswXS0+bW9kdWxlX2FjY291bnRpbmchPSd0cnVlJyl7DQoJCQlyZWRpcmVjdCgnYWRtaW4vZGFzaGJvYXJkJyk7DQoJCX0NCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19leHBlbnNlX3JlcG9ydHMnKS4nIHwgJy4kdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCSRkYXRhWydicmVhZGNydW1icyddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXhwZW5zZV9yZXBvcnRzJyk7DQoJCSRkYXRhWydwYXRoX3VybCddID0gJ2FjY291bnRpbmdfcmVwb3J0X2V4cGVuc2UnOw0KCQkkZGF0YVsnYWxsX2JhbmtfY2FzaCddID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmFsbF9iYW5rX2Nhc2goKTsNCgkJJGRhdGFbJ2FsbF9jb21wYW5pZXMnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPmdldF9jb21wYW5pZXMoKTsNCgkJJGRhdGFbJ2FsbF9leHBlbnNlX3R5cGVzJ10gPSAkdGhpcy0+RXhwZW5zZV9tb2RlbC0+YWxsX2V4cGVuc2VfdHlwZXMoKTsNCgkJJHJvbGVfcmVzb3VyY2VzX2lkcyA9ICR0aGlzLT5YaW5fbW9kZWwtPnVzZXJfcm9sZV9yZXNvdXJjZSgpOw0KCQlpZihpbl9hcnJheSgnODQnLCRyb2xlX3Jlc291cmNlc19pZHMpKSB7DQoJCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkJJGRhdGFbJ3N1YnZpZXcnXSA9ICR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL3JlcG9ydF9leHBlbnNlIiwgJGRhdGEsIFRSVUUpOw0KCQkJCSR0aGlzLT5sb2FkLT52aWV3KCdhZG1pbi9sYXlvdXQvbGF5b3V0X21haW4nLCAkZGF0YSk7IC8vcGFnZSBsb2FkDQoJCQl9IGVsc2Ugew0KCQkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJCX0NCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCX0NCgkNCglwdWJsaWMgZnVuY3Rpb24gaW5jb21lX3JlcG9ydCgpIHsNCgkNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJHN5c3RlbSA9ICR0aGlzLT5YaW5fbW9kZWwtPnJlYWRfc2V0dGluZ19pbmZvKDEpOw0KCQlpZigkc3lzdGVtWzBdLT5tb2R1bGVfYWNjb3VudGluZyE9J3RydWUnKXsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2luY29tZV9yZXBvcnRzJykuJyB8ICcuJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkZGF0YVsnYnJlYWRjcnVtYnMnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2luY29tZV9yZXBvcnRzJyk7DQoJCSRkYXRhWydwYXRoX3VybCddID0gJ2FjY291bnRpbmdfcmVwb3J0X2luY29tZSc7DQoJCSRkYXRhWydhbGxfYmFua19jYXNoJ10gPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWxsX2JhbmtfY2FzaCgpOw0KCQkkZGF0YVsnYWxsX2luY29tZV9jYXRlZ29yaWVzX2xpc3QnXSA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hbGxfaW5jb21lX2NhdGVnb3JpZXNfbGlzdCgpOw0KCQkkcm9sZV9yZXNvdXJjZXNfaWRzID0gJHRoaXMtPlhpbl9tb2RlbC0+dXNlcl9yb2xlX3Jlc291cmNlKCk7DQoJCWlmKGluX2FycmF5KCc4NScsJHJvbGVfcmVzb3VyY2VzX2lkcykpIHsNCgkJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCQkkZGF0YVsnc3VidmlldyddID0gJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvcmVwb3J0X2luY29tZSIsICRkYXRhLCBUUlVFKTsNCgkJCQkkdGhpcy0+bG9hZC0+dmlldygnYWRtaW4vbGF5b3V0L2xheW91dF9tYWluJywgJGRhdGEpOyAvL3BhZ2UgbG9hZA0KCQkJfSBlbHNlIHsNCgkJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCQl9DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vZGFzaGJvYXJkJyk7DQoJCX0NCgl9DQoJDQoJcHVibGljIGZ1bmN0aW9uIHRyYW5zZmVyX3JlcG9ydCgpIHsNCgkNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJHN5c3RlbSA9ICR0aGlzLT5YaW5fbW9kZWwtPnJlYWRfc2V0dGluZ19pbmZvKDEpOw0KCQlpZigkc3lzdGVtWzBdLT5tb2R1bGVfYWNjb3VudGluZyE9J3RydWUnKXsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3RyYW5zZmVyX3JlcG9ydCcpLicgfCAnLiR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJJGRhdGFbJ2JyZWFkY3J1bWJzJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY190cmFuc2Zlcl9yZXBvcnQnKTsNCgkJJGRhdGFbJ3BhdGhfdXJsJ10gPSAnYWNjb3VudGluZ19yZXBvcnRfdHJhbnNmZXInOw0KCQkkcm9sZV9yZXNvdXJjZXNfaWRzID0gJHRoaXMtPlhpbl9tb2RlbC0+dXNlcl9yb2xlX3Jlc291cmNlKCk7DQoJCWlmKGluX2FycmF5KCc4NicsJHJvbGVfcmVzb3VyY2VzX2lkcykpIHsNCgkJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCQkkZGF0YVsnc3VidmlldyddID0gJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvcmVwb3J0X3RyYW5zZmVyIiwgJGRhdGEsIFRSVUUpOw0KCQkJCSR0aGlzLT5sb2FkLT52aWV3KCdhZG1pbi9sYXlvdXQvbGF5b3V0X21haW4nLCAkZGF0YSk7IC8vcGFnZSBsb2FkDQoJCQl9IGVsc2Ugew0KCQkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJCX0NCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi9kYXNoYm9hcmQnKTsNCgkJfQ0KCX0NCgkJDQoJcHVibGljIGZ1bmN0aW9uIHJlYWRfdHJhbnNmZXIoKQ0KCXsNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkkaWQgPSAkdGhpcy0+aW5wdXQtPmdldCgndHJhbnNmZXJfaWQnKTsNCgkJJHJlc3VsdCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5yZWFkX3RyYW5zZmVyX2luZm9ybWF0aW9uKCRpZCk7DQoJCSRkYXRhID0gYXJyYXkoDQoJCQkJJ3RyYW5zZmVyX2lkJyA9PiAkcmVzdWx0WzBdLT50cmFuc2Zlcl9pZCwNCgkJCQknZnJvbV9hY2NvdW50X2lkJyA9PiAkcmVzdWx0WzBdLT5mcm9tX2FjY291bnRfaWQsDQoJCQkJJ3RvX2FjY291bnRfaWQnID0+ICRyZXN1bHRbMF0tPnRvX2FjY291bnRfaWQsDQoJCQkJJ3RyYW5zZmVyX2RhdGUnID0+ICRyZXN1bHRbMF0tPnRyYW5zZmVyX2RhdGUsDQoJCQkJJ3RyYW5zZmVyX2Ftb3VudCcgPT4gJHJlc3VsdFswXS0+dHJhbnNmZXJfYW1vdW50LA0KCQkJCSdwYXltZW50X21ldGhvZF9pZCcgPT4gJHJlc3VsdFswXS0+cGF5bWVudF9tZXRob2QsDQoJCQkJJ3RyYW5zZmVyX3JlZmVyZW5jZScgPT4gJHJlc3VsdFswXS0+dHJhbnNmZXJfcmVmZXJlbmNlLA0KCQkJCSdkZXNjcmlwdGlvbicgPT4gJHJlc3VsdFswXS0+ZGVzY3JpcHRpb24sDQoJCQkJJ2NyZWF0ZWRfYXQnID0+ICRyZXN1bHRbMF0tPmNyZWF0ZWRfYXQsDQoJCQkJJ2FsbF9iYW5rX2Nhc2gnID0+ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hbGxfYmFua19jYXNoKCksDQoJCQkJJ2dldF9hbGxfcGF5bWVudF9tZXRob2QnID0+ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5nZXRfYWxsX3BheW1lbnRfbWV0aG9kKCkNCgkJCQkpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygnYWRtaW4vYWNjb3VudGluZy9kaWFsb2dfYWNjb3VudGluZycsICRkYXRhKTsNCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCX0NCgkgDQoJIC8qKioqUmVwb3J0cyAqKiovDQogICAgCSANCgkvLyByZXBvcnQgYWNjb3VudCBzdGF0ZW1lbnQgPiBzZWFyY2gNCglwdWJsaWMgZnVuY3Rpb24gcmVwb3J0X3N0YXRlbWVudF9saXN0KCkgew0KDQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpeyANCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvcmVwb3J0X2FjY291bnRfc3RhdGVtZW50IiwgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCS8vIERhdGF0YWJsZXMgVmFyaWFibGVzDQoJCSRkcmF3ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJkcmF3IikpOw0KCQkkc3RhcnQgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoInN0YXJ0IikpOw0KCQkkbGVuZ3RoID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJsZW5ndGgiKSk7DQoJCQkJDQoJCSR0cmFuc2FjdGlvbnMgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+YWNjb3VudF9zdGF0ZW1lbnRfc2VhcmNoKCR0aGlzLT5pbnB1dC0+Z2V0KCdmcm9tX2RhdGUnKSwkdGhpcy0+aW5wdXQtPmdldCgndG9fZGF0ZScpLCR0aGlzLT5pbnB1dC0+Z2V0KCdhY2NvdW50X2lkJykpOw0KCQkNCgkJJGRhdGEgPSBhcnJheSgpOw0KCQkkY3JkX3RvdGFsID0gMDsgJGRlYl90b3RhbCA9IDA7JGJhbGFuY2U9MDsgJGJhbGFuY2UyID0gMDsNCiAgICAgICAgZm9yZWFjaCgkdHJhbnNhY3Rpb25zLT5yZXN1bHQoKSBhcyAkcikgew0KCQkJICANCgkJICAgLy8gdHJhbnNhY3Rpb24gZGF0ZQ0KCQkJJHRyYW5zYWN0aW9uX2RhdGUgPSAkdGhpcy0+WGluX21vZGVsLT5zZXRfZGF0ZV9mb3JtYXQoJHItPnRyYW5zYWN0aW9uX2RhdGUpOw0KCQkJLy8gZ2V0IGN1cnJlbmN5DQoJCQkkdG90YWxfYW1vdW50ID0gJHRoaXMtPlhpbl9tb2RlbC0+Y3VycmVuY3lfc2lnbigkci0+YW1vdW50KTsNCgkJCSRhY2NfdHlwZSA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5yZWFkX2JhbmtjYXNoX2luZm9ybWF0aW9uKCRyLT5hY2NvdW50X2lkKTsNCgkJCWlmKCFpc19udWxsKCRhY2NfdHlwZSkpew0KCQkJCSRhY2NvdW50X2JhbGFuY2UgPSAkYWNjX3R5cGVbMF0tPmFjY291bnRfb3BlbmluZ19iYWxhbmNlOw0KCQkJfSBlbHNlIHsNCgkJCQkkYWNjb3VudF9iYWxhbmNlID0gMDsJDQoJCQl9DQoJCQkNCgkJCWlmKCRyLT5kcl9jciA9PSAnY3InKSB7DQoJCQkJJGJhbGFuY2UyID0gJGJhbGFuY2UyIC0gJHItPmFtb3VudDsNCgkJCX0gZWxzZSB7DQoJCQkJJGJhbGFuY2UyID0gJGJhbGFuY2UyICsgJHItPmFtb3VudDsNCgkJCX0NCgkJCWlmKCRyLT5jcmVkaXQhPTApOg0KCQkJCSRjcmQgPSAkci0+Y3JlZGl0Ow0KCQkJCSRjcmRfdG90YWwgKz0gJGNyZDsNCgkJCWVsc2U6DQoJCQkJJGNyZCA9IDA7CQ0KCQkJCSRjcmRfdG90YWwgKz0gJGNyZDsNCgkJCWVuZGlmOw0KCQkJaWYoJHItPmRlYml0IT0wKToNCgkJCQkkZGViID0gJHItPmRlYml0Ow0KCQkJCSRkZWJfdG90YWwgKz0gJGRlYjsNCgkJCWVsc2U6DQoJCQkJJGRlYiA9IDA7CQ0KCQkJCSRkZWJfdG90YWwgKz0gJGRlYjsNCgkJCWVuZGlmOw0KCQkJLy8kZmJhbGFuY2UgPSAkYWNjb3VudF9iYWxhbmNlICsgJGJhbGFuY2UyOw0KCQkJDQoJCQkkZGF0YVtdID0gYXJyYXkoDQoJCQkJJHRyYW5zYWN0aW9uX2RhdGUsDQoJCQkJJHItPnRyYW5zYWN0aW9uX3R5cGUsDQoJCQkJJHItPmRlc2NyaXB0aW9uLA0KCQkJCSR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJGNyZCksDQoJCQkJJHRoaXMtPlhpbl9tb2RlbC0+Y3VycmVuY3lfc2lnbigkZGViKQ0KCQkgICApOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgICRvdXRwdXQgPSBhcnJheSgNCiAgICAgICAgICAgICAgICJkcmF3IiA9PiAkZHJhdywNCiAgICAgICAgICAgICAgICAgInJlY29yZHNUb3RhbCIgPT4gJHRyYW5zYWN0aW9ucy0+bnVtX3Jvd3MoKSwNCiAgICAgICAgICAgICAgICAgInJlY29yZHNGaWx0ZXJlZCIgPT4gJHRyYW5zYWN0aW9ucy0+bnVtX3Jvd3MoKSwNCiAgICAgICAgICAgICAgICAgImRhdGEiID0+ICRkYXRhDQogICAgICAgICAgICApOw0KICAgICAgICAgIGVjaG8ganNvbl9lbmNvZGUoJG91dHB1dCk7DQogICAgICAgICAgZXhpdCgpOw0KICAgICB9DQoJIA0KCSAvLyBnZXQgc3RhdGVtZW50IGZvb3RlciAtIGRhdGENCgkgcHVibGljIGZ1bmN0aW9uIGdldF9zdGF0ZW1lbnRfZm9vdGVyKCkgew0KDQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkNCgkJJGRhdGEgPSBhcnJheSgNCgkJCSdmcm9tX2RhdGUnID0+ICR0aGlzLT5pbnB1dC0+Z2V0KCdmcm9tX2RhdGUnKSwNCgkJCSd0b19kYXRlJyA9PiAkdGhpcy0+aW5wdXQtPmdldCgndG9fZGF0ZScpLA0KCQkJJ2FjY291bnRfaWQnID0+ICR0aGlzLT5pbnB1dC0+Z2V0KCdhY2NvdW50X2lkJykNCgkJCSk7DQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9mb290ZXIvZ2V0X3N0YXRlbWVudF9mb290ZXIiLCAkZGF0YSk7DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJLy8gRGF0YXRhYmxlcyBWYXJpYWJsZXMNCgkJJGRyYXcgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImRyYXciKSk7DQoJCSRzdGFydCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgic3RhcnQiKSk7DQoJCSRsZW5ndGggPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImxlbmd0aCIpKTsNCgkgfQ0KCSANCgkgLy8gcmVwb3J0IGV4cGVuc2UgbGlzdA0KCXB1YmxpYyBmdW5jdGlvbiByZXBvcnRfZXhwZW5zZV9saXN0KCkNCiAgICAgew0KDQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpeyANCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvcmVwb3J0X2V4cGVuc2UiLCAkZGF0YSk7DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJLy8gRGF0YXRhYmxlcyBWYXJpYWJsZXMNCgkJJGRyYXcgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImRyYXciKSk7DQoJCSRzdGFydCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgic3RhcnQiKSk7DQoJCSRsZW5ndGggPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImxlbmd0aCIpKTsNCgkJDQoJCSRleHBlbnNlID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPmdldF9leHBlbnNlX3NlYXJjaCgkdGhpcy0+aW5wdXQtPmdldCgnZnJvbV9kYXRlJyksJHRoaXMtPmlucHV0LT5nZXQoJ3RvX2RhdGUnKSwkdGhpcy0+aW5wdXQtPmdldCgndHlwZV9pZCcpLCR0aGlzLT5pbnB1dC0+Z2V0KCdjb21wYW55X2lkJykpOw0KCQkNCgkJJGRhdGEgPSBhcnJheSgpOw0KDQogICAgICAgICAgZm9yZWFjaCgkZXhwZW5zZS0+cmVzdWx0KCkgYXMgJHIpIHsNCgkJCSAgDQoJCQkvLyBnZXQgYW1vdW50DQoJCQkkYW1vdW50ID0gJHRoaXMtPlhpbl9tb2RlbC0+Y3VycmVuY3lfc2lnbigkci0+YW1vdW50KTsNCgkJCS8vIGFjY291bnQgdHlwZQ0KCQkJJGFjY190eXBlID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfYmFua2Nhc2hfaW5mb3JtYXRpb24oJHItPmFjY291bnRfaWQpOw0KCQkJaWYoIWlzX251bGwoJGFjY190eXBlKSl7DQoJCQkJJGFjY291bnQgPSAkYWNjX3R5cGVbMF0tPmFjY291bnRfbmFtZTsNCgkJCX0gZWxzZSB7DQoJCQkJJGFjY291bnQgPSAnLS0nOwkNCgkJCX0NCgkJCQ0KCQkJLy8gZ2V0IHBheWVlDQoJCQkkcGF5ZWUgPSAkdGhpcy0+WGluX21vZGVsLT5yZWFkX3VzZXJfaW5mbygkci0+cGF5ZXJfcGF5ZWVfaWQpOw0KCQkJLy8gdXNlciBmdWxsIG5hbWUNCgkJCWlmKCFpc19udWxsKCRwYXllZSkpew0KCQkJCSRmdWxsX25hbWUgPSAkcGF5ZWVbMF0tPmZpcnN0X25hbWUuJyAnLiRwYXllZVswXS0+bGFzdF9uYW1lOw0KCQkJfSBlbHNlIHsNCgkJCQkkZnVsbF9uYW1lID0gJy0tJzsJDQoJCQl9DQoJCQkNCgkJCS8vIGRlcG9zaXQgZGF0ZQ0KCQkJJGV4cGVuc2VfZGF0ZSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNldF9kYXRlX2Zvcm1hdCgkci0+dHJhbnNhY3Rpb25fZGF0ZSk7DQoJCQkvLyBjYXRlZ29yeQ0KCQkJJGV4cGVuc2VfdHlwZSA9ICR0aGlzLT5FeHBlbnNlX21vZGVsLT5yZWFkX2V4cGVuc2VfdHlwZV9pbmZvcm1hdGlvbigkci0+dHJhbnNhY3Rpb25fY2F0X2lkKTsNCgkJCWlmKCFpc19udWxsKCRleHBlbnNlX3R5cGUpKXsNCgkJCQkkY2F0ZWdvcnkgPSAkZXhwZW5zZV90eXBlWzBdLT5uYW1lOw0KCQkJfSBlbHNlIHsNCgkJCQkkY2F0ZWdvcnkgPSAnLS0nOwkNCgkJCX0NCgkJCQ0KCQkgICAkZGF0YVtdID0gYXJyYXkoDQoJCQkJJGV4cGVuc2VfZGF0ZSwNCgkJCQkkYWNjb3VudCwNCgkJCQkkY2F0ZWdvcnksDQoJCQkJJGZ1bGxfbmFtZSwNCgkJCQkkYW1vdW50LA0KCQkgICApOw0KCSAgfQ0KDQoJICAkb3V0cHV0ID0gYXJyYXkoDQoJCSAgICJkcmF3IiA9PiAkZHJhdywNCgkJCSAicmVjb3Jkc1RvdGFsIiA9PiAkZXhwZW5zZS0+bnVtX3Jvd3MoKSwNCgkJCSAicmVjb3Jkc0ZpbHRlcmVkIiA9PiAkZXhwZW5zZS0+bnVtX3Jvd3MoKSwNCgkJCSAiZGF0YSIgPT4gJGRhdGENCgkJKTsNCgkgIGVjaG8ganNvbl9lbmNvZGUoJG91dHB1dCk7DQoJICBleGl0KCk7DQogICAgIH0NCgkgDQoJIC8vIGdldCBleHBlbnNlIGZvb3RlciAtIGRhdGENCgkgcHVibGljIGZ1bmN0aW9uIGdldF9leHBlbnNlX2Zvb3RlcigpIHsNCg0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJDQoJCSRkYXRhID0gYXJyYXkoDQoJCQknZnJvbV9kYXRlJyA9PiAkdGhpcy0+aW5wdXQtPmdldCgnZnJvbV9kYXRlJyksDQoJCQkndG9fZGF0ZScgPT4gJHRoaXMtPmlucHV0LT5nZXQoJ3RvX2RhdGUnKSwNCgkJCSd0eXBlX2lkJyA9PiAkdGhpcy0+aW5wdXQtPmdldCgndHlwZV9pZCcpLA0KCQkJJ2NvbXBhbnlfaWQnID0+ICR0aGlzLT5pbnB1dC0+Z2V0KCdjb21wYW55X2lkJykNCgkJCSk7DQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9mb290ZXIvZ2V0X2V4cGVuc2VfZm9vdGVyIiwgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCS8vIERhdGF0YWJsZXMgVmFyaWFibGVzDQoJCSRkcmF3ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJkcmF3IikpOw0KCQkkc3RhcnQgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoInN0YXJ0IikpOw0KCQkkbGVuZ3RoID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJsZW5ndGgiKSk7DQoJIH0NCgkgDQoJIC8vIGluY29tZSByZXBvcnQgbGlzdA0KCXB1YmxpYyBmdW5jdGlvbiByZXBvcnRfaW5jb21lX2xpc3QoKSB7DQoNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9yZXBvcnRfaW5jb21lIiwgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCS8vIERhdGF0YWJsZXMgVmFyaWFibGVzDQoJCSRkcmF3ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJkcmF3IikpOw0KCQkkc3RhcnQgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoInN0YXJ0IikpOw0KCQkkbGVuZ3RoID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJsZW5ndGgiKSk7DQoJCQ0KCQkNCgkJJGRlcG9zaXQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+Z2V0X2RlcG9zaXRfc2VhcmNoKCR0aGlzLT5pbnB1dC0+Z2V0KCdmcm9tX2RhdGUnKSwkdGhpcy0+aW5wdXQtPmdldCgndG9fZGF0ZScpLCR0aGlzLT5pbnB1dC0+Z2V0KCd0eXBlX2lkJykpOw0KCQkNCgkJJGRhdGEgPSBhcnJheSgpOw0KDQogICAgICAgICAgZm9yZWFjaCgkZGVwb3NpdC0+cmVzdWx0KCkgYXMgJHIpIHsNCgkJCSAgDQoJCQkvLyBhY2NvdW50IHR5cGUNCgkJCSRhY2NfdHlwZSA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5yZWFkX2JhbmtjYXNoX2luZm9ybWF0aW9uKCRyLT5hY2NvdW50X2lkKTsNCgkJCWlmKCFpc19udWxsKCRhY2NfdHlwZSkpew0KCQkJCSRhY2NvdW50ID0gJGFjY190eXBlWzBdLT5hY2NvdW50X25hbWU7DQoJCQl9IGVsc2Ugew0KCQkJCSRhY2NvdW50ID0gJy0tJzsJDQoJCQl9DQoJCQkNCgkJCS8vIGdldCBwYXllZQ0KCQkJJHBheWVyID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfcGF5ZXJfaW5mbygkci0+cGF5ZXJfcGF5ZWVfaWQpOw0KCQkJLy8gdXNlciBmdWxsIG5hbWUNCgkJCWlmKCFpc19udWxsKCRwYXllcikpew0KCQkJCSRmdWxsX25hbWUgPSAkcGF5ZXJbMF0tPnBheWVyX25hbWU7DQoJCQl9IGVsc2Ugew0KCQkJCSRmdWxsX25hbWUgPSAnLS0nOwkNCgkJCX0NCgkJCQ0KCQkJLy8gZGVwb3NpdCBkYXRlDQoJCQkkZGVwb3NpdF9kYXRlID0gJHRoaXMtPlhpbl9tb2RlbC0+c2V0X2RhdGVfZm9ybWF0KCRyLT50cmFuc2FjdGlvbl9kYXRlKTsNCgkJCS8vIGNhdGVnb3J5DQoJCQkkY2F0ZWdvcnlfaWQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9pbmNvbWVfY2F0ZWdvcnkoJHItPnRyYW5zYWN0aW9uX2NhdF9pZCk7DQoJCQlpZighaXNfbnVsbCgkY2F0ZWdvcnlfaWQpKXsNCgkJCQkkY2F0ZWdvcnkgPSAkY2F0ZWdvcnlfaWRbMF0tPm5hbWU7DQoJCQl9IGVsc2Ugew0KCQkJCSRjYXRlZ29yeSA9ICctLSc7CQ0KCQkJfQ0KCQkJLy8gZ2V0IGFtb3VudA0KCQkJJGFtb3VudCA9ICR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJHItPmFtb3VudCk7DQoNCgkJICAgJGRhdGFbXSA9IGFycmF5KA0KCQkJCSRkZXBvc2l0X2RhdGUsDQoJCQkJJGFjY291bnQsDQoJCQkJJGNhdGVnb3J5LA0KCQkJCSRmdWxsX25hbWUsDQoJCQkJJGFtb3VudAkJDQoJCSAgICk7DQoJICB9DQoNCgkgICRvdXRwdXQgPSBhcnJheSgNCgkJICAgImRyYXciID0+ICRkcmF3LA0KCQkJICJyZWNvcmRzVG90YWwiID0+ICRkZXBvc2l0LT5udW1fcm93cygpLA0KCQkJICJyZWNvcmRzRmlsdGVyZWQiID0+ICRkZXBvc2l0LT5udW1fcm93cygpLA0KCQkJICJkYXRhIiA9PiAkZGF0YQ0KCQkpOw0KCSAgZWNobyBqc29uX2VuY29kZSgkb3V0cHV0KTsNCgkgIGV4aXQoKTsNCiAgICAgfSANCgkgDQoJLy8gcmVwb3J0IHRyYW5zZmVyIGxpc3QNCglwdWJsaWMgZnVuY3Rpb24gcmVwb3J0X3RyYW5zZmVyX2xpc3QoKSB7DQoNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKGVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQlpZighZW1wdHkoJHNlc3Npb24pKXsgDQoJCQkkdGhpcy0+bG9hZC0+dmlldygiYWRtaW4vYWNjb3VudGluZy9yZXBvcnRfdHJhbnNmZXIiLCAkZGF0YSk7DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJLy8gRGF0YXRhYmxlcyBWYXJpYWJsZXMNCgkJJGRyYXcgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImRyYXciKSk7DQoJCSRzdGFydCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgic3RhcnQiKSk7DQoJCSRsZW5ndGggPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImxlbmd0aCIpKTsNCgkJDQoJCQ0KCQkkdHJhbnNmZXIgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+Z2V0X3RyYW5zZmVyX3NlYXJjaCgkdGhpcy0+aW5wdXQtPmdldCgnZnJvbV9kYXRlJyksJHRoaXMtPmlucHV0LT5nZXQoJ3RvX2RhdGUnKSk7DQoJCQ0KCQkkZGF0YSA9IGFycmF5KCk7DQoNCiAgICAgICAgZm9yZWFjaCgkdHJhbnNmZXItPnJlc3VsdCgpIGFzICRyKSB7DQoJCQkgIA0KCQkJLy8gZ2V0IGFtb3VudA0KCQkJJGFtb3VudCA9ICR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJHItPmFtb3VudCk7DQoJCQlpZigkci0+ZHJfY3IgPT0gJ2NyJykgew0KCQkJCSR4aW5fYWNjID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfY3JlZGl0Jyk7DQoJCQl9IGVsc2Ugew0KCQkJCSR4aW5fYWNjID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZGViaXQnKTsNCgkJCX0JCQkNCgkJCS8vIHRyYW5zZmVyIGRhdGUNCgkJCSR0cmFuc2Zlcl9kYXRlID0gJHRoaXMtPlhpbl9tb2RlbC0+c2V0X2RhdGVfZm9ybWF0KCRyLT50cmFuc2FjdGlvbl9kYXRlKTsNCgkJCS8vIHBheW1lbnQgbWV0aG9kIA0KCQkJJHBheW1lbnRfbWV0aG9kID0gJHRoaXMtPlhpbl9tb2RlbC0+cmVhZF9wYXltZW50X21ldGhvZCgkci0+cGF5bWVudF9tZXRob2RfaWQpOw0KCQkJaWYoIWlzX251bGwoJHBheW1lbnRfbWV0aG9kKSl7DQoJCQkJJG1ldGhvZF9uYW1lID0gJHBheW1lbnRfbWV0aG9kWzBdLT5tZXRob2RfbmFtZTsNCgkJCX0gZWxzZSB7DQoJCQkJJG1ldGhvZF9uYW1lID0gJy0tJzsJDQoJCQl9DQoJCQkkci0+ZHJfY3I9PSJkciIgPyAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19kZWJpdCcpIDogJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfY3JlZGl0Jyk7DQoJCQkkci0+ZGViaXQhPU5VTEwgPyAkZGJfYW0gPSAiLSAiLiR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJHItPmRlYml0KSA6ICRkYl9hbSA9IiI7DQoJCQkkci0+Y3JlZGl0IT1OVUxMID8gJGNyX2FtID0gIisgIi4kdGhpcy0+WGluX21vZGVsLT5jdXJyZW5jeV9zaWduKCRyLT5jcmVkaXQpIDogJGNyX2FtID0iIjsNCgkJCS8vIGFjY291bnQgdHlwZQ0KCQkJJGFjY190eXBlID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnJlYWRfYmFua2Nhc2hfaW5mb3JtYXRpb24oJHItPmFjY291bnRfaWQpOw0KCQkJaWYoIWlzX251bGwoJGFjY190eXBlKSl7DQoJCQkJJGFjY291bnQgPSAkYWNjX3R5cGVbMF0tPmFjY291bnRfbmFtZTsNCgkJCX0gZWxzZSB7DQoJCQkJJGFjY291bnQgPSAnLS0nOwkNCgkJCX0NCgkJICAgJGRhdGFbXSA9IGFycmF5KA0KCQkJCSR0cmFuc2Zlcl9kYXRlLA0KCQkJCSRyLT5kZXNjcmlwdGlvbiwNCgkJCQkkYWNjb3VudCwNCgkJCQkkeGluX2FjYywNCgkJCQkkZGJfYW0sDQoJCQkJJGNyX2FtDQoJCSAgICk7DQoJICB9DQoNCgkgICRvdXRwdXQgPSBhcnJheSgNCgkJICAgImRyYXciID0+ICRkcmF3LA0KCQkJICJyZWNvcmRzVG90YWwiID0+ICR0cmFuc2Zlci0+bnVtX3Jvd3MoKSwNCgkJCSAicmVjb3Jkc0ZpbHRlcmVkIiA9PiAkdHJhbnNmZXItPm51bV9yb3dzKCksDQoJCQkgImRhdGEiID0+ICRkYXRhDQoJCSk7DQoJICBlY2hvIGpzb25fZW5jb2RlKCRvdXRwdXQpOw0KCSAgZXhpdCgpOw0KICAgICB9IA0KCSANCgkgLy8gcmVwb3J0IGluY29tZSB2cyBleHBlbnNlID4gc2VhcmNoDQoJcHVibGljIGZ1bmN0aW9uIHJlcG9ydF9pbmNvbWVfZXhwZW5zZV9saXN0KCkgew0KDQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpeyANCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkvLyBEYXRhdGFibGVzIFZhcmlhYmxlcw0KCQkkZHJhdyA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgiZHJhdyIpKTsNCgkJJHN0YXJ0ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJzdGFydCIpKTsNCgkJJGxlbmd0aCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgibGVuZ3RoIikpOw0KCQkJCQ0KCQkkYWNjb3VudF9zdGF0ZW1lbnQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+Z2V0X2luY29tZV9leHBlbnNlX3NlYXJjaCgkdGhpcy0+aW5wdXQtPmdldCgnZnJvbV9kYXRlJyksJHRoaXMtPmlucHV0LT5nZXQoJ3RvX2RhdGUnKSk7DQoJCQ0KCQkkZGF0YSA9IGFycmF5KCk7DQoJCSRkZWJpdD0iIjsNCgkJJGRlYml0X3RvdGFsPTA7DQoJCSRjcmVkaXQ9IiI7DQoJCSRjcmVkaXRfdG90YWw9MDsNCiAgICAgICAgZm9yZWFjaCgkYWNjb3VudF9zdGF0ZW1lbnQtPnJlc3VsdCgpIGFzICRyKSB7DQoJCQkgIAkJICANCgkJCWlmKCRyLT50cmFuc2FjdGlvbl9jcmVkaXQhPTAuMDAgJiYgJHItPnRyYW5zYWN0aW9uX2NyZWRpdCA+IDApew0KCQkJCSRjcmVkaXRfdG90YWw9JGNyZWRpdF90b3RhbCskci0+dHJhbnNhY3Rpb25fY3JlZGl0Ow0KCQkJfQ0KCQkJZWxzZSBpZigkci0+dHJhbnNhY3Rpb25fZGViaXQhPTAuMDAgJiYgJHItPnRyYW5zYWN0aW9uX2RlYml0ID4gMCl7DQoJCQkJJGRlYml0X3RvdGFsID0gJGRlYml0X3RvdGFsKyRyLT50cmFuc2FjdGlvbl9kZWJpdDsNCgkJCX0NCgkJIH0NCgkJIA0KCQkgJHRvdGFsRCA9ICI8YiBjbGFzcz0ncHVsbC1yaWdodCc+Ii4kdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY190b3RhbF9jcmVkaXQnKS4iOiAiLiR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJGRlYml0X3RvdGFsKS4iPC9iPiI7DQoJCSAkdG90YWxDID0gIjxiIGNsYXNzPSdwdWxsLXJpZ2h0Jz4iLiR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3RvdGFsX2RlYml0JykuIjogIi4kdGhpcy0+WGluX21vZGVsLT5jdXJyZW5jeV9zaWduKCRjcmVkaXRfdG90YWwpLiI8L2I+IjsNCgkJICRkYXRhW10gPSBhcnJheSgNCgkJCSR0b3RhbEMuJyAnLiR0b3RhbEMsDQoJCQkkdG90YWxELicgJy4kdG90YWxEDQoJICAgKTsNCiAgICAgICAgICANCiAgICAgICAgICAkb3V0cHV0ID0gYXJyYXkoDQogICAgICAgICAgICAgICAiZHJhdyIgPT4gJGRyYXcsDQogICAgICAgICAgICAgICAgICJyZWNvcmRzVG90YWwiID0+ICRhY2NvdW50X3N0YXRlbWVudC0+bnVtX3Jvd3MoKSwNCiAgICAgICAgICAgICAgICAgInJlY29yZHNGaWx0ZXJlZCIgPT4gJGFjY291bnRfc3RhdGVtZW50LT5udW1fcm93cygpLA0KICAgICAgICAgICAgICAgICAiZGF0YSIgPT4gJGRhdGENCiAgICAgICAgICAgICk7DQogICAgICAgICAgZWNobyBqc29uX2VuY29kZSgkb3V0cHV0KTsNCiAgICAgICAgICBleGl0KCk7DQogICAgIH0NCgkgDQoJIC8vICoqKioqIExJU1RJTkcgDQoJIC8vIHNhbGVzX3JlcG9ydF9saXN0DQoJcHVibGljIGZ1bmN0aW9uIGFjY291bnRzX2xlZGdlcl9saXN0KCkgew0KDQoJCSRzZXNzaW9uID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd1c2VybmFtZScpOw0KCQlpZihlbXB0eSgkc2Vzc2lvbikpeyANCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvZnVsbF9sZWRnZXJfYWNjb3VudF9saXN0IiwgJGRhdGEpOw0KCQl9IGVsc2Ugew0KCQkJcmVkaXJlY3QoJ2FkbWluLycpOw0KCQl9DQoJCS8vIERhdGF0YWJsZXMgVmFyaWFibGVzDQoJCSRkcmF3ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJkcmF3IikpOw0KCQkkc3RhcnQgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoInN0YXJ0IikpOw0KCQkkbGVuZ3RoID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJsZW5ndGgiKSk7DQoJCQ0KCQkNCgkJJGFjY19sZWRnZXIgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+Z2V0X2xlZGdlcl9hY2NvdW50cygkdGhpcy0+aW5wdXQtPmdldCgnZnJvbV9kYXRlJyksJHRoaXMtPmlucHV0LT5nZXQoJ3RvX2RhdGUnKSk7DQoJCQ0KCQkkZGF0YSA9IGFycmF5KCk7DQoJCSRjcmRfdG90YWwgPSAwOyAkZGViX3RvdGFsID0gMDskYmFsYW5jZT0wOyAkYmFsYW5jZTIgPSAwOw0KICAgICAgICBmb3JlYWNoKCRhY2NfbGVkZ2VyLT5yZXN1bHQoKSBhcyAkcikgew0KCQkJICANCgkJCS8vIHRyYW5zYWN0aW9uIGRhdGUNCgkJCSR0cmFuc2FjdGlvbl9kYXRlID0gJHRoaXMtPlhpbl9tb2RlbC0+c2V0X2RhdGVfZm9ybWF0KCRyLT50cmFuc2FjdGlvbl9kYXRlKTsNCgkJCS8vIGdldCBjdXJyZW5jeQ0KCQkJJHRvdGFsX2Ftb3VudCA9ICR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJHItPmFtb3VudCk7DQoJCQkkYWNjX3R5cGUgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+cmVhZF9iYW5rY2FzaF9pbmZvcm1hdGlvbigkci0+YWNjb3VudF9pZCk7DQoJCQlpZighaXNfbnVsbCgkYWNjX3R5cGUpKXsNCgkJCQkkYWNjb3VudF9iYWxhbmNlID0gJGFjY190eXBlWzBdLT5hY2NvdW50X29wZW5pbmdfYmFsYW5jZTsNCgkJCX0gZWxzZSB7DQoJCQkJJGFjY291bnRfYmFsYW5jZSA9IDA7CQ0KCQkJfQ0KCQkJDQoJCQlpZigkci0+ZHJfY3IgPT0gJ2NyJykgew0KCQkJCSRiYWxhbmNlMiA9ICRiYWxhbmNlMiAtICRyLT5hbW91bnQ7DQoJCQl9IGVsc2Ugew0KCQkJCSRiYWxhbmNlMiA9ICRiYWxhbmNlMiArICRyLT5hbW91bnQ7DQoJCQl9DQoJCQlpZigkci0+Y3JlZGl0IT0wKToNCgkJCQkkY3JkID0gJHItPmNyZWRpdDsNCgkJCQkkY3JkX3RvdGFsICs9ICRjcmQ7DQoJCQllbHNlOg0KCQkJCSRjcmQgPSAwOwkNCgkJCQkkY3JkX3RvdGFsICs9ICRjcmQ7DQoJCQllbmRpZjsNCgkJCWlmKCRyLT5kZWJpdCE9MCk6DQoJCQkJJGRlYiA9ICRyLT5kZWJpdDsNCgkJCQkkZGViX3RvdGFsICs9ICRkZWI7DQoJCQllbHNlOg0KCQkJCSRkZWIgPSAwOwkNCgkJCQkkZGViX3RvdGFsICs9ICRkZWI7DQoJCQllbmRpZjsNCgkJCSRmYmFsYW5jZSA9ICRhY2NvdW50X2JhbGFuY2UgKyAkYmFsYW5jZTI7DQoJCQkNCgkJICAgJGRhdGFbXSA9IGFycmF5KA0KCQkJCSR0cmFuc2FjdGlvbl9kYXRlLA0KCQkJCSRyLT50cmFuc2FjdGlvbl90eXBlLA0KCQkJCSRyLT5kZXNjcmlwdGlvbiwNCgkJCQkkdGhpcy0+WGluX21vZGVsLT5jdXJyZW5jeV9zaWduKCRjcmQpLA0KCQkJCSR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJGRlYiksDQoJCQkJJHRoaXMtPlhpbl9tb2RlbC0+Y3VycmVuY3lfc2lnbigkZmJhbGFuY2UpDQoJCSAgICk7DQoJICB9DQoNCgkgICRvdXRwdXQgPSBhcnJheSgNCgkJICAgImRyYXciID0+ICRkcmF3LA0KCQkJICJyZWNvcmRzVG90YWwiID0+ICRhY2NfbGVkZ2VyLT5udW1fcm93cygpLA0KCQkJICJyZWNvcmRzRmlsdGVyZWQiID0+ICRhY2NfbGVkZ2VyLT5udW1fcm93cygpLA0KCQkJICJkYXRhIiA9PiAkZGF0YQ0KCQkpOw0KCSAgZWNobyBqc29uX2VuY29kZSgkb3V0cHV0KTsNCgkgIGV4aXQoKTsNCiAgICAgfSANCgkgDQoJIC8vIGdldCBzYWxlcyBmb290ZXIgLSBkYXRhDQoJIHB1YmxpYyBmdW5jdGlvbiBnZXRfYWNjb3VudHNfbGVkZ2VyX2Zvb3RlcigpIHsNCg0KCQkkZGF0YVsndGl0bGUnXSA9ICR0aGlzLT5YaW5fbW9kZWwtPnNpdGVfdGl0bGUoKTsNCgkJDQoJCSRkYXRhID0gYXJyYXkoDQoJCQknZnJvbV9kYXRlJyA9PiAkdGhpcy0+aW5wdXQtPmdldCgnZnJvbV9kYXRlJyksDQoJCQkndG9fZGF0ZScgPT4gJHRoaXMtPmlucHV0LT5nZXQoJ3RvX2RhdGUnKQ0KCQkJKTsNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCSR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL2Zvb3Rlci9nZXRfbGVkZ2VyX2FjY291bnRzX2Zvb3RlciIsICRkYXRhKTsNCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkvLyBEYXRhdGFibGVzIFZhcmlhYmxlcw0KCQkkZHJhdyA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgiZHJhdyIpKTsNCgkJJHN0YXJ0ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJzdGFydCIpKTsNCgkJJGxlbmd0aCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgibGVuZ3RoIikpOw0KCSB9DQoJIC8vIFZhbGlkYXRlIGFuZCBhZGQgaW5mbyBpbiBkYXRhYmFzZQ0KCXB1YmxpYyBmdW5jdGlvbiBhZGRfcGF5ZXIoKSB7DQoJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYWRkX3R5cGUnKT09J2FkZF9wYXllcicpIHsJCQ0KCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJCQ0KCQkvKiBTZXJ2ZXIgc2lkZSBQSFAgaW5wdXQgdmFsaWRhdGlvbiAqLwkJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgncGF5ZXJfbmFtZScpPT09JycpIHsNCiAgICAgICAgCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9wYXllcl9uYW1lJyk7DQoJCX0NCgkJCQkNCgkJaWYoJFJldHVyblsnZXJyb3InXSE9Jycpew0KICAgICAgIAkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCiAgICAJfQ0KCQ0KCQkkZGF0YSA9IGFycmF5KA0KCQkncGF5ZXJfbmFtZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdwYXllcl9uYW1lJyksDQoJCSdjb250YWN0X251bWJlcicgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdjb250YWN0X251bWJlcicpLA0KCQknY3JlYXRlZF9hdCcgPT4gZGF0ZSgnZC1tLVkgaDppOnMnKQ0KCQkpOw0KCQkNCgkJJHJlc3VsdCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hZGRfcGF5ZXJfcmVjb3JkKCRkYXRhKTsNCgkJaWYgKCRyZXN1bHQgPT0gVFJVRSkgew0KCQkJJFJldHVyblsncmVzdWx0J10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19zdWNjZXNzX3BheWVyX2FkZGVkJyk7DQoJCX0gZWxzZSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9tc2cnKTsNCgkJfQ0KCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KCQlleGl0Ow0KCQl9DQoJfQ0KCQ0KCS8vIFZhbGlkYXRlIGFuZCBhZGQgaW5mbyBpbiBkYXRhYmFzZQ0KCXB1YmxpYyBmdW5jdGlvbiBhZGRfcGF5ZWUoKSB7DQoJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnYWRkX3R5cGUnKT09J2FkZF9wYXllZScpIHsJCQ0KCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJCQ0KCQkvKiBTZXJ2ZXIgc2lkZSBQSFAgaW5wdXQgdmFsaWRhdGlvbiAqLwkJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgncGF5ZWVfbmFtZScpPT09JycpIHsNCiAgICAgICAgCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19lcnJvcl9wYXllZV9uYW1lJyk7DQoJCX0NCgkJCQkNCgkJaWYoJFJldHVyblsnZXJyb3InXSE9Jycpew0KICAgICAgIAkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCiAgICAJfQ0KCQ0KCQkkZGF0YSA9IGFycmF5KA0KCQkncGF5ZWVfbmFtZScgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdwYXllZV9uYW1lJyksDQoJCSdjb250YWN0X251bWJlcicgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCdjb250YWN0X251bWJlcicpLA0KCQknY3JlYXRlZF9hdCcgPT4gZGF0ZSgnZC1tLVkgaDppOnMnKQ0KCQkpOw0KCQkNCgkJJHJlc3VsdCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5hZGRfcGF5ZWVfcmVjb3JkKCRkYXRhKTsNCgkJaWYgKCRyZXN1bHQgPT0gVFJVRSkgew0KCQkJJFJldHVyblsncmVzdWx0J10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19zdWNjZXNzX3BheWVlX2FkZGVkJyk7DQoJCX0gZWxzZSB7DQoJCQkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9lcnJvcl9tc2cnKTsNCgkJfQ0KCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KCQlleGl0Ow0KCQl9DQoJfQ0KCQ0KCS8vIFZhbGlkYXRlIGFuZCBhZGQgaW5mbyBpbiBkYXRhYmFzZQ0KCXB1YmxpYyBmdW5jdGlvbiB1cGRhdGVfcGF5ZXIoKSB7DQoJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnZWRpdF90eXBlJyk9PSdwYXllcicpIHsJCQ0KCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJJGlkID0gJHRoaXMtPnVyaS0+c2VnbWVudCg0KTsNCgkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJLyogU2VydmVyIHNpZGUgUEhQIGlucHV0IHZhbGlkYXRpb24gKi8JCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheWVyX25hbWUnKT09PScnKSB7DQogICAgICAgIAkkUmV0dXJuWydlcnJvciddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2NfZXJyb3JfcGF5ZXJfbmFtZScpOw0KCQl9DQoJCQkJDQoJCWlmKCRSZXR1cm5bJ2Vycm9yJ10hPScnKXsNCiAgICAgICAJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQogICAgCX0NCgkNCgkJJGRhdGEgPSBhcnJheSgNCgkJJ3BheWVyX25hbWUnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgncGF5ZXJfbmFtZScpLA0KCQknY29udGFjdF9udW1iZXInID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgnY29udGFjdF9udW1iZXInKSwNCgkJKTsNCgkJDQoJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+dXBkYXRlX3BheWVyX3JlY29yZCgkZGF0YSwkaWQpOw0KCQlpZiAoJGlkKSB7DQoJCQkkUmV0dXJuWydyZXN1bHQnXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX3N1Y2Nlc3NfcGF5ZXJfdXBkYXRlZCcpOw0KCQl9IGVsc2Ugew0KCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3JfbXNnJyk7DQoJCX0NCgkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCgkJZXhpdDsNCgkJfQ0KCX0NCgkNCgkvLyBWYWxpZGF0ZSBhbmQgYWRkIGluZm8gaW4gZGF0YWJhc2UNCglwdWJsaWMgZnVuY3Rpb24gdXBkYXRlX3BheWVlKCkgew0KCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2VkaXRfdHlwZScpPT0ncGF5ZWUnKSB7CQkNCgkJLyogRGVmaW5lIHJldHVybiB8IGhlcmUgcmVzdWx0IGlzIHVzZWQgdG8gcmV0dXJuIHVzZXIgZGF0YSBhbmQgZXJyb3IgZm9yIGVycm9yIG1lc3NhZ2UgKi8NCgkJJFJldHVybiA9IGFycmF5KCdyZXN1bHQnPT4nJywgJ2Vycm9yJz0+JycsICdjc3JmX2hhc2gnPT4nJyk7DQoJCSRpZCA9ICR0aGlzLT51cmktPnNlZ21lbnQoNCk7DQoJCSRSZXR1cm5bJ2NzcmZfaGFzaCddID0gJHRoaXMtPnNlY3VyaXR5LT5nZXRfY3NyZl9oYXNoKCk7DQoJCS8qIFNlcnZlciBzaWRlIFBIUCBpbnB1dCB2YWxpZGF0aW9uICovCQkNCgkJaWYoJHRoaXMtPmlucHV0LT5wb3N0KCdwYXllZV9uYW1lJyk9PT0nJykgew0KICAgICAgICAJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fYWNjX2Vycm9yX3BheWVlX25hbWUnKTsNCgkJfQ0KCQkJCQ0KCQlpZigkUmV0dXJuWydlcnJvciddIT0nJyl7DQogICAgICAgCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KICAgIAl9DQoJDQoJCSRkYXRhID0gYXJyYXkoDQoJCSdwYXllZV9uYW1lJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ3BheWVlX25hbWUnKSwNCgkJJ2NvbnRhY3RfbnVtYmVyJyA9PiAkdGhpcy0+aW5wdXQtPnBvc3QoJ2NvbnRhY3RfbnVtYmVyJyksDQoJCSk7DQoJCQ0KCQkkcmVzdWx0ID0gJHRoaXMtPkZpbmFuY2VfbW9kZWwtPnVwZGF0ZV9wYXllZV9yZWNvcmQoJGRhdGEsJGlkKTsNCgkJaWYgKCRpZCkgew0KCQkJJFJldHVyblsncmVzdWx0J10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19zdWNjZXNzX3BheWVlX3VwZGF0ZWQnKTsNCgkJfSBlbHNlIHsNCgkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yX21zZycpOw0KCQl9DQoJCSR0aGlzLT5vdXRwdXQoJFJldHVybik7DQoJCWV4aXQ7DQoJCX0NCgl9DQoJLy8gZGVsZXRlIHJlY29yZA0KCXB1YmxpYyBmdW5jdGlvbiBkZWxldGVfcGF5ZXIoKSB7DQoJCQ0KCQlpZigkdGhpcy0+aW5wdXQtPnBvc3QoJ2lzX2FqYXgnKT09JzInKSB7DQoJCQkvKiBEZWZpbmUgcmV0dXJuIHwgaGVyZSByZXN1bHQgaXMgdXNlZCB0byByZXR1cm4gdXNlciBkYXRhIGFuZCBlcnJvciBmb3IgZXJyb3IgbWVzc2FnZSAqLw0KCQkJJFJldHVybiA9IGFycmF5KCdyZXN1bHQnPT4nJywgJ2Vycm9yJz0+JycsICdjc3JmX2hhc2gnPT4nJyk7DQoJCQkkaWQgPSAkdGhpcy0+dXJpLT5zZWdtZW50KDQpOw0KCQkJJFJldHVyblsnY3NyZl9oYXNoJ10gPSAkdGhpcy0+c2VjdXJpdHktPmdldF9jc3JmX2hhc2goKTsNCgkJCSRyZXN1bHQgPSAkdGhpcy0+RmluYW5jZV9tb2RlbC0+ZGVsZXRlX3BheWVyX3JlY29yZCgkaWQpOw0KCQkJaWYoaXNzZXQoJGlkKSkgew0KCQkJCSRSZXR1cm5bJ3Jlc3VsdCddID0gJHRoaXMtPmxhbmctPmxpbmUoJ3hpbl9hY2Nfc3VjY2Vzc19wYXllcl9kZWxldGVkJyk7DQoJCQl9IGVsc2Ugew0KCQkJCSRSZXR1cm5bJ2Vycm9yJ10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2Vycm9yX21zZycpOw0KCQkJfQ0KCQkJJHRoaXMtPm91dHB1dCgkUmV0dXJuKTsNCgkJfQ0KCX0NCgkNCgkvLyBkZWxldGUgcmVjb3JkDQoJcHVibGljIGZ1bmN0aW9uIGRlbGV0ZV9wYXllZSgpIHsNCgkJDQoJCWlmKCR0aGlzLT5pbnB1dC0+cG9zdCgnaXNfYWpheCcpPT0nMicpIHsNCgkJCS8qIERlZmluZSByZXR1cm4gfCBoZXJlIHJlc3VsdCBpcyB1c2VkIHRvIHJldHVybiB1c2VyIGRhdGEgYW5kIGVycm9yIGZvciBlcnJvciBtZXNzYWdlICovDQoJCQkkUmV0dXJuID0gYXJyYXkoJ3Jlc3VsdCc9PicnLCAnZXJyb3InPT4nJywgJ2NzcmZfaGFzaCc9PicnKTsNCgkJCSRpZCA9ICR0aGlzLT51cmktPnNlZ21lbnQoNCk7DQoJCQkkUmV0dXJuWydjc3JmX2hhc2gnXSA9ICR0aGlzLT5zZWN1cml0eS0+Z2V0X2NzcmZfaGFzaCgpOw0KCQkJJHJlc3VsdCA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5kZWxldGVfcGF5ZWVfcmVjb3JkKCRpZCk7DQoJCQlpZihpc3NldCgkaWQpKSB7DQoJCQkJJFJldHVyblsncmVzdWx0J10gPSAkdGhpcy0+bGFuZy0+bGluZSgneGluX2FjY19zdWNjZXNzX3BheWVlX2RlbGV0ZWQnKTsNCgkJCX0gZWxzZSB7DQoJCQkJJFJldHVyblsnZXJyb3InXSA9ICR0aGlzLT5sYW5nLT5saW5lKCd4aW5fZXJyb3JfbXNnJyk7DQoJCQl9DQoJCQkkdGhpcy0+b3V0cHV0KCRSZXR1cm4pOw0KCQl9DQoJfQ0KCS8vIGJhbmsgd2lzZSB0cmFuc2FjdGlvbnMgbGlzdA0KCXB1YmxpYyBmdW5jdGlvbiBiYW5rd2lzZV90cmFuc2FjdGlvbnNfbGlzdCgpIHsNCg0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoZW1wdHkoJHNlc3Npb24pKXsgDQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCSR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL2Z1bGxfbGVkZ2VyX2FjY291bnRfbGlzdCIsICRkYXRhKTsNCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkvLyBEYXRhdGFibGVzIFZhcmlhYmxlcw0KCQkkZHJhdyA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgiZHJhdyIpKTsNCgkJJHN0YXJ0ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJzdGFydCIpKTsNCgkJJGxlbmd0aCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgibGVuZ3RoIikpOw0KCQkNCgkJJGFjX2lkID0gJHRoaXMtPnVyaS0+c2VnbWVudCg0KTsNCgkJJHRyYW5zYWN0aW9ucyA9ICR0aGlzLT5GaW5hbmNlX21vZGVsLT5nZXRfYmFua3dpc2VfdHJhbnNhY3Rpb25zKCRhY19pZCk7DQoJCQ0KCQkkZGF0YSA9IGFycmF5KCk7DQoJCSRiYWxhbmNlMiA9IDA7DQogICAgICAgICAgZm9yZWFjaCgkdHJhbnNhY3Rpb25zLT5yZXN1bHQoKSBhcyAkcikgew0KCQkJICANCgkJCS8vIHRyYW5zYWN0aW9uIGRhdGUNCgkJCSR0cmFuc2FjdGlvbl9kYXRlID0gJHRoaXMtPlhpbl9tb2RlbC0+c2V0X2RhdGVfZm9ybWF0KCRyLT50cmFuc2FjdGlvbl9kYXRlKTsNCgkJCS8vIGdldCBjdXJyZW5jeQ0KCQkJJHRvdGFsX2Ftb3VudCA9ICR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJHItPmFtb3VudCk7DQoJCQkvLyBjcmVkaXQNCgkJCS8vJHRyYW5zYWN0aW9uX2NyZWRpdCA9ICR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJHItPnRyYW5zYWN0aW9uX2NyZWRpdCk7DQoJCQkvLyBkZWJpdA0KCQkJLy8kdHJhbnNhY3Rpb25fZGViaXQgPSAkdGhpcy0+WGluX21vZGVsLT5jdXJyZW5jeV9zaWduKCRyLT50cmFuc2FjdGlvbl9kZWJpdCk7CQkJDQoJCQkvLyB0b3RhbCBjcmVkaXQNCgkJCS8vIGJhbGFuY2UNCgkJCS8qaWYoJHItPnRyYW5zYWN0aW9uX2RlYml0ID09IDApIHsNCgkJCQkkYmFsYW5jZTIgPSAkYmFsYW5jZTIgLSAkci0+dHJhbnNhY3Rpb25fY3JlZGl0Ow0KCQkJfSBlbHNlIHsNCgkJCQkkYmFsYW5jZTIgPSAkYmFsYW5jZTIgKyAkci0+dHJhbnNhY3Rpb25fZGViaXQ7DQoJCQl9DQoJCQkkYmFsYW5jZSA9ICR0aGlzLT5YaW5fbW9kZWwtPmN1cnJlbmN5X3NpZ24oJGJhbGFuY2UyKTsqLw0KCQkJDQoJCQkkZGF0YVtdID0gYXJyYXkoDQoJCQkJJHRyYW5zYWN0aW9uX2RhdGUsDQoJCQkJJHItPnRyYW5zYWN0aW9uX3R5cGUsDQoJCQkJJHItPmRlc2NyaXB0aW9uLA0KCQkJCSR0b3RhbF9hbW91bnQsDQoJCQkJJHItPmRlc2NyaXB0aW9uLA0KCQkJCSRyLT5kZXNjcmlwdGlvbg0KCQkJKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAkb3V0cHV0ID0gYXJyYXkoDQogICAgICAgICAgICAgICAiZHJhdyIgPT4gJGRyYXcsDQogICAgICAgICAgICAgICAgICJyZWNvcmRzVG90YWwiID0+ICR0cmFuc2FjdGlvbnMtPm51bV9yb3dzKCksDQogICAgICAgICAgICAgICAgICJyZWNvcmRzRmlsdGVyZWQiID0+ICR0cmFuc2FjdGlvbnMtPm51bV9yb3dzKCksDQogICAgICAgICAgICAgICAgICJkYXRhIiA9PiAkZGF0YQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICBlY2hvIGpzb25fZW5jb2RlKCRvdXRwdXQpOw0KICAgICAgICAgIGV4aXQoKTsNCiAgICAgfSAJDQoJIC8vIGdldCBpbmNvbWUgZm9vdGVyIC0gZGF0YQ0KCSBwdWJsaWMgZnVuY3Rpb24gZ2V0X2luY29tZV9mb290ZXIoKSB7DQoNCgkJJGRhdGFbJ3RpdGxlJ10gPSAkdGhpcy0+WGluX21vZGVsLT5zaXRlX3RpdGxlKCk7DQoJCQ0KCQkkZGF0YSA9IGFycmF5KA0KCQkJJ2Zyb21fZGF0ZScgPT4gJHRoaXMtPmlucHV0LT5nZXQoJ2Zyb21fZGF0ZScpLA0KCQkJJ3RvX2RhdGUnID0+ICR0aGlzLT5pbnB1dC0+Z2V0KCd0b19kYXRlJyksDQoJCQkndHlwZV9pZCcgPT4gJHRoaXMtPmlucHV0LT5nZXQoJ3R5cGVfaWQnKQ0KCQkJKTsNCgkJJHNlc3Npb24gPSAkdGhpcy0+c2Vzc2lvbi0+dXNlcmRhdGEoJ3VzZXJuYW1lJyk7DQoJCWlmKCFlbXB0eSgkc2Vzc2lvbikpeyANCgkJCSR0aGlzLT5sb2FkLT52aWV3KCJhZG1pbi9hY2NvdW50aW5nL2Zvb3Rlci9nZXRfaW5jb21lX2Zvb3RlciIsICRkYXRhKTsNCgkJfSBlbHNlIHsNCgkJCXJlZGlyZWN0KCdhZG1pbi8nKTsNCgkJfQ0KCQkvLyBEYXRhdGFibGVzIFZhcmlhYmxlcw0KCQkkZHJhdyA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgiZHJhdyIpKTsNCgkJJHN0YXJ0ID0gaW50dmFsKCR0aGlzLT5pbnB1dC0+Z2V0KCJzdGFydCIpKTsNCgkJJGxlbmd0aCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgibGVuZ3RoIikpOw0KCSB9DQoJIC8vIGdldCB0cmFuc2ZlciBmb290ZXIgLSBkYXRhDQoJIHB1YmxpYyBmdW5jdGlvbiBnZXRfdHJhbnNmZXJfZm9vdGVyKCkgew0KDQoJCSRkYXRhWyd0aXRsZSddID0gJHRoaXMtPlhpbl9tb2RlbC0+c2l0ZV90aXRsZSgpOw0KCQkNCgkJJGRhdGEgPSBhcnJheSgNCgkJCSdmcm9tX2RhdGUnID0+ICR0aGlzLT5pbnB1dC0+Z2V0KCdmcm9tX2RhdGUnKSwNCgkJCSd0b19kYXRlJyA9PiAkdGhpcy0+aW5wdXQtPmdldCgndG9fZGF0ZScpDQoJCQkpOw0KCQkkc2Vzc2lvbiA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndXNlcm5hbWUnKTsNCgkJaWYoIWVtcHR5KCRzZXNzaW9uKSl7IA0KCQkJJHRoaXMtPmxvYWQtPnZpZXcoImFkbWluL2FjY291bnRpbmcvZm9vdGVyL2dldF90cmFuc2Zlcl9mb290ZXIiLCAkZGF0YSk7DQoJCX0gZWxzZSB7DQoJCQlyZWRpcmVjdCgnYWRtaW4vJyk7DQoJCX0NCgkJLy8gRGF0YXRhYmxlcyBWYXJpYWJsZXMNCgkJJGRyYXcgPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImRyYXciKSk7DQoJCSRzdGFydCA9IGludHZhbCgkdGhpcy0+aW5wdXQtPmdldCgic3RhcnQiKSk7DQoJCSRsZW5ndGggPSBpbnR2YWwoJHRoaXMtPmlucHV0LT5nZXQoImxlbmd0aCIpKTsNCgkgfQ0KfSANCj8+")); ?>